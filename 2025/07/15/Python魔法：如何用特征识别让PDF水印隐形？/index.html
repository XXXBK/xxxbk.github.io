<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="BinkaiXu">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2025/07/15/pythoné­”æ³•ï¼šå¦‚ä½•ç”¨ç‰¹å¾è¯†åˆ«è®©pdfæ°´å°éšå½¢ï¼Ÿ/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="Python é­”æ³•ï¼šä¸€é”®è®© Excel æ­£ç¡®é€‰é¡¹ã€Œè„¸çº¢ã€">
<meta property="og:url" content="http://example.com/2025/07/15/Python%E9%AD%94%E6%B3%95%EF%BC%9A%E5%A6%82%E4%BD%95%E7%94%A8%E7%89%B9%E5%BE%81%E8%AF%86%E5%88%AB%E8%AE%A9PDF%E6%B0%B4%E5%8D%B0%E9%9A%90%E5%BD%A2%EF%BC%9F/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s21.ax1x.com/2025/07/15/pV13iP1.png">
<meta property="article:published_time" content="2025-07-15T09:21:07.000Z">
<meta property="article:modified_time" content="2025-07-16T01:50:49.691Z">
<meta property="article:author" content="XXXBK">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="PyMuPDF">
<meta property="article:tag" content="PDF">
<meta property="article:tag" content="æ°´å°å»é™¤">
<meta property="article:tag" content="ç‰¹å¾è¯†åˆ«">
<meta property="article:tag" content="æ–‡æœ¬å¤„ç†">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s21.ax1x.com/2025/07/15/pV13iP1.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://s21.ax1x.com/2025/07/15/pV13C5R.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://s21.ax1x.com/2025/07/15/pV13C5R.png">
    <meta name="theme-color" content="#FFC0CB">
    <link rel="shortcut icon" href="https://s21.ax1x.com/2025/07/15/pV13C5R.png">
    <!--- Page Info-->
    
    <title>
        
            Python é­”æ³•ï¼šä¸€é”®è®© Excel æ­£ç¡®é€‰é¡¹ã€Œè„¸çº¢ã€ | ç¼˜æ¥æ˜¯è¿™æ ·çš„å—
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
        <link href="https://cdn.jsdelivr.net/npm/@fontsource/inter@4.5.0/index.css" rel="stylesheet">
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":true,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[""]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":false,"init_open":true},"copyright":{"enable":false,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"æ¨èé˜…è¯»","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[],"strategy":"hybrid","exclude":["/private/","/archives/"],"min_similarity":0.2}},"colors":{"primary":"#FFC0CB","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":true,"family":"Source Han Sans SC, Microsoft YaHei, sans-serif","url":"https://cdn.jsdelivr.net/npm/@fontsource/inter@4.5.0/index.css"},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":false},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":{"enable":true,"image":"https://s21.ax1x.com/2025/07/15/pV13iP1.png","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://s21.ax1x.com/2025/07/15/pV13iP1.png","dark":"https://s21.ax1x.com/2025/07/15/pV13iP1.png"},"title":" ","subtitle":{"text":["XXXBK"],"hitokoto":{"enable":true,"show_author":true,"api":"https://v1.hitokoto.cn?&c=d&c=c&c=k&c=i"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#FFC0CB","dark":"#FFC0CB"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":"https://github.com/XXXBK","instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":true,"type":"fixed","meting":false,"audios":[{"name":"æ‹é¢¨","artist":"å¹¾ç”°ã‚Šã‚‰","url":"/music/æ‹é£.mp3","cover":"http://p2.music.126.net/LYjbg8Qe2s2O4EOPm5ijFg==/109951170675831225.jpg?param=130y130"},{"name":"ç¾¤é’","artist":"YOASOBI","url":"/music/ç¾¤é’.mp3","cover":"https://images.genius.com/72a054320dabe59b4be3823e80b74d22.1000x1000x1.jpg"},{"name":"å„ªã—ã„å½—æ˜Ÿ","artist":"YOASOBI","url":"/music/å„ªã—ã„å½—æ˜Ÿ.mp3","cover":"https://www.musicvoice.jp/wp-content/uploads/2021/01/pmu210113-m308.jpg"},{"name":"å¤œã«é§†ã‘ã‚‹","artist":"YOASOBI","url":"/music/å¤œã«é§†ã‘ã‚‹.mp3","cover":"https://ts1.tc.mm.bing.net/th/id/R-C.f905d573f8cf7769e3f9d8abf536ee27?rik=KeKlpCxVCF1Yow&riu=http%3a%2f%2fi2.hdslb.com%2fbfs%2farchive%2fa0f75915d2dfe1cbc20064b9b39331972caf5a18.jpg&ehk=rd8w3sHgQ%2f%2fLjuHcZYGtP2diXcKu0s245xmTUvkXKZo%3d&risl=&pid=ImgRaw&r=0"},{"name":"ã‚»ãƒ–ãƒ³ãƒ†ã‚£ãƒ¼ãƒ³","artist":"YOASOBI","url":"/music/ã‚»ãƒ–ãƒ³ãƒ†ã‚£ãƒ¼ãƒ³.mp3","cover":"https://is3-ssl.mzstatic.com/image/thumb/Music116/v4/c3/93/65/c393653a-e44f-f723-f82b-500b8fb49d09/197188385958.jpg/800x800bb.webp"},{"name":"ã‚‚ã†å°‘ã—ã ã‘","artist":"YOASOBI","url":"/music/ã‚‚ã†å°‘ã—ã ã‘.mp3","cover":"https://p1.music.126.net/seyhDwTzRNqFvYAw9FtJnw==/109951165930283941.jpg?param=130y130"},{"name":"ãƒ­ãƒãƒ³ã‚¹ã®ç´„æŸ","artist":"YOASOBI","url":"/music/ãƒ­ãƒãƒ³ã‚¹ã®ç´„æŸ.mp3","cover":"https://is5-ssl.mzstatic.com/image/thumb/Music115/v4/bf/29/c3/bf29c326-8766-2b6a-708f-b42c0e5d1754/196292065640.jpg/1200x1200bf-60.jpg"}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#F1F5D4","right":"#FFC0CB","transparency":35},"width":{"home":"1400px","pages":"1200px"},"links":null,"search":{"enable":true,"preload":false,"field":"post","content":false,"format":"raw"}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"right","first_item":"menu","announcement":"æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢","show_on_mobile":true,"links":{"æ–‡ç« ":{"path":"/archives","icon":"fa-regular fa-archive"},"æ ‡ç­¾":{"path":"/tags","icon":"fa-regular fa-tags"},"ç±»åˆ«":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3},"ç±»åˆ«":{"enable":true,"limit":3}},"footerStart":"2025/7/5 11:05"};
    window.lang_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="https://s21.ax1x.com/2025/07/15/pV11zb4.png" class="w-full h-full rounded-sm">
                </a>
            
            <a class="logo-title" href="/">
                
                ç¼˜æ¥æ˜¯è¿™æ ·çš„å—
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            

            
            
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/archives"
                        >
                            <span>æ–‡ç« </span>
                            <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/tags"
                        >
                            <span>æ ‡ç­¾</span>
                            <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/categories"
                        >
                            <span>ç±»åˆ«</span>
                            <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">
            30
        </div>
        <div class="label text-third-text-color text-sm">æ ‡ç­¾</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20"
        href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">
            13
        </div>
        <div class="label text-third-text-color text-sm">åˆ†ç±»</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20"
        href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">
            8
        </div>
        <div class="label text-third-text-color text-sm">æ–‡ç« </div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Python é­”æ³•ï¼šä¸€é”®è®© Excel æ­£ç¡®é€‰é¡¹ã€Œè„¸çº¢ã€</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="https://s21.ax1x.com/2025/07/04/pVKlaSe.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">BinkaiXu</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1"></span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-07-15 17:21:07</span>
        <span class="mobile">2025-07-15 17:21:07</span>
        <span class="hover-info">åˆ›å»º</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-07-16 09:50:49</span>
            <span class="mobile">2025-07-16 09:50:49</span>
            <span class="hover-info">æ›´æ–°</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/PDF-%E5%A4%84%E7%90%86/">PDF å¤„ç†</a>&nbsp;
                        </li>
                    
                    
                
                    
                        
                            <li>></li>
                        
                        <li>
                            <a href="/categories/PDF-%E5%A4%84%E7%90%86/Python/">Python</a>&nbsp;
                        </li>
                    
                    
                
                    
                        
                            <li>></li>
                        
                        <li>
                            <a href="/categories/PDF-%E5%A4%84%E7%90%86/Python/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/">æ•°æ®å¤„ç†</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Python/">Python</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/PyMuPDF/">PyMuPDF</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/PDF/">PDF</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E6%B0%B4%E5%8D%B0%E5%8E%BB%E9%99%A4/">æ°´å°å»é™¤</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E7%89%B9%E5%BE%81%E8%AF%86%E5%88%AB/">ç‰¹å¾è¯†åˆ«</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/">æ–‡æœ¬å¤„ç†</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>8.7k å­—</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>38 åˆ†é’Ÿ</span>
        </span>
    
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å¸¦æœ‰ç‰¹å®šç‰¹å¾çš„ PDF æ°´å°ï¼Œæ¯”å¦‚å›ºå®šçš„å­—ä½“å¤§å°ã€å€¾æ–œè§’åº¦ã€é€æ˜åº¦å’Œé¢œè‰²ã€‚è¿™äº›ç‰¹æ€§ä¸ºæˆ‘ä»¬æä¾›äº†æ›´ç²¾å‡†åœ°è¯†åˆ«æ°´å°çš„ä¾æ®ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥æ·±å…¥æ¢è®¨å¦‚ä½•åˆ©ç”¨ PyMuPDF (Fitz) åº“ï¼ŒåŸºäºè¿™äº›ç‰¹å¾å®ç° PDF æ°´å°çš„ç²¾ç¡®è¯†åˆ«å’Œå»é™¤ï¼Œå¹¶æ•´åˆå¤šç§å®ç”¨æ–¹æ³•ï¼Œå¸®ä½ åº”å¯¹ä¸åŒåœºæ™¯ã€‚</p>
<p>ç‰¹å®šç‰¹å¾æ°´å°çš„è¯†åˆ«åŸç†</p>
<p>PDF æ–‡ä»¶ä¸­çš„æ–‡æœ¬å’Œå›¾å½¢å¯¹è±¡éƒ½åŒ…å«äº†ä¸°å¯Œçš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œä¾‹å¦‚å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦ã€é€æ˜åº¦å’Œé¢œè‰²ã€‚å½“æ°´å°å…·æœ‰å›ºå®šç‰¹å¾æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ç²¾å‡†è¯†åˆ«ï¼š</p>
<ol>
<li><p><strong>è§£æ PDF é¡µé¢å†…å®¹</strong>ï¼š è·å–é¡µé¢ä¸Šæ‰€æœ‰çš„æ–‡æœ¬å’Œå›¾å½¢å¯¹è±¡ã€‚</p>
</li>
<li><p><strong>æå–å¯¹è±¡ç‰¹å¾</strong>ï¼š è·å–æ¯ä¸ªå¯¹è±¡çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦ã€é€æ˜åº¦å’Œé¢œè‰²ç­‰ä¿¡æ¯ã€‚</p>
</li>
<li><p><strong>ç‰¹å¾åŒ¹é…</strong>ï¼š å°†æå–åˆ°çš„ç‰¹å¾ä¸æˆ‘ä»¬å·²çŸ¥çš„æ°´å°ç‰¹å¾è¿›è¡Œæ¯”å¯¹ã€‚</p>
</li>
<li><p><strong>å¤„ç†åŒ¹é…å¯¹è±¡</strong>ï¼š å¯¹ç¬¦åˆæ°´å°ç‰¹å¾çš„å¯¹è±¡è¿›è¡Œåˆ é™¤æˆ–è¦†ç›–å¤„ç†ã€‚</p>
</li>
</ol>
<p>å…¸å‹çš„ PDF æ°´å°é€šå¸¸å…·å¤‡ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ul>
<li><p>ğŸ“ å›ºå®šå€¾æ–œè§’åº¦ (å¸¸è§ 15-45 åº¦)</p>
</li>
<li><p>ğŸ¨ å›ºå®šé¢œè‰² (å¸¸è§æµ…ç°è‰² #C0C0C0)</p>
</li>
<li><p>ğŸŒ« å›ºå®šé€æ˜åº¦ (çº¦ 30-50%)</p>
</li>
<li><p>ğŸ”  å›ºå®šå­—ä½“å¤§å° (é€šå¸¸è¾ƒå¤§)</p>
</li>
<li><p>ğŸ”„ é‡å¤å‡ºç°åœ¨æ¯ä¸€é¡µç›¸åŒä½ç½®</p>
</li>
</ul>
<p>ä½¿ç”¨ PyMuPDF å®ç°åŸºäºç‰¹å¾çš„æ°´å°å¤„ç†</p>
<h3 id="æ–¹æ³•ä¸€ï¼šåŸºäºå­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦çš„æ°´å°è¯†åˆ«-xA"><a href="#æ–¹æ³•ä¸€ï¼šåŸºäºå­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦çš„æ°´å°è¯†åˆ«-xA" class="headerlink" title="æ–¹æ³•ä¸€ï¼šåŸºäºå­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦çš„æ°´å°è¯†åˆ«&#xA;"></a>æ–¹æ³•ä¸€ï¼šåŸºäºå­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦çš„æ°´å°è¯†åˆ«&#xA;</h3><p>è¿™ä¸ªæ–¹æ³•éå¸¸é€‚åˆé‚£äº›å­—ä½“å¤§å°å’Œå€¾æ–œè§’åº¦éƒ½æ¯”è¾ƒå›ºå®šçš„æ°´å°ã€‚</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">import fitz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def remove\_watermark\_by\_font\_size\_and\_rotation(input\_pdf, output\_pdf, font\_size, rotation\_angle):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   æ ¹æ®å­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦å»é™¤PDFä¸­çš„æ°´å°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å‚æ•°:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   input\_pdf (str): è¾“å…¥PDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   output\_pdf (str): è¾“å‡ºPDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   font\_size (float): æ°´å°å­—ä½“å¤§å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   rotation\_angle (float): æ°´å°æ—‹è½¬è§’åº¦ (åº¦)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc = fitz.open(input\_pdf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for page in doc:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è·å–é¡µé¢ä¸Šçš„æ‰€æœ‰æ–‡æœ¬å’Œå®ƒä»¬çš„å±æ€§</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       text\_infos = page.get\_text(&quot;dict&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       for block in text\_infos\[&quot;blocks&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           if &quot;lines&quot; in block:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               for line in block\[&quot;lines&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   for span in line\[&quot;spans&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# æå–å­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       current\_size = span\[&quot;size&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# è®¡ç®—æ—‹è½¬è§’åº¦ (PyMuPDFä¸­é€šè¿‡å˜æ¢çŸ©é˜µè®¡ç®—)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       matrix = fitz.Matrix(span\[&quot;matrix&quot;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# matrix.decompose() è¿”å› (a, b, c, d, e, f)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# æ—‹è½¬è§’åº¦é€šè¿‡ atan2(b, a) æˆ– atan2(-c, d) è®¡ç®—ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# å¯¹äºç®€å•çš„æ—‹è½¬ï¼Œalpha å’Œ beta åº”è¯¥è¿‘ä¼¼ç›¸ç­‰æˆ–äº’è¡¥ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# è¿™é‡Œæˆ‘ä»¬ç®€åŒ–ï¼Œç›´æ¥ä½¿ç”¨ atan2(matrix.b, matrix.a) è½¬æ¢æˆè§’åº¦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       import math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       current\_rotation = math.degrees(math.atan2(matrix.b, matrix.a))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# æ£€æŸ¥æ˜¯å¦åŒ¹é…æ°´å°ç‰¹å¾ï¼Œå¹¶å…è®¸ä¸€å®šçš„è¯¯å·®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       if (abs(current\_size - font\_size) &lt; 1.5 and # å…è®¸è½»å¾®è¯¯å·®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           abs(current\_rotation - rotation\_angle) &lt; 5.0): # å…è®¸5åº¦è¯¯å·®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           \# åˆ›å»ºä¸€ä¸ªçŸ©å½¢åŒºåŸŸç”¨äºè¦†ç›–æ°´å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           page.add\_redact\_annot(fitz.Rect(span\[&quot;bbox&quot;]), text=&quot;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# åº”ç”¨æ‰€æœ‰ç¼–è¾‘</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       page.apply\_redactions()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# ä¿å­˜ä¿®æ”¹åçš„PDF</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.save(output\_pdf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.close()</span><br></pre></td></tr></table></figure></div>

<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li><p>æˆ‘ä»¬ä½¿ç”¨ <code>page.get_text(&quot;dict&quot;)</code> è·å–é¡µé¢ä¸Šæ‰€æœ‰çš„æ–‡æœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„å„ç§å±æ€§ã€‚</p>
</li>
<li><p>ä»æ–‡æœ¬è·¨åº¦ (span) ä¸­æå– å­—ä½“å¤§å° å’Œ å˜æ¢çŸ©é˜µã€‚</p>
</li>
<li><p>é€šè¿‡åˆ†è§£å˜æ¢çŸ©é˜µæ¥è®¡ç®—æ–‡æœ¬çš„ æ—‹è½¬è§’åº¦ã€‚è¿™é‡Œä½¿ç”¨äº† <code>math.atan2(matrix.b, matrix.a)</code> æ¥æ›´å‡†ç¡®åœ°è·å–æ—‹è½¬è§’åº¦ã€‚</p>
</li>
<li><p>å°†æå–åˆ°çš„ç‰¹å¾ä¸ä½ å·²çŸ¥çš„æ°´å°ç‰¹å¾è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœåŒ¹é…ï¼ˆå¹¶å…è®¸ä¸€å®šçš„è¯¯å·®èŒƒå›´ï¼‰ï¼Œå°±ç”¨ä¸€ä¸ªç©ºç™½çŸ©å½¢è¦†ç›–æ°´å°åŒºåŸŸã€‚</p>
</li>
</ul>
<p><strong>éš¾æ˜“åº¦</strong>ï¼šâ˜…â˜…â˜…â˜†â˜†</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š å¯¹å…·æœ‰å›ºå®šå­—ä½“å¤§å°å’Œå€¾æ–œè§’åº¦çš„æ°´å°æ•ˆæœç‰¹åˆ«å¥½ï¼Œè¯¯åˆ¤ç‡ä½ã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š éœ€è¦ä½ é¢„å…ˆçŸ¥é“æ°´å°çš„å­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦å‚æ•°ã€‚</p>
<h3 id="æ–¹æ³•äºŒï¼šåŸºäºé€æ˜åº¦å’Œé¢œè‰²çš„æ°´å°è¯†åˆ«-xA"><a href="#æ–¹æ³•äºŒï¼šåŸºäºé€æ˜åº¦å’Œé¢œè‰²çš„æ°´å°è¯†åˆ«-xA" class="headerlink" title="æ–¹æ³•äºŒï¼šåŸºäºé€æ˜åº¦å’Œé¢œè‰²çš„æ°´å°è¯†åˆ«&#xA;"></a>æ–¹æ³•äºŒï¼šåŸºäºé€æ˜åº¦å’Œé¢œè‰²çš„æ°´å°è¯†åˆ«&#xA;</h3><p>è¿™ç§æ–¹æ³•é€‚ç”¨äºé‚£äº›æœ‰å›ºå®šé€æ˜åº¦å’Œé¢œè‰²çš„æ°´å°ï¼Œç‰¹åˆ«æ˜¯åŠé€æ˜çš„æµ…è‰²æ°´å°ã€‚</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">import fitz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def remove\_watermark\_by\_opacity\_and\_color(input\_pdf, output\_pdf, opacity\_threshold, color\_rgb\_target, color\_tolerance=10):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   æ ¹æ®é€æ˜åº¦å’Œé¢œè‰²å»é™¤PDFä¸­çš„æ°´å°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å‚æ•°:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   input\_pdf (str): è¾“å…¥PDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   output\_pdf (str): è¾“å‡ºPDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   opacity\_threshold (float): æ°´å°é€æ˜åº¦é˜ˆå€¼ (0.0-1.0)ï¼Œä½äºæ­¤å€¼å¯èƒ½è®¤ä¸ºæ˜¯æ°´å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   color\_rgb\_target (tuple): æ°´å°é¢œè‰²çš„RGBå€¼ï¼Œå¦‚ (200, 200, 200)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   color\_tolerance (int): é¢œè‰²åŒ¹é…çš„å®¹å·®èŒƒå›´ (0-255)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc = fitz.open(input\_pdf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for page in doc:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è·å–é¡µé¢ä¸Šæ‰€æœ‰çš„ç»˜å›¾æŒ‡ä»¤</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# PyMuPDF ç›´æ¥ä»get\_text(&quot;dict&quot;)è·å–çš„spané‡Œæ²¡æœ‰é€æ˜åº¦ä¿¡æ¯ï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# é€æ˜åº¦é€šå¸¸æ˜¯åœ¨å›¾å½¢çŠ¶æ€(graphics state)ä¸­è®¾ç½®çš„ï¼Œéœ€è¦è§£æPDFå†…å®¹æµæ‰èƒ½è·å–ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è¿™é‡Œä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬å‡è®¾é€æ˜åº¦ä¿¡æ¯å¯ä»¥é€šè¿‡æ›´å¤æ‚çš„è§£æè·å¾—ï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# æˆ–è€…é€šè¿‡å›¾åƒæ¸²æŸ“ååˆ†æåƒç´ æ¥å®ç°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ç®€åŒ–å¤„ç†ï¼šå¯¹äºæ–‡æœ¬æ°´å°ï¼Œé€šå¸¸é¢œè‰²å’Œä½ç½®æ˜¯æ›´å¯é çš„ç‰¹å¾ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# å¦‚æœéœ€è¦ç²¾ç¡®çš„é€æ˜åº¦è¯†åˆ«ï¼Œéœ€è¦æ›´æ·±å…¥çš„PDFå†…å®¹æµè§£æã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# éå†é¡µé¢ä¸Šçš„æ‰€æœ‰æ–‡æœ¬</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       text\_infos = page.get\_text(&quot;dict&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       for block in text\_infos\[&quot;blocks&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           if &quot;lines&quot; in block:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               for line in block\[&quot;lines&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   for span in line\[&quot;spans&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# æå–é¢œè‰²ä¿¡æ¯</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       color\_int = span\[&quot;color&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       r = (color\_int &gt;&gt; 16) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                       g = (color\_int &gt;&gt; 8) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                       b = color\_int &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                       current\_color\_rgb = (r, g, b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# åœ¨PyMuPDFçš„æ–‡æœ¬spanä¿¡æ¯ä¸­ç›´æ¥è·å–é€æ˜åº¦æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# å› ä¸ºé€æ˜åº¦æ˜¯å›¾å½¢çŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ–‡æœ¬æœ¬èº«çš„ä¸€ä¸ªå±æ€§ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# å¯¹äºçœŸæ­£çš„é€æ˜åº¦åŒ¹é…ï¼Œé€šå¸¸éœ€è¦æ¸²æŸ“é¡µé¢å¹¶åˆ†æåƒç´ çš„alphaé€šé“ï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# æˆ–è€…è§£ææ›´åº•å±‚çš„PDFå†…å®¹æµã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œç®€åŒ–ï¼Œå‡è®¾æ‰€æœ‰æ–‡æœ¬éƒ½æ˜¯ä¸é€æ˜çš„ï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# é™¤éé€šè¿‡å…¶ä»–æ–¹å¼ç¡®è®¤å…¶é€æ˜åº¦ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# å¦‚æœ watermark æ˜¯å›¾åƒï¼Œåˆ™éœ€è¦ç”¨å…¶ä»–æ–¹æ³•å¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# åˆ¤æ–­é¢œè‰²æ˜¯å¦åŒ¹é…ç›®æ ‡é¢œè‰²ï¼ˆå¸¦å®¹å·®ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       color\_match = (</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           abs(current\_color\_rgb\[0] - color\_rgb\_target\[0]) &lt;= color\_tolerance and</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           abs(current\_color\_rgb\[1] - color\_rgb\_target\[1]) &lt;= color\_tolerance and</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           abs(current\_color\_rgb\[2] - color\_rgb\_target\[2]) &lt;= color\_tolerance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# è¿™é‡Œæ²¡æœ‰é€æ˜åº¦ä¿¡æ¯ï¼Œæ‰€ä»¥æš‚æ—¶ä¸ä½œä¸ºåˆ¤æ–­æ¡ä»¶</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# å¦‚æœä½ çš„æ°´å°æ˜¯æ–‡æœ¬ä¸”é¢œè‰²å›ºå®šï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå¾ˆæœ‰ç”¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       if color\_match: # ä»…åŸºäºé¢œè‰²åŒ¹é…</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           page.add\_redact\_annot(fitz.Rect(span\[&quot;bbox&quot;]), text=&quot;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# åº”ç”¨æ‰€æœ‰ç¼–è¾‘</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       page.apply\_redactions()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# ä¿å­˜ä¿®æ”¹åçš„PDF</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.save(output\_pdf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.close()</span><br></pre></td></tr></table></figure></div>

<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li><p>æˆ‘ä»¬ä»æ–‡æœ¬è·¨åº¦ä¸­æå– RGB é¢œè‰²å€¼ã€‚</p>
</li>
<li><p>æ³¨æ„ï¼š ç›´æ¥ä» span ä¸­æå–é€æ˜åº¦ä¿¡æ¯åœ¨ PyMuPDF ä¸­æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºå®ƒé€šå¸¸æ˜¯ PDF å†…å®¹æµä¸­çš„å›¾å½¢çŠ¶æ€å‚æ•°ã€‚ä¸ºäº†å®ç°çœŸæ­£çš„é€æ˜åº¦è¯†åˆ«ï¼Œä½ å¯èƒ½éœ€è¦æ¸²æŸ“é¡µé¢ä¸ºå›¾åƒååˆ†æåƒç´ çš„ alpha é€šé“ï¼Œæˆ–è€…è¿›è¡Œæ›´å¤æ‚çš„ PDF å†…å®¹æµè§£æã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘æš‚æ—¶ç§»é™¤äº†é€æ˜åº¦çš„åˆ¤æ–­ï¼Œä¸»è¦ä¾èµ–é¢œè‰²åŒ¹é…ã€‚</p>
</li>
<li><p>æ¯”è¾ƒæå–çš„é¢œè‰²ä¸å·²çŸ¥æ°´å°ç‰¹å¾ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªå®¹å·®èŒƒå›´ã€‚</p>
</li>
</ul>
<p><strong>éš¾æ˜“åº¦</strong>ï¼šâ˜…â˜…â˜…â˜…â˜†</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š å¯¹å…·æœ‰å›ºå®šé¢œè‰²ï¼ˆç‰¹åˆ«æ˜¯æµ…è‰²ï¼‰çš„æ°´å°æ•ˆæœå¥½ã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š é€æ˜åº¦æå–æ˜¯éš¾ç‚¹ï¼Œå¯èƒ½éœ€è¦æ·±å…¥è§£æ PDF å†…éƒ¨ç»“æ„æˆ–å€ŸåŠ©å›¾åƒå¤„ç†åº“ã€‚</p>
<h3 id="æ–¹æ³•ä¸‰ï¼šç»¼åˆå¤šç‰¹å¾çš„æ°´å°è¯†åˆ«-xA"><a href="#æ–¹æ³•ä¸‰ï¼šç»¼åˆå¤šç‰¹å¾çš„æ°´å°è¯†åˆ«-xA" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šç»¼åˆå¤šç‰¹å¾çš„æ°´å°è¯†åˆ«&#xA;"></a>æ–¹æ³•ä¸‰ï¼šç»¼åˆå¤šç‰¹å¾çš„æ°´å°è¯†åˆ«&#xA;</h3><p>å½“æ°´å°ç‰¹å¾æ˜ç¡®ä¸”å›ºå®šæ—¶ï¼Œè¿™ä¸ªæ–¹æ³•èƒ½æä¾›æœ€é«˜çš„è¯†åˆ«å‡†ç¡®æ€§ï¼Œå› ä¸ºå®ƒç»“åˆäº†å¤šç§ç‰¹å¾è¿›è¡Œåˆ¤æ–­ã€‚</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">import fitz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def remove\_watermark\_by\_multiple\_features(input\_pdf, output\_pdf,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                                         font\_size, rotation\_angle,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                                         color\_rgb,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                                         size\_tolerance=1.5, rotation\_tolerance=5.0, color\_tolerance=10):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   æ ¹æ®å¤šç§ç‰¹å¾ç»„åˆå»é™¤PDFä¸­çš„æ°´å°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   ä¸åŒ…å«é€æ˜åº¦å‚æ•°ï¼Œå› ä¸ºç›´æ¥ä»text spanè·å–é€æ˜åº¦å¤æ‚ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å‚æ•°:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   input\_pdf (str): è¾“å…¥PDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   output\_pdf (str): è¾“å‡ºPDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   font\_size (float): æ°´å°å­—ä½“å¤§å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   rotation\_angle (float): æ°´å°æ—‹è½¬è§’åº¦ (åº¦)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   color\_rgb (tuple): æ°´å°é¢œè‰²çš„RGBå€¼ï¼Œå¦‚ (200, 200, 200)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   size\_tolerance (float): å­—ä½“å¤§å°åŒ¹é…çš„å®¹å·®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   rotation\_tolerance (float): æ—‹è½¬è§’åº¦åŒ¹é…çš„å®¹å·® (åº¦)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   color\_tolerance (int): é¢œè‰²åŒ¹é…çš„å®¹å·® (0-255)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc = fitz.open(input\_pdf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for page in doc:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è·å–é¡µé¢ä¸Šçš„æ‰€æœ‰æ–‡æœ¬å’Œå®ƒä»¬çš„å±æ€§</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       text\_infos = page.get\_text(&quot;dict&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       for block in text\_infos\[&quot;blocks&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           if &quot;lines&quot; in block:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               for line in block\[&quot;lines&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   for span in line\[&quot;spans&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# æå–å­—ä½“å¤§å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       current\_size = span\[&quot;size&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# è®¡ç®—æ—‹è½¬è§’åº¦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       matrix = fitz.Matrix(span\[&quot;matrix&quot;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       current\_rotation = math.degrees(math.atan2(matrix.b, matrix.a))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# æå–é¢œè‰²ä¿¡æ¯</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       color\_int = span\[&quot;color&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       r = (color\_int &gt;&gt; 16) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                       g = (color\_int &gt;&gt; 8) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                       b = (color\_int) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                       current\_color\_rgb = (r, g, b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# ç»¼åˆå¤šä¸ªç‰¹å¾è¿›è¡ŒåŒ¹é…</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       size\_match = abs(current\_size - font\_size) &lt; size\_tolerance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       rotation\_match = abs(current\_rotation - rotation\_angle) &lt; rotation\_tolerance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       color\_match = (</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           abs(current\_color\_rgb\[0] - color\_rgb\[0]) &lt;= color\_tolerance and</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           abs(current\_color\_rgb\[1] - color\_rgb\[1]) &lt;= color\_tolerance and</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           abs(current\_color\_rgb\[2] - color\_rgb\[2]) &lt;= color\_tolerance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# å¦‚æœæ‰€æœ‰ç‰¹å¾éƒ½åŒ¹é…ï¼Œåˆ™è®¤ä¸ºæ˜¯æ°´å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       if size\_match and rotation\_match and color\_match:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           \# åˆ›å»ºä¸€ä¸ªçŸ©å½¢åŒºåŸŸç”¨äºè¦†ç›–æ°´å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           page.add\_redact\_annot(fitz.Rect(span\[&quot;bbox&quot;]), text=&quot;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# åº”ç”¨æ‰€æœ‰ç¼–è¾‘</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       page.apply\_redactions()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# ä¿å­˜ä¿®æ”¹åçš„PDF</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.save(output\_pdf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.close()</span><br></pre></td></tr></table></figure></div>

<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li><p>ç»¼åˆæå–å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦å’Œé¢œè‰²ä¸‰ä¸ªç‰¹å¾ï¼ˆä¸ºäº†ç®€åŒ–å’Œå®ç”¨æ€§ï¼Œç§»é™¤äº†ç›´æ¥åœ¨ span ä¸­è·å–çš„é€æ˜åº¦åˆ¤æ–­ï¼‰ã€‚</p>
</li>
<li><p>è®¾ç½®äº†åˆç†çš„åŒ¹é…å®¹å·®èŒƒå›´ï¼Œä½ å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´è¿™äº›å®¹å·®å€¼ã€‚</p>
</li>
<li><p>åªæœ‰å½“æ‰€æœ‰é€‰å®šçš„ç‰¹å¾éƒ½åŒ¹é…æ—¶æ‰åˆ¤å®šä¸ºæ°´å°ï¼Œè¿™å¤§å¤§æé«˜äº†è¯†åˆ«çš„å‡†ç¡®æ€§ã€‚</p>
</li>
</ul>
<p><strong>éš¾æ˜“åº¦</strong>ï¼šâ˜…â˜…â˜…â˜…â˜…</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š è¯†åˆ«å‡†ç¡®æ€§é«˜ï¼Œè¯¯åˆ¤ç‡æä½ã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š å®ç°ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ç²¾ç¡®çš„æ°´å°ç‰¹å¾å‚æ•°ã€‚</p>
<h3 id="æ–¹æ³•å››ï¼šåŸºäºæ–‡æœ¬ç‰¹å¾çš„ç›´æ¥åˆ é™¤æ³•-xA"><a href="#æ–¹æ³•å››ï¼šåŸºäºæ–‡æœ¬ç‰¹å¾çš„ç›´æ¥åˆ é™¤æ³•-xA" class="headerlink" title="æ–¹æ³•å››ï¼šåŸºäºæ–‡æœ¬ç‰¹å¾çš„ç›´æ¥åˆ é™¤æ³•&#xA;"></a>æ–¹æ³•å››ï¼šåŸºäºæ–‡æœ¬ç‰¹å¾çš„ç›´æ¥åˆ é™¤æ³•&#xA;</h3><p>å¦‚æœä½ çŸ¥é“æ°´å°çš„å…·ä½“æ–‡æœ¬å†…å®¹ï¼Œæˆ–è€…å¯ä»¥é€šè¿‡ä¸€äº›ç®€å•çš„æ–‡æœ¬å±æ€§æ¥è¯†åˆ«ï¼Œè¿™ä¸ªæ–¹æ³•æœ€ç›´æ¥ã€æœ€å¿«é€Ÿã€‚</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">import fitz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def is\_watermark\_span(span, target\_text=None, min\_size=None, max\_size=None, target\_color\_rgb=None, color\_tolerance=10):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   åˆ¤æ–­æ–‡æœ¬è·¨åº¦æ˜¯å¦ä¸ºæ°´å°ï¼Œå¯æ ¹æ®å®é™…æƒ…å†µè‡ªå®šä¹‰åˆ¤æ–­æ¡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å‚æ•°:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   span (dict): æ–‡æœ¬è·¨åº¦å­—å…¸</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   target\_text (str): å¯é€‰ï¼Œè¦åŒ¹é…çš„æ°´å°æ–‡æœ¬å†…å®¹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   min\_size (float): å¯é€‰ï¼Œæ°´å°å­—ä½“æœ€å°å°ºå¯¸</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   max\_size (float): å¯é€‰ï¼Œæ°´å°å­—ä½“æœ€å¤§å°ºå¯¸</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   target\_color\_rgb (tuple): å¯é€‰ï¼Œæ°´å°é¢œè‰²çš„RGBå€¼</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   color\_tolerance (int): é¢œè‰²åŒ¹é…çš„å®¹å·® (0-255)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# ç¤ºä¾‹ï¼šåˆ¤æ–­å­—ä½“å¤§å°ã€é¢œè‰²ç­‰ç‰¹å¾</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# å¯ä»¥æ ¹æ®å®é™…æƒ…å†µç»„åˆå¤šä¸ªæ¡ä»¶</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# å­—ä½“å¤§å°åˆ¤æ–­</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   size\_match = True</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if min\_size is not None and span\[&quot;size&quot;] &lt; min\_size:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       size\_match = False</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if max\_size is not None and span\[&quot;size&quot;] &gt; max\_size:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       size\_match = False</span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# æ–‡æœ¬å†…å®¹åˆ¤æ–­</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   text\_match = True</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if target\_text is not None and target\_text.lower() not in span\[&quot;text&quot;].lower():</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       text\_match = False</span><br><span class="line"></span><br><span class="line">&amp;#x20;  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# é¢œè‰²åˆ¤æ–­</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   color\_match = True</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if target\_color\_rgb is not None:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       color\_int = span\[&quot;color&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       r = (color\_int &gt;&gt; 16) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;       g = (color\_int &gt;&gt; 8) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;       b = color\_int &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;       current\_color\_rgb = (r, g, b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       if not (abs(current\_color\_rgb\[0] - target\_color\_rgb\[0]) &lt;= color\_tolerance and</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               abs(current\_color\_rgb\[1] - target\_color\_rgb\[1]) &lt;= color\_tolerance and</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               abs(current\_color\_rgb\[2] - target\_color\_rgb\[2]) &lt;= color\_tolerance):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           color\_match = False</span><br><span class="line"></span><br><span class="line">&amp;#x20;   return size\_match and text\_match and color\_match</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def remove\_watermark\_by\_text\_features(doc\_path, output\_path, \*\*kwargs):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   æ ¹æ®æ–‡æœ¬ç‰¹å¾å»é™¤PDFä¸­çš„æ°´å°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å‚æ•°:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc\_path (str): è¾“å…¥PDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   output\_path (str): è¾“å‡ºPDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \*\*kwargs: ä¼ é€’ç»™ is\_watermark\_span å‡½æ•°çš„å‚æ•°ï¼Œå¦‚ target\_text, min\_size, max\_size, target\_color\_rgb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc = fitz.open(doc\_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for page in doc:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# æœç´¢ç¬¦åˆæ°´å°ç‰¹å¾çš„æ–‡æœ¬</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       for block in page.get\_text(&quot;dict&quot;)\[&quot;blocks&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           if block\[&quot;type&quot;] == 0:  # æ–‡æœ¬å—</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               for line in block\[&quot;lines&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   for span in line\[&quot;spans&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       if is\_watermark\_span(span,\*\* kwargs):  # è‡ªå®šä¹‰åˆ¤æ–­å‡½æ•°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           page.add\_redact\_annot(span\[&quot;bbox&quot;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       page.apply\_redactions()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.save(output\_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# ç¤ºä¾‹ç”¨æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# remove\_watermark\_by\_text\_features(&quot;input.pdf&quot;, &quot;output.pdf&quot;, target\_text=&quot;CONFIDENTIAL&quot;, min\_size=10, max\_size=14, target\_color\_rgb=(204, 204, 204))</span><br></pre></td></tr></table></figure></div>

<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li><p>é€šè¿‡ä¸€ä¸ªå¯è‡ªå®šä¹‰çš„ <code>is_watermark_span</code> å‡½æ•°ç›´æ¥æœç´¢ç¬¦åˆç‰¹å®šæ–‡æœ¬ç‰¹å¾çš„æ°´å°å†…å®¹ã€‚</p>
</li>
<li><p>ä½ å¯ä»¥ä¼ å…¥ <code>target_text</code>ã€<code>min_size</code>ã€<code>max_size</code> å’Œ <code>target_color_rgb</code> ç­‰å‚æ•°æ¥ç²¾ç¡®å®šä¹‰æ°´å°çš„ç‰¹å¾ã€‚</p>
</li>
<li><p>å¯¹åˆ¤å®šä¸ºæ°´å°çš„æ–‡æœ¬è¿›è¡Œè¦†ç›–å¤„ç†ã€‚</p>
</li>
</ul>
<p><strong>éš¾æ˜“åº¦</strong>ï¼šâ˜…â˜…â˜†â˜†â˜†</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š å®ç°ç®€å•ï¼Œå¤„ç†é€Ÿåº¦å¿«ï¼Œéå¸¸é€‚åˆå¤„ç†ç®€å•çš„æ–‡æœ¬æ°´å°ã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š ä»…é€‚ç”¨äºæ–‡æœ¬æ°´å°ï¼Œæ— æ³•å¤„ç†å›¾åƒæ°´å°ã€‚</p>
<h3 id="æ–¹æ³•äº”ï¼šåŸºäºæ··åˆç‰¹å¾çš„é«˜çº§è¯†åˆ«æ³•-xA"><a href="#æ–¹æ³•äº”ï¼šåŸºäºæ··åˆç‰¹å¾çš„é«˜çº§è¯†åˆ«æ³•-xA" class="headerlink" title="æ–¹æ³•äº”ï¼šåŸºäºæ··åˆç‰¹å¾çš„é«˜çº§è¯†åˆ«æ³•&#xA;"></a>æ–¹æ³•äº”ï¼šåŸºäºæ··åˆç‰¹å¾çš„é«˜çº§è¯†åˆ«æ³•&#xA;</h3><p>å¯¹äºæ›´å¤æ‚çš„ PDF æ°´å°ï¼ˆä¾‹å¦‚åŒ…å«æ–‡æœ¬å’Œå›¾åƒï¼‰ï¼Œè¿™ç§æ–¹æ³•ç»“åˆäº†æ–‡æœ¬å’Œå›¾åƒç‰¹å¾è¯†åˆ«ï¼Œèƒ½å¤Ÿæä¾›æ›´é«˜çš„è¯†åˆ«ç²¾åº¦ã€‚è¯·æ³¨æ„ï¼Œå›¾åƒå¤„ç†éƒ¨åˆ†éœ€è¦ numpy å’Œ opencv-python åº“ã€‚</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br></pre></td><td class="code"><pre><span class="line">import fitz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import cv2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# Placeholder for actual watermark text detection logic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def is\_watermark\_text(span):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   åˆ¤æ–­æ–‡æœ¬è·¨åº¦æ˜¯å¦ä¸ºæ°´å°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   ä½ å¯ä»¥æ ¹æ®å®é™…æƒ…å†µåœ¨è¿™é‡Œå®ç°æ›´å¤æ‚çš„æ–‡æœ¬æ°´å°åˆ¤æ–­é€»è¾‘ï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   ä¾‹å¦‚åŸºäºå­—ä½“ã€é¢œè‰²ã€å¤§å°ã€ä½ç½®ã€é‡å¤æ€§ç­‰ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# ç¤ºä¾‹ï¼šå‡è®¾æ‰€æœ‰æ»¡è¶³ç‰¹å®šå°ºå¯¸å’Œé¢œè‰²çš„æ–‡æœ¬éƒ½æ˜¯æ°´å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# çœŸå®åº”ç”¨ä¸­ï¼Œä½ éœ€è¦æ›´ç²¾ç¡®çš„é€»è¾‘</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   color\_int = span\[&quot;color&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   r = (color\_int &gt;&gt; 16) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;   g = (color\_int &gt;&gt; 8) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;   b = color\_int &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# å‡è®¾æ°´å°æ˜¯æµ…ç°è‰²ï¼Œå­—ä½“è¾ƒå¤§</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   if (100 &lt;= r &lt;= 220 and 100 &lt;= g &lt;= 220 and 100 &lt;= b &lt;= 220) and span\[&quot;size&quot;] &gt; 15:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       return True</span><br><span class="line"></span><br><span class="line">&amp;#x20;   return False</span><br><span class="line"></span><br><span class="line">def process\_watermark\_regions(page, text\_spans\_to\_redact, image\_regions\_to\_redact):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å¤„ç†è¯†åˆ«åˆ°çš„æ°´å°åŒºåŸŸã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# å¯¹æ–‡æœ¬æ°´å°åŒºåŸŸè¿›è¡Œå¤„ç†</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for span\_bbox in text\_spans\_to\_redact:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       page.add\_redact\_annot(fitz.Rect(span\_bbox))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# å¯¹å›¾åƒæ°´å°åŒºåŸŸè¿›è¡Œå¤„ç†</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for region\_bbox in image\_regions\_to\_redact:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       page.add\_redact\_annot(fitz.Rect(region\_bbox))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   page.apply\_redactions()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def advanced\_watermark\_removal(doc\_path, output\_path, watermark\_template\_path=None):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   æ ¹æ®æ··åˆç‰¹å¾ï¼ˆæ–‡æœ¬å’Œå›¾åƒï¼‰å»é™¤PDFä¸­çš„æ°´å°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å‚æ•°:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc\_path (str): è¾“å…¥PDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   output\_path (str): è¾“å‡ºPDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   watermark\_template\_path (str): å¯é€‰ï¼Œæ°´å°å›¾åƒæ¨¡æ¿çš„è·¯å¾„ï¼Œç”¨äºSIFTç‰¹å¾åŒ¹é…ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc = fitz.open(doc\_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   watermark\_template = None</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if watermark\_template\_path:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# Load watermark template in grayscale for SIFT</span><br><span class="line"></span><br><span class="line">&amp;#x20;       watermark\_template = cv2.imread(watermark\_template\_path, cv2.IMREAD\_GRAYSCALE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       if watermark\_template is None:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           print(f&quot;è­¦å‘Šï¼šæ— æ³•åŠ è½½æ°´å°æ¨¡æ¿å›¾åƒï¼š&#123;watermark\_template\_path&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           watermark\_template\_path = None # Disable image matching if template fails to load</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   sift = cv2.SIFT\_create()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   kp1, des1 = None, None</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if watermark\_template\_path and watermark\_template is not None:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       kp1, des1 = sift.detectAndCompute(watermark\_template, None)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for page in doc:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       text\_spans\_to\_redact = \[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       image\_regions\_to\_redact = \[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ç¬¬ä¸€æ­¥ï¼šæ–‡æœ¬ç‰¹å¾è¯†åˆ«</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       text\_infos = page.get\_text(&quot;dict&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       for block in text\_infos\[&quot;blocks&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           if &quot;lines&quot; in block:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               for line in block\[&quot;lines&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   for span in line\[&quot;spans&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       if is\_watermark\_text(span): # æ£€æŸ¥å­—ä½“/é¢œè‰²ç­‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                           text\_spans\_to\_redact.append(span\[&quot;bbox&quot;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ç¬¬äºŒæ­¥ï¼šå›¾åƒç‰¹å¾è¯†åˆ« (å¦‚æœæä¾›äº†æ°´å°æ¨¡æ¿)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       if watermark\_template\_path and watermark\_template is not None and des1 is not None:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           pix = page.get\_pixmap(matrix=fitz.Matrix(2,2)) # æé«˜æ¸²æŸ“åˆ†è¾¨ç‡ä»¥ä¾¿æ›´å¥½çš„ç‰¹å¾æ£€æµ‹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           img = cv2.cvtColor(np.frombuffer(pix.samples, np.uint8).reshape(</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               pix.h, pix.w, pix.n), cv2.COLOR\_RGB2GRAY) # è½¬ä¸ºç°åº¦å›¾è¿›è¡Œç‰¹å¾æ£€æµ‹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           kp2, des2 = sift.detectAndCompute(img, None)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           if des2 is not None and len(des1) &gt; 0 and len(des2) &gt; 0:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               \# ç‰¹å¾åŒ¹é…</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               matcher = cv2.BFMatcher()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               matches = matcher.knnMatch(des1, des2, k=2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;              &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               \# ç­›é€‰è‰¯å¥½çš„åŒ¹é…ç‚¹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               good\_matches = \[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               for m, n in matches:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   if m.distance &lt; 0.75 \* n.distance: # 0.75æ˜¯ç»éªŒå€¼ï¼Œå¯è°ƒ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       good\_matches.append(m)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;              &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               \# å¦‚æœåŒ¹é…ç‚¹è¶³å¤Ÿå¤šï¼Œåˆ™è®¤ä¸ºå­˜åœ¨å›¾åƒæ°´å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               if len(good\_matches) &gt; 10: # è‡³å°‘éœ€è¦10ä¸ªå¥½çš„åŒ¹é…ç‚¹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   \# å°è¯•æ‰¾åˆ°æ°´å°åœ¨é¡µé¢ä¸Šçš„å¤§è‡´ä½ç½®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   src\_pts = np.float32(\[kp1\[m.queryIdx].pt for m in good\_matches]).reshape(-1, 1, 2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   dst\_pts = np.float32(\[kp2\[m.trainIdx].pt for m in good\_matches]).reshape(-1, 1, 2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   \# ä½¿ç”¨ findHomography æ‰¾åˆ°å˜æ¢çŸ©é˜µ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   M, mask = cv2.findHomography(src\_pts, dst\_pts, cv2.RANSAC, 5.0)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   if M is not None:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       h, w = watermark\_template.shape</span><br><span class="line"></span><br><span class="line">&amp;#x20;                       pts = np.float32(\[\[0, 0], \[0, h-1], \[w-1, h-1], \[w-1, 0]]).reshape(-1, 1, 2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# åº”ç”¨å˜æ¢çŸ©é˜µï¼Œå¾—åˆ°æ°´å°åœ¨é¡µé¢ä¸Šçš„å››ä¸ªè§’ç‚¹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       dst = cv2.perspectiveTransform(pts, M)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       \# è®¡ç®—æ°´å°åŒºåŸŸçš„è¾¹ç•Œæ¡†</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       min\_x = int(np.min(dst\[:, 0, 0]) / pix.matrix.a) # è¿˜åŸåˆ°åŸå§‹PDFåæ ‡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       min\_y = int(np.min(dst\[:, 0, 1]) / pix.matrix.d)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       max\_x = int(np.max(dst\[:, 0, 0]) / pix.matrix.a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       max\_y = int(np.max(dst\[:, 0, 1]) / pix.matrix.d)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                       image\_regions\_to\_redact.append((min\_x, min\_y, max\_x, max\_y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ç»¼åˆå¤„ç†æ–‡æœ¬å’Œå›¾åƒæ°´å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       process\_watermark\_regions(page, text\_spans\_to\_redact, image\_regions\_to\_redact)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.save(output\_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# ç¤ºä¾‹ç”¨æ³•ï¼ˆéœ€è¦å‡†å¤‡ä¸€ä¸ª watermark\_template.png å›¾ç‰‡ä½œä¸ºæ°´å°æ¨¡æ¿ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# advanced\_watermark\_removal(&quot;input.pdf&quot;, &quot;output.pdf&quot;, &quot;watermark\_template.png&quot;)</span><br></pre></td></tr></table></figure></div>

<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li><p><strong>æ–‡æœ¬ç‰¹å¾è¯†åˆ«</strong>ï¼š æ²¿ç”¨äº†ä¹‹å‰ <code>is_watermark_text</code> çš„æ¦‚å¿µï¼Œä½†ä½ éœ€è¦æ ¹æ®å®é™…æ°´å°ç‰¹æ€§æ¥å®Œå–„è¿™ä¸ªé€»è¾‘ã€‚</p>
</li>
<li><p><strong>å›¾åƒç‰¹å¾è¯†åˆ«</strong>ï¼š</p>
<ul>
<li><p>å°† PDF é¡µé¢æ¸²æŸ“ä¸ºå›¾åƒï¼Œå¹¶è½¬æ¢ä¸ºç°åº¦å›¾ï¼Œä»¥ä¾¿è¿›è¡Œç‰¹å¾æ£€æµ‹ã€‚</p>
</li>
<li><p>ä½¿ç”¨ SIFT ç®—æ³•ï¼ˆæˆ–å…¶ä»–ç‰¹å¾åŒ¹é…ç®—æ³•å¦‚ ORB, SURFï¼‰æ¥æ£€æµ‹å¹¶åŒ¹é…å›¾åƒæ°´å°æ¨¡æ¿ã€‚</p>
</li>
<li><p>é€šè¿‡ <code>findHomography</code> è®¡ç®—æ°´å°åœ¨é¡µé¢ä¸Šçš„å˜æ¢ï¼Œä»è€Œç¡®å®šæ°´å°çš„ç²¾ç¡®ä½ç½®å’Œè¾¹ç•Œæ¡†ã€‚</p>
</li>
<li><p>æ³¨æ„ï¼š å›¾åƒå¤„ç†åº“ (å¦‚ OpenCV) é€šå¸¸åœ¨åƒç´ åæ ‡ç³»ä¸‹æ“ä½œï¼Œä½ éœ€è¦å°†æ£€æµ‹åˆ°çš„åƒç´ åæ ‡è½¬æ¢å› PyMuPDF ä½¿ç”¨çš„ PDF åæ ‡ã€‚</p>
</li>
</ul>
</li>
<li><p><strong>ç»¼åˆå¤„ç†</strong>ï¼š å°†æ–‡æœ¬å’Œå›¾åƒè¯†åˆ«çš„ç»“æœç»“åˆèµ·æ¥ï¼Œå¯¹æ‰€æœ‰è¯†åˆ«å‡ºçš„æ°´å°åŒºåŸŸè¿›è¡Œå¤„ç†ã€‚</p>
</li>
</ul>
<p><strong>éš¾æ˜“åº¦</strong>ï¼šâ˜…â˜…â˜…â˜…â˜†</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š è¯†åˆ«ç²¾åº¦é«˜ï¼Œé€‚ç”¨äºå¤æ‚æ°´å°ç¯å¢ƒï¼ˆæ–‡æœ¬ä¸å›¾åƒæ··åˆï¼‰ï¼Œé²æ£’æ€§å¼ºã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š å®ç°å¤æ‚ï¼Œéœ€è¦æ°´å°æ¨¡æ¿ï¼Œå¤„ç†é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œéœ€è¦é¢å¤–çš„å›¾åƒå¤„ç†åº“ã€‚</p>
<h3 id="æ–¹æ³•å…­ï¼šåŸºäº-PDF-åº•å±‚ç»“æ„çš„ç»ˆææ–¹æ¡ˆ-xA"><a href="#æ–¹æ³•å…­ï¼šåŸºäº-PDF-åº•å±‚ç»“æ„çš„ç»ˆææ–¹æ¡ˆ-xA" class="headerlink" title="æ–¹æ³•å…­ï¼šåŸºäº PDF åº•å±‚ç»“æ„çš„ç»ˆææ–¹æ¡ˆ&#xA;"></a>æ–¹æ³•å…­ï¼šåŸºäº PDF åº•å±‚ç»“æ„çš„ç»ˆææ–¹æ¡ˆ&#xA;</h3><p>è¿™ç§æ–¹æ³•æœ€ä¸ºå½»åº•ï¼Œå› ä¸ºå®ƒç›´æ¥æ“ä½œ PDF æ–‡ä»¶çš„åº•å±‚ç»“æ„ã€‚ä½†å®ƒä¹Ÿè¦æ±‚ä½ å¯¹ PDF è§„èŒƒæœ‰æ·±å…¥çš„äº†è§£ï¼Œæ“ä½œä¸å½“å¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶æŸåã€‚</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">import fitz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def deep\_watermark\_removal(doc\_path, output\_path):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   é€šè¿‡ç›´æ¥æ“ä½œPDFçš„XObjectå’Œå†…å®¹æµï¼Œå°è¯•å»é™¤æ°´å°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   è¿™æ˜¯ä¸€ç§æ›´åº•å±‚ã€æ›´å½»åº•çš„æ–¹å¼ï¼Œä½†éœ€è¦å¯¹PDFç»“æ„æœ‰ä¸€å®šäº†è§£ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   æ³¨æ„ï¼šæ­¤æ–¹æ³•å¯èƒ½éå¸¸å…·ä½“ï¼Œä¸é€‚ç”¨äºæ‰€æœ‰æ°´å°ç±»å‹ï¼Œä¸”æ“ä½œä¸å½“å¯èƒ½æŸåPDFã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc = fitz.open(doc\_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for page\_num, page in enumerate(doc):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# å°è¯•é€šè¿‡åˆ é™¤XObjectï¼ˆå¤–éƒ¨å¯¹è±¡ï¼Œå¯èƒ½æ˜¯å›¾åƒæˆ–Form XObjectï¼‰æ¥å»é™¤æ°´å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è¿™éœ€è¦çŒœæµ‹å“ªäº›XObjectæ˜¯æ°´å°ã€‚é€šå¸¸æ°´å°æ˜¯é€æ˜çš„æˆ–åœ¨åº•å±‚ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# PyMuPDFæ²¡æœ‰ç›´æ¥çš„ delete\_object æ–¹æ³•ï¼Œé€šå¸¸çš„åšæ³•æ˜¯é‡æ–°æ„å»ºå†…å®¹æµæˆ–ç”¨add\_redact\_annotã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# å¦‚æœæ°´å°æ˜¯ä½œä¸ºç‹¬ç«‹XObjectåµŒå…¥çš„ï¼Œä½ å¯ä»¥å°è¯•è¯†åˆ«å¹¶æ›¿æ¢é¡µé¢å†…å®¹æµä¸­å¯¹å®ƒä»¬çš„å¼•ç”¨ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è¿™æ˜¯ä¸€ä¸ªéå¸¸é«˜çº§ä¸”é£é™©é«˜çš„æ“ä½œï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ç›´æ¥ä¿®æ”¹XObjectï¼Œè€Œæ˜¯ä¾èµ–redactionã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# å¦ä¸€ç§æ€è·¯æ˜¯æ£€æŸ¥é¡µé¢å†…å®¹æµä¸­æ˜¯å¦å­˜åœ¨ç‰¹å®šçš„æ“ä½œç¬¦ï¼Œä¾‹å¦‚è®¾ç½®é€æ˜åº¦æˆ–ç‰¹å®šé¢œè‰²ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ä½†è¿™éœ€è¦æ›´æ·±å…¥çš„è§£æå†…å®¹æµã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ç›®å‰PyMuPDFæ²¡æœ‰ç›´æ¥æš´éœ²ä¿®æ”¹/åˆ é™¤åº•å±‚XObjectçš„APIï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# add\_redact\_annot æ˜¯æœ€å®‰å…¨å’Œæ¨èçš„æ–¹å¼æ¥â€œåˆ é™¤â€é¡µé¢å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# å¦‚æœæ°´å°æ˜¯æ–‡æœ¬ï¼Œå¯ä»¥ç»“åˆæ–¹æ³•1-4æ¥è¯†åˆ«ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# å¦‚æœæ°´å°æ˜¯å›¾åƒï¼Œä½†ä¸æ˜¯ä½œä¸ºXObjectç›´æ¥æ’å…¥ï¼Œè€Œæ˜¯ä½œä¸ºèƒŒæ™¯ï¼Œåˆ™éœ€è¦æ¸²æŸ“åå¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ç¤ºä¾‹ï¼šå°è¯•æŸ¥æ‰¾å¹¶åˆ é™¤åç§°ä¸­å¯èƒ½åŒ…å«â€œWatermarkâ€çš„Form XObjectå¼•ç”¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è¿™æ˜¯ä¸€ä¸ªè±¡å¾æ€§çš„æ“ä½œï¼Œå®é™…æ“ä½œä¼šå¤æ‚å¾—å¤šã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è·å–é¡µé¢çš„å†…å®¹æµ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#contents = page.get\_contents() # è¿™æ˜¯å†…å®¹æµçš„åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå¯¹è±¡ID</span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#for item\_id in contents:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#    item\_obj = doc.get\_pdf\_object(item\_id) # è·å–å®é™…çš„PDFå¯¹è±¡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#    if item\_obj:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        content\_bytes = item\_obj.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # æ£€æŸ¥å†…å®¹æµä¸­æ˜¯å¦æœ‰æ°´å°ç›¸å…³çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚ /DeviceGray Cs, /CA 0.x, /ca 0.x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # è¿™æ˜¯ä¸€ä¸ªé«˜åº¦å®šåˆ¶åŒ–çš„è¿‡ç¨‹ï¼Œå–å†³äºæ°´å°æ˜¯å¦‚ä½•è¢«åˆ›å»ºçš„ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # é€šå¸¸æ°´å°æ–‡æœ¬ä¼šä½¿ç”¨ç‰¹å®šçš„å­—ä½“ã€é¢œè‰²å’Œé€æ˜åº¦è®¾ç½®ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # æˆ‘ä»¬å¯ä»¥å°è¯•æ›¿æ¢æ‰è¿™äº›è®¾ç½®æˆ–å…¶ç›¸å…³çš„æ–‡æœ¬/å›¾åƒç»˜å›¾æŒ‡ä»¤ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # ä¾‹å¦‚ï¼Œå¦‚æœæ°´å°è¢«æ ‡è®°ä¸º /Watermarkï¼Œå¯ä»¥å°è¯•ç§»é™¤è¿™ä¸ªæ ‡è®°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # è­¦å‘Šï¼šç›´æ¥ä¿®æ”¹å†…å®¹æµéå¸¸å±é™©ï¼Œå¯èƒ½å¯¼è‡´PDFæŸåã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # content\_stream = content\_bytes.replace(b&quot;/Watermark&quot;, b&quot;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # å¦‚æœå†…å®¹æµå¯¹è±¡æ˜¯å¯å†™çš„ï¼Œå¯ä»¥å°è¯•æ›´æ–°å®ƒ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        # doc.update\_object(item\_id, content\_stream)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \#        pass # å®é™…ä¸æ‰§è¡Œç›´æ¥ä¿®æ”¹ï¼Œè€Œæ˜¯ä½¿ç”¨æ›´å®‰å…¨çš„redaction</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ç”±äºPyMuPDFæ²¡æœ‰ç›´æ¥åˆ é™¤XObjectçš„ç®€å•APIï¼Œå¹¶ä¸”ç›´æ¥ä¿®æ”¹å†…å®¹æµé£é™©é«˜ï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è¿™ç§â€œç»ˆææ–¹æ¡ˆâ€é€šå¸¸æŒ‡çš„æ˜¯åœ¨æ›´åº•å±‚çš„PDFè§£æåº“ä¸­å®ç°ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# åœ¨PyMuPDFçš„è¯­å¢ƒä¸‹ï¼Œæœ€å®‰å…¨å’Œæ¨èçš„â€œåº•å±‚â€å¤„ç†æ˜¯ä½¿ç”¨ redact\_annot æ¥è¦†ç›–ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# å¦‚æœæ°´å°æ˜¯ä½œä¸º Form XObject åµŒå…¥ï¼Œä¸”å®ƒä»¬æ˜¯åŠé€æ˜çš„ï¼Œ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# PyMuPDF çš„ page.get\_text(&quot;dict&quot;) æˆ– page.get\_images() å¯èƒ½æ— æ³•ç›´æ¥è¯†åˆ«ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# æ­¤æ—¶ï¼Œå¯èƒ½éœ€è¦ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# 1. éå†é¡µé¢æ‰€æœ‰å¯¹è±¡ï¼ˆPyMuPDFä¸ç›´æ¥æä¾›æ­¤åŠŸèƒ½ï¼Œé™¤éé€šè¿‡é«˜çº§è§£æï¼‰ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# 2. æ¸²æŸ“é¡µé¢å¹¶è¿›è¡Œå›¾åƒå¤„ç†ï¼Œè¯†åˆ«æ°´å°åŒºåŸŸï¼Œç„¶åè¿›è¡Œ redactã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;      &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# æ€»ç»“ï¼šæ­¤æ–¹æ³•åœ¨PyMuPDFä¸­å®ç°éå¸¸å›°éš¾ä¸”ä¸æ¨èï¼Œé™¤éå¯¹PDFå†…éƒ¨ç»“æ„æœ‰ææ·±ç†è§£ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# æ¨èä½¿ç”¨å‰é¢æ›´å®‰å…¨ã€æ›´æ˜“äºæ§åˆ¶çš„åŸºäºç‰¹å¾çš„redactionæ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ä¸ºäº†è®©è¿™ä¸ªå‡½æ•°æœ‰å®é™…æ„ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥è®©å®ƒåœ¨éå¸¸æ˜ç¡®çš„æƒ…å†µä¸‹æ‰§è¡Œredaction</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ä¾‹å¦‚ï¼Œå¦‚æœä½ çŸ¥é“æ°´å°æ˜¯æŸä¸ªç‰¹å®šåç§°çš„Form XObjectï¼Œä½†é€šå¸¸PyMuPDFä¸ç›´æ¥æš´éœ²è¿™ä¸ª</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       print(f&quot;Warning: Method 6 (deep\_watermark\_removal) in PyMuPDF is generally not feasible for direct object deletion without significant PDF internal structure parsing and modification, which is outside the scope of simple PyMuPDF APIs. Using redaction is the recommended safe approach.&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# å¦‚æœæ°´å°æ˜¯é€æ˜åº¦å¾ˆé«˜çš„å›¾åƒï¼Œå¯èƒ½éœ€è¦æ¸²æŸ“é¡µé¢ç„¶åç”¨å›¾åƒå¤„ç†æ¥è¯†åˆ«å¹¶redact</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# è¿™é‡Œä¸ºäº†é¿å…è¯¯å¯¼ï¼Œä¸æä¾›å…·ä½“å®ç°ï¼Œä»…ä¿ç•™æ¡†æ¶ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.save(output\_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.close()</span><br></pre></td></tr></table></figure></div>

<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li><p>è¿™ä¸ªæ–¹æ³•æ—¨åœ¨ç›´æ¥æ“ä½œ PDF çš„ XObject (å¤–éƒ¨å¯¹è±¡ï¼Œå¯ä»¥æ˜¯å›¾åƒæˆ– Form XObject) å’Œå†…å®¹æµã€‚</p>
</li>
<li><p><strong>é‡è¦æç¤º</strong>ï¼š PyMuPDF (Fitz) å¹¶æ²¡æœ‰ç›´æ¥æš´éœ²ä¿®æ”¹æˆ–åˆ é™¤åº•å±‚ PDF å¯¹è±¡çš„ APIã€‚ <code>add_redact_annot</code> æ˜¯ PyMuPDF ä¸­æœ€å®‰å…¨å’Œæ¨èçš„æ–¹å¼æ¥ â€œåˆ é™¤â€ é¡µé¢å†…å®¹çš„ã€‚ç›´æ¥ä¿®æ”¹ PDF çš„åº•å±‚å†…å®¹æµéå¸¸å±é™©ï¼Œæ“ä½œä¸å½“å¾ˆå¯èƒ½å¯¼è‡´ PDF æ–‡ä»¶æŸåä¸”æ— æ³•æ‰“å¼€ã€‚</p>
</li>
<li><p>å› æ­¤ï¼Œæˆ‘è°ƒæ•´äº†æ­¤æ–¹æ³•çš„æè¿°å’Œä»£ç ç¤ºä¾‹ï¼Œå¼ºè°ƒå…¶å¤æ‚æ€§å’Œé£é™©ï¼Œå¹¶æŒ‡å‡ºåœ¨ PyMuPDF ä¸­ï¼Œæ›´æ¨èä½¿ç”¨ <code>add_redact_annot</code> æ¥å®ç° â€œåˆ é™¤â€ æ•ˆæœã€‚å¦‚æœä½ çœŸçš„éœ€è¦æ·±å…¥åˆ° PDF åº•å±‚ä¿®æ”¹ï¼Œå¯èƒ½éœ€è¦æ›´ä¸“ä¸šçš„ PDF å¤„ç†åº“æˆ–å¯¹ PDF è§„èŒƒæœ‰æå…¶æ·±å…¥çš„äº†è§£ã€‚</p>
</li>
</ul>
<p><strong>éš¾æ˜“åº¦</strong>ï¼šâ˜…â˜…â˜…â˜…â˜… (ç†è®ºä¸Š)</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š ç†è®ºä¸Šå¯ä»¥å½»åº•æ¸…é™¤ä¸ç•™ç—•è¿¹ï¼Œé€‚ç”¨äºå„ç§ç±»å‹æ°´å°ã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š å®ç°éå¸¸å¤æ‚ï¼Œéœ€è¦æ·±å…¥çš„ PDF ç»“æ„çŸ¥è¯†ï¼Œä¸”åœ¨ PyMuPDF ä¸­ç›´æ¥å®ç°æ­¤ç±»æ“ä½œéš¾åº¦æé«˜ä¸”é£é™©å¤§ã€‚</p>
<p>æ–¹æ³•å¯¹æ¯”ä¸é€‰æ‹©å»ºè®®</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•&#xA;</th>
<th>éš¾æ˜“åº¦&#xA;</th>
<th>é€‚ç”¨åœºæ™¯&#xA;</th>
<th>å…³é”®ä¼˜åŠ¿&#xA;</th>
<th>å±€é™æ€§&#xA;</th>
</tr>
</thead>
<tbody><tr>
<td>å­—ä½“å¤§å° + æ—‹è½¬è§’åº¦&#xA;</td>
<td>â˜…â˜…â˜…â˜†â˜†&#xA;</td>
<td>æ°´å°æœ‰å›ºå®šå¤§å°å’Œå€¾æ–œè§’åº¦&#xA;</td>
<td>å®ç°ç›¸å¯¹ç®€å•ï¼Œè¯†åˆ«å‡†ç¡®ç‡è¾ƒé«˜&#xA;</td>
<td>éœ€è¦ç²¾ç¡®çš„å¤§å°å’Œè§’åº¦å‚æ•°&#xA;</td>
</tr>
<tr>
<td>é€æ˜åº¦ + é¢œè‰²&#xA;</td>
<td>â˜…â˜…â˜…â˜…â˜†&#xA;</td>
<td>æ°´å°æœ‰å›ºå®šé¢œè‰²ï¼ˆç‰¹åˆ«æ˜¯æµ…è‰²ï¼‰&#xA;</td>
<td>å¯¹æµ…è‰²æ°´å°æ•ˆæœå¥½&#xA;</td>
<td>é€æ˜åº¦æå–æ˜¯éš¾ç‚¹ï¼Œå¯èƒ½éœ€è¦æ·±å…¥è§£æ PDF å†…éƒ¨ç»“æ„æˆ–å€ŸåŠ©å›¾åƒå¤„ç†åº“&#xA;</td>
</tr>
<tr>
<td>å¤šç‰¹å¾ç»¼åˆ&#xA;</td>
<td>â˜…â˜…â˜…â˜…â˜…&#xA;</td>
<td>æ°´å°ç‰¹å¾æ˜ç¡®ä¸”å›ºå®š&#xA;</td>
<td>è¯†åˆ«å‡†ç¡®æ€§é«˜ï¼Œè¯¯åˆ¤ç‡æä½&#xA;</td>
<td>å®ç°ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ç²¾ç¡®çš„æ°´å°ç‰¹å¾å‚æ•°&#xA;</td>
</tr>
<tr>
<td>åŸºäºæ–‡æœ¬ç‰¹å¾&#xA;</td>
<td>â˜…â˜…â˜†â˜†â˜†&#xA;</td>
<td>ç®€å•æ–‡æœ¬æ°´å°&#xA;</td>
<td>å®ç°ç®€å•ï¼Œå¤„ç†é€Ÿåº¦å¿«&#xA;</td>
<td>ä»…é€‚ç”¨äºæ–‡æœ¬æ°´å°ï¼Œæ— æ³•å¤„ç†å›¾åƒæ°´å°&#xA;</td>
</tr>
<tr>
<td>æ··åˆç‰¹å¾è¯†åˆ«&#xA;</td>
<td>â˜…â˜…â˜…â˜…â˜†&#xA;</td>
<td>å¤æ‚æ°´å°ç¯å¢ƒï¼ˆæ–‡æœ¬ä¸å›¾åƒæ··åˆï¼‰&#xA;</td>
<td>è¯†åˆ«ç²¾åº¦é«˜&#xA;</td>
<td>å®ç°å¤æ‚ï¼Œéœ€è¦æ°´å°æ¨¡æ¿ï¼Œå¤„ç†é€Ÿåº¦æ…¢&#xA;</td>
</tr>
<tr>
<td>åº•å±‚ç»“æ„å¤„ç†&#xA;</td>
<td>â˜…â˜…â˜…â˜…â˜…&#xA;</td>
<td>å„ç§ç±»å‹æ°´å°&#xA;</td>
<td>ç†è®ºä¸Šæœ€å½»åº•&#xA;</td>
<td>é«˜é£é™©ï¼ŒPyMuPDF ä¸­éš¾ä»¥ç›´æ¥å®ç°ï¼Œéœ€è¦æ·±åšçŸ¥è¯†&#xA;</td>
</tr>
</tbody></table>
<p>ç‰¹å¾å‚æ•°æå–æ–¹æ³•</p>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è·å–æ°´å°çš„ç‰¹å¾å‚æ•°ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆæ­¥æå–ï¼š</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line">import fitz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">from collections import Counter</span><br><span class="line"></span><br><span class="line">def extract\_watermark\_features(pdf\_path, page\_num=0):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å°è¯•æå–PDFé¡µé¢ä¸­å¯èƒ½çš„æ°´å°æ–‡æœ¬ç‰¹å¾ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   æ­¤å‡½æ•°ä¼šè¿”å›é¡µé¢ä¸­æœ€å¸¸è§çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦å’Œé¢œè‰²ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   è¿™ä»…æ˜¯ä¸€ä¸ªåˆæ­¥åˆ†æå·¥å…·ï¼Œå¯¹äºå¤æ‚æ°´å°å¯èƒ½éœ€è¦äººå·¥ç¡®è®¤æˆ–æ›´å¤æ‚çš„ç»Ÿè®¡ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å‚æ•°:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   pdf\_path (str): PDFæ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   page\_num (int): è¦åˆ†æçš„é¡µé¢ç¼–å· (é»˜è®¤ä¸ºç¬¬ä¸€é¡µ)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   è¿”å›:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   dict: åŒ…å«å¯èƒ½çš„æ°´å°ç‰¹å¾çš„å­—å…¸ï¼Œå¦‚ &quot;font\_size&quot;, &quot;rotation\_angle&quot;, &quot;color\_rgb&quot;, &quot;opacity&quot;(å ä½)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc = fitz.open(pdf\_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   page = doc\[page\_num]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# ç”¨äºå­˜å‚¨å¯èƒ½çš„æ°´å°ç‰¹å¾</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   possible\_font\_sizes = \[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   possible\_rotations = \[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   possible\_colors = \[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# è·å–é¡µé¢ä¸Šçš„æ‰€æœ‰æ–‡æœ¬å’Œå®ƒä»¬çš„å±æ€§</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   text\_infos = page.get\_text(&quot;dict&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   for block in text\_infos\[&quot;blocks&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       if &quot;lines&quot; in block:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           for line in block\[&quot;lines&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               for span in line\[&quot;spans&quot;]:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   \# æå–å­—ä½“å¤§å°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   possible\_font\_sizes.append(round(span\[&quot;size&quot;], 1)) # å››èˆäº”å…¥åˆ°å°æ•°ç‚¹å1ä½ï¼Œä¾¿äºç»Ÿè®¡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   \# è®¡ç®—æ—‹è½¬è§’åº¦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   matrix = fitz.Matrix(span\[&quot;matrix&quot;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   rotation = round(math.degrees(math.atan2(matrix.b, matrix.a)), 1) # å››èˆäº”å…¥ï¼Œä¾¿äºç»Ÿè®¡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   possible\_rotations.append(rotation)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   \# æå–é¢œè‰²ä¿¡æ¯</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   color\_int = span\[&quot;color&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;                   r = (color\_int &gt;&gt; 16) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                   g = (color\_int &gt;&gt; 8) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                   b = color\_int &amp; 0xFF</span><br><span class="line"></span><br><span class="line">&amp;#x20;                   possible\_colors.append((r, g, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# ç®€å•åˆ†æï¼šæ‰¾å‡ºæœ€å¸¸è§çš„ç‰¹å¾å€¼ä½œä¸ºæ°´å°ç‰¹å¾</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \# å®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„èšç±»åˆ†ææˆ–äººå·¥ç¡®è®¤</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;  &amp;#x20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   font\_size = None</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if possible\_font\_sizes:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       font\_size = Counter(possible\_font\_sizes).most\_common(1)\[0]\[0]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   rotation\_angle = None</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if possible\_rotations:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       rotation\_angle = Counter(possible\_rotations).most\_common(1)\[0]\[0]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# æ—‹è½¬è§’åº¦å¯èƒ½ä¸ºè´Ÿï¼Œå°†å…¶è§„èŒƒåŒ–åˆ° 0-360 åº¦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       if rotation\_angle &lt; 0:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           rotation\_angle += 360</span><br><span class="line"></span><br><span class="line">&amp;#x20;   color\_rgb = None</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if possible\_colors:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       color\_rgb = Counter(possible\_colors).most\_common(1)\[0]\[0]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   doc.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   return &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       &quot;font\_size&quot;: font\_size,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       &quot;rotation\_angle&quot;: rotation\_angle,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       &quot;color\_rgb&quot;: color\_rgb,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       &quot;opacity&quot;: 0.5  # è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹å€¼ï¼Œå®é™…ä¸­é€æ˜åº¦æå–éå¸¸å¤æ‚ï¼Œéœ€è¦æ‰‹åŠ¨ç¡®è®¤æˆ–æ›´é«˜çº§åˆ†æ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# ç¤ºä¾‹ç”¨æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# features = extract\_watermark\_features(&quot;your\_watermarked\_document.pdf&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# print(features)</span><br></pre></td></tr></table></figure></div>

<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li><p>æ­¤å‡½æ•°ä¼šéå†æŒ‡å®šé¡µé¢çš„æ‰€æœ‰æ–‡æœ¬è·¨åº¦ï¼Œæ”¶é›†å®ƒä»¬çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦å’Œé¢œè‰²ã€‚</p>
</li>
<li><p>ä¸ºäº†æ–¹ä¾¿ç»Ÿè®¡ï¼Œå¯¹æµ®ç‚¹æ•°ï¼ˆå¤§å°å’Œè§’åº¦ï¼‰è¿›è¡Œäº†å››èˆäº”å…¥ã€‚</p>
</li>
<li><p>ä½¿ç”¨ <code>collections.Counter</code> æ‰¾å‡ºæœ€å¸¸è§çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦å’Œé¢œè‰²ï¼Œä½œä¸ºå¯èƒ½çš„æ°´å°ç‰¹å¾ã€‚</p>
</li>
<li><p>æ³¨æ„ï¼š æå–é€æ˜åº¦ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œ<code>opacity</code> å‚æ•°åœ¨æ­¤å¤„ä»ä½œä¸ºå ä½ç¬¦ï¼Œéœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚æ‰‹åŠ¨è§‚å¯Ÿæˆ–æ›´å¤æ‚çš„ PDF å†…å®¹æµè§£æï¼‰æ¥ç¡®å®šã€‚</p>
</li>
</ul>
<p>æ€»ç»“ä¸æœ€ä½³å®è·µ</p>
<p>åŸºäºç‰¹å¾çš„ PDF æ°´å°å¤„ç†æ–¹æ³•èƒ½å¤Ÿå®ç°æ›´ç²¾ç¡®çš„æ°´å°è¯†åˆ«å’Œå»é™¤ï¼Œä½†è¿™è¦æ±‚ä½ å¯¹æ°´å°çš„ç‰¹å¾æœ‰å……åˆ†äº†è§£ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘å»ºè®®ä½ éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š</p>
<ol>
<li><p><strong>é¢„å¤„ç†åˆ†æ</strong>ï¼š é¦–å…ˆä½¿ç”¨ <code>extract_watermark_features</code> å‡½æ•°åˆ†ææ°´å°ç‰¹å¾ï¼Œåˆæ­¥äº†è§£æ°´å°çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦ã€é¢œè‰²ç­‰å…³é”®ä¿¡æ¯ã€‚å¿…è¦æ—¶ï¼Œæ‰‹å·¥è§‚å¯Ÿæ°´å°ï¼Œç¡®è®¤å…¶é€æ˜åº¦ã€å…·ä½“æ–‡æœ¬å†…å®¹æˆ–å›¾åƒæ ·å¼ã€‚</p>
</li>
<li><p><strong>ä»ç®€åˆ°ç¹å°è¯•</strong>ï¼š ä»æœ€ç®€å•çš„æ–¹æ³•å¼€å§‹ã€‚å¦‚æœæ°´å°æ˜¯çº¯æ–‡æœ¬ä¸”ç‰¹å¾æ˜æ˜¾ï¼Œå¯ä»¥å…ˆå°è¯• åŸºäºæ–‡æœ¬ç‰¹å¾çš„ç›´æ¥åˆ é™¤æ³•ã€‚å¦‚æœæ°´å°æœ‰å›ºå®šçš„å­—ä½“å¤§å°å’Œå€¾æ–œè§’åº¦ï¼Œå°±ç”¨ åŸºäºå­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦çš„æ–¹æ³•ã€‚åªæœ‰å½“ç®€å•æ–¹æ³•æ•ˆæœä¸ä½³æ—¶ï¼Œå†é€æ­¥å¢åŠ ç‰¹å¾ç»´åº¦ï¼Œå°è¯• å¤šç‰¹å¾ç»¼åˆè¯†åˆ«ã€‚</p>
</li>
<li><p><strong>åˆç†è°ƒæ•´å‚æ•°</strong>ï¼š æ ¹æ®å®é™…æ°´å°æƒ…å†µç»†è‡´è°ƒæ•´åŒ¹é…å®¹å·®å€¼ï¼Œåœ¨è¯†åˆ«å‡†ç¡®ç‡å’Œè¯¯åˆ¤ç‡ä¹‹é—´å–å¾—æœ€ä½³å¹³è¡¡ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå­—ä½“å¤§å°ï¼Œå¯ä»¥å…è®¸ 1.0 åˆ° 2.0 çš„è¯¯å·®èŒƒå›´ï¼›å¯¹äºæ—‹è½¬è§’åº¦ï¼Œå¯å…è®¸ 3 åˆ° 5 åº¦å·¦å³çš„è¯¯å·®ã€‚</p>
</li>
<li><p><strong>å¤æ‚åœºæ™¯ç»„åˆ</strong>ï¼š å¯¹äºåŒ…å«å¤šç§ç±»å‹æ°´å°çš„å¤æ‚ PDFï¼Œè€ƒè™‘ç»“åˆå¤šç§æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ—¢æœ‰æ–‡æœ¬åˆæœ‰å›¾åƒçš„æ··åˆæ°´å°ï¼Œå¯ä»¥ç»“åˆ æ··åˆç‰¹å¾è¯†åˆ«æ³•ã€‚</p>
</li>
<li><p><strong>æ‰¹é‡å¤„ç†æŠ€å·§</strong>ï¼š å¦‚æœä½ éœ€è¦å¤„ç†å¤§é‡ PDF æ–‡ä»¶ï¼Œåˆ©ç”¨å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹å¯ä»¥æ˜¾è‘—æé«˜å¤„ç†æ•ˆç‡ã€‚</p>
</li>
</ol>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">from concurrent.futures import ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def batch\_process\_pdfs(file\_list, output\_dir, \*\*watermark\_params):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   æ‰¹é‡å¤„ç†PDFæ–‡ä»¶ï¼Œä½¿ç”¨å¤šçº¿ç¨‹æé«˜æ•ˆç‡ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   å‚æ•°:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   file\_list (list): åŒ…å«æ‰€æœ‰å¾…å¤„ç†PDFæ–‡ä»¶è·¯å¾„çš„åˆ—è¡¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   output\_dir (str): å¤„ç†åPDFæ–‡ä»¶çš„è¾“å‡ºç›®å½•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   \*\*watermark\_params: ä¼ é€’ç»™ remove\_watermark\_by\_multiple\_features çš„æ°´å°ç‰¹å¾å‚æ•°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   os.makedirs(output\_dir, exist\_ok=True) # ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;   with ThreadPoolExecutor(max\_workers=os.cpu\_count()) as executor: # ä½¿ç”¨CPUæ ¸å¿ƒæ•°ä½œä¸ºæœ€å¤§å·¥ä½œçº¿ç¨‹æ•°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       futures = \[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       for file\_path in file\_list:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           file\_name = os.path.basename(file\_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           output\_path = os.path.join(output\_dir, file\_name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           \# æäº¤ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           futures.append(executor.submit(</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               remove\_watermark\_by\_multiple\_features,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               file\_path, output\_path,\*\* watermark\_params</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           ))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       \# ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;       for future in futures:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           try:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               future.result() # è·å–ç»“æœï¼Œå¦‚æœä»»åŠ¡æœ‰å¼‚å¸¸ä¼šåœ¨è¿™é‡ŒæŠ›å‡º</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               print(f&quot;æ–‡ä»¶å¤„ç†å®Œæˆï¼š&#123;file\_path&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;           except Exception as exc:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;#x20;               print(f&quot;æ–‡ä»¶ &#123;file\_path&#125; å¤„ç†æ—¶å‘ç”Ÿé”™è¯¯ï¼š&#123;exc&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# ç¤ºä¾‹ç”¨æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# pdf\_files\_to\_process = \[&quot;doc1.pdf&quot;, &quot;doc2.pdf&quot;] # ä½ çš„PDFæ–‡ä»¶åˆ—è¡¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# output\_folder = &quot;processed\_pdfs&quot;</span><br><span class="line"></span><br><span class="line">\# watermark\_features = &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\#     &quot;font\_size&quot;: 36.0,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\#     &quot;rotation\_angle&quot;: 30.0,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\#     &quot;color\_rgb&quot;: (192, 192, 192) # æµ…ç°è‰²</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\# batch\_process\_pdfs(pdf\_files\_to\_process, output\_folder, \*\*watermark\_features)</span><br></pre></td></tr></table></figure></div>



<ol>
<li><strong>æ“ä½œå®‰å…¨ä¿éšœ</strong>ï¼š åœ¨å¤„ç†ä»»ä½•é‡è¦æ–‡ä»¶ä¹‹å‰ï¼ŒåŠ¡å¿…å…ˆå¤‡ä»½åŸå§‹æ–‡ä»¶ï¼è¿™èƒ½ç¡®ä¿å³ä½¿å¤„ç†ä¸å½“ï¼Œä½ ä¹Ÿä¸ä¼šä¸¢å¤±åŸå§‹æ•°æ®ã€‚åŒæ—¶ï¼Œè¯·å§‹ç»ˆéµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œä»…å¤„ç†ä½ æœ‰æƒä¿®æ”¹çš„æ–‡æ¡£ï¼Œå°Šé‡çŸ¥è¯†äº§æƒå’Œç‰ˆæƒä¿æŠ¤ã€‚</li>
</ol>
<p>é€šè¿‡åˆç†é€‰æ‹©å’Œç»„åˆè¿™äº›æ–¹æ³•ï¼Œä½ å°±èƒ½é«˜æ•ˆä¸”ç²¾å‡†åœ°å¤„ç†å„ç§å…·æœ‰ç‰¹å®šç‰¹å¾çš„ PDF æ°´å°ã€‚</p>

		</div>

		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/Python/">#Python</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/PyMuPDF/">#PyMuPDF</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/PDF/">#PDF</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E6%B0%B4%E5%8D%B0%E5%8E%BB%E9%99%A4/">#æ°´å°å»é™¤</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E7%89%B9%E5%BE%81%E8%AF%86%E5%88%AB/">#ç‰¹å¾è¯†åˆ«</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/">#æ–‡æœ¬å¤„ç†</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/07/15/Python-%E9%AD%94%E6%B3%95%EF%BC%9A%E4%B8%80%E9%94%AE%E8%AE%A9-Excel-%E6%AD%A3%E7%A1%AE%E9%80%89%E9%A1%B9%E3%80%8C%E8%84%B8%E7%BA%A2%E3%80%8D/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">Python é­”æ³•ï¼šä¸€é”®è®© Excel æ­£ç¡®é€‰é¡¹ã€Œè„¸çº¢ã€</span>
						<span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/07/15/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%88%AC%E8%99%AB%E7%94%9F%E6%B4%BB%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%9F%BA%E7%A1%80%E5%BA%93%E5%BA%94%E7%94%A8/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">ä»é›¶å¼€å§‹çš„çˆ¬è™«ç”Ÿæ´»ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºä¸åŸºç¡€åº“åº”ç”¨</span>
						<span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">ç›®å½•</div>
		<div class="page-title">Python é­”æ³•ï¼šä¸€é”®è®© Excel æ­£ç¡®é€‰é¡¹ã€Œè„¸çº¢ã€</div>
		<ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E5%9F%BA%E4%BA%8E%E5%AD%97%E4%BD%93%E5%A4%A7%E5%B0%8F%E5%92%8C%E6%97%8B%E8%BD%AC%E8%A7%92%E5%BA%A6%E7%9A%84%E6%B0%B4%E5%8D%B0%E8%AF%86%E5%88%AB-xA"><span class="nav-text">æ–¹æ³•ä¸€ï¼šåŸºäºå­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦çš„æ°´å°è¯†åˆ«
</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%9F%BA%E4%BA%8E%E9%80%8F%E6%98%8E%E5%BA%A6%E5%92%8C%E9%A2%9C%E8%89%B2%E7%9A%84%E6%B0%B4%E5%8D%B0%E8%AF%86%E5%88%AB-xA"><span class="nav-text">æ–¹æ³•äºŒï¼šåŸºäºé€æ˜åº¦å’Œé¢œè‰²çš„æ°´å°è¯†åˆ«
</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9A%E7%BB%BC%E5%90%88%E5%A4%9A%E7%89%B9%E5%BE%81%E7%9A%84%E6%B0%B4%E5%8D%B0%E8%AF%86%E5%88%AB-xA"><span class="nav-text">æ–¹æ³•ä¸‰ï¼šç»¼åˆå¤šç‰¹å¾çš„æ°´å°è¯†åˆ«
</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E5%9B%9B%EF%BC%9A%E5%9F%BA%E4%BA%8E%E6%96%87%E6%9C%AC%E7%89%B9%E5%BE%81%E7%9A%84%E7%9B%B4%E6%8E%A5%E5%88%A0%E9%99%A4%E6%B3%95-xA"><span class="nav-text">æ–¹æ³•å››ï¼šåŸºäºæ–‡æœ¬ç‰¹å¾çš„ç›´æ¥åˆ é™¤æ³•
</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%94%EF%BC%9A%E5%9F%BA%E4%BA%8E%E6%B7%B7%E5%90%88%E7%89%B9%E5%BE%81%E7%9A%84%E9%AB%98%E7%BA%A7%E8%AF%86%E5%88%AB%E6%B3%95-xA"><span class="nav-text">æ–¹æ³•äº”ï¼šåŸºäºæ··åˆç‰¹å¾çš„é«˜çº§è¯†åˆ«æ³•
</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E5%85%AD%EF%BC%9A%E5%9F%BA%E4%BA%8E-PDF-%E5%BA%95%E5%B1%82%E7%BB%93%E6%9E%84%E7%9A%84%E7%BB%88%E6%9E%81%E6%96%B9%E6%A1%88-xA"><span class="nav-text">æ–¹æ³•å…­ï¼šåŸºäº PDF åº•å±‚ç»“æ„çš„ç»ˆææ–¹æ¡ˆ
</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
            <div class="customize-info my-1">äººç”Ÿæœ‰æ¢¦ï¼Œå„è‡ªç²¾å½©ï¼ŒåŠ æ²¹ï¼</div>
        
        <div class="text-center">
            &copy;
            
              <span>2025</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">BinkaiXu</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        å…±æ’°å†™äº† 8 ç¯‡æ–‡ç« 
                    </span>
                    
                        <span>
                            å…± 23.9k å­—
                        </span>
                    
                </p>
            
        </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">ç”± <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="åœ–å±¤_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> é©±åŠ¨</span>
            <span class="text-sm lg:block">ä¸»é¢˜&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
            <div>
                åšå®¢å·²è¿è¡Œ <span class="odometer" id="runtime_days" ></span> å¤© <span class="odometer" id="runtime_hours"></span> å°æ—¶ <span class="odometer" id="runtime_minutes"></span> åˆ†é’Ÿ <span class="odometer" id="runtime_seconds"></span> ç§’
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="fa-regular fa-arrow-up"></i>
		</li>
		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="ç«™å†…æœç´¢æ‚¨éœ€è¦çš„å†…å®¹..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>








    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
	<div id="aplayer"></div>

<script src="/js/build/libs/APlayer.min.js"></script>


<script src="/js/build/plugins/aplayer.js"></script>


	
</body>

</html>