[{"title":"Difyé•œåƒæºæ›¿æ¢ä¸æœåŠ¡å¯åŠ¨","url":"/2025/07/15/Dify-%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%EF%BC%9A%E9%95%9C%E5%83%8F%E6%BA%90%E6%9B%BF%E6%8D%A2%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8/","content":"ä¸€ã€Dify é•œåƒæºæ›¿æ¢æ“ä½œ\næ‰¹é‡æ›¿æ¢é•œåƒå‰ç¼€&#xA;åœ¨ docker-compose.yaml æ‰€åœ¨ç›®å½•æ‰§è¡Œå…¨å±€æ›¿æ¢ï¼Œæ·»åŠ  docker.1ms.run&#x2F; å‰ç¼€ï¼š\nsed -i &#x27;s/image: /image: docker.1ms.run\\\\//g&#x27; docker-compose.yaml\n\nç‰¹æ®Šé•œåƒè·¯å¾„ä¿®æ­£&#xA;é—®é¢˜è·¯å¾„&#xA;image: docker.1ms.run/docker.elastic.co/elasticsearch/elasticsearch:8.14.3\n\nä¿®æ­£å‘½ä»¤&#xA;sed -i &#x27;s|docker.1ms.run/docker.elastic.co/|docker.1ms.run/elastic/|g&#x27; docker-compose.yaml\n\næ­£ç¡®è·¯å¾„&#xA;image: docker.1ms.run/elastic/elasticsearch:8.14.3\n\nåŸºç¡€é•œåƒè¡¥å……æ›¿æ¢&#xA;sed -i &#x27;s|image: postgres:|image: docker.1ms.run/postgres:|g&#x27; docker-compose.yamlsed -i &#x27;s|image: redis:|image: docker.1ms.run/redis:|g&#x27; docker-compose.yamlsed -i &#x27;s|image: nginx:|image: docker.1ms.run/nginx:|g&#x27; docker-compose.yaml\n\näºŒã€éƒ¨ç½²å‰å‡†å¤‡å·¥ä½œ\nèµ‹äºˆæŒ‚è½½ç›®å½•æƒé™ï¼š\nchmod -R 777 ./volumes ./elasticsearch\n\nä¸‰ã€å¯åŠ¨ä¸éªŒè¯ Dify æœåŠ¡\nåå°å¯åŠ¨æœåŠ¡&#xA;docker-compose up -d\n\néªŒè¯æœåŠ¡çŠ¶æ€&#xA;docker-compose ps  # æ£€æŸ¥å®¹å™¨è¿è¡ŒçŠ¶æ€docker-compose logs -f  # æŸ¥çœ‹å®æ—¶æ—¥å¿—\n\nè®¿é—® Dify ç•Œé¢&#xA;æµè§ˆå™¨è¾“å…¥ http:&#x2F;&#x2F; æœåŠ¡å™¨ IP:3000ï¼Œé»˜è®¤è´¦å· admin@example.comï¼Œå¯†ç  passwordã€‚\nå››ã€éƒ¨ç½²è¿‡ç¨‹å¸¸è§é—®é¢˜\né•œåƒè·¯å¾„åµŒå¥—é”™è¯¯&#xA;é—®é¢˜&#xA;é•œåƒè·¯å¾„åŒ…å« docker.1ms.run&#x2F;docker.elastic.co&#x2F; åµŒå¥—ç»“æ„ã€‚\nè§£å†³&#xA;ä½¿ç”¨ sed ç²¾å‡†æ›¿æ¢ï¼š\nsed -i &#x27;s|docker.1ms.run/docker.elastic.co/|docker.1ms.run/elastic/|g&#x27; docker-compose.yaml\n\næƒé™ä¸è¶³å¯¼è‡´å¯åŠ¨å¤±è´¥&#xA;é—®é¢˜&#xA;æŒ‚è½½ç›®å½•æ— è¯»å†™æƒé™ã€‚\nè§£å†³&#xA;é€’å½’è®¾ç½®ç›®å½•æƒé™ï¼š\nchmod -R 777 ./volumes\næœåŠ¡å¯åŠ¨å¼‚å¸¸&#xA;è§£å†³&#xA;é€šè¿‡æ—¥å¿—æ’æŸ¥é—®é¢˜ï¼š&#x20;\ndocker-compose logs -f  # æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—docker-compose logs dify-api  # æŸ¥çœ‹æŒ‡å®šæœåŠ¡æ—¥å¿—\n\näº”ã€æ ¸å¿ƒæ“ä½œæ€»ç»“\né•œåƒæ›¿æ¢æµç¨‹&#xA;å…¨å±€å‰ç¼€æ›¿æ¢ â†’ ç‰¹æ®Šé•œåƒè·¯å¾„ä¿®æ­£ â†’ åŸºç¡€é•œåƒè¡¥å……æ›¿æ¢\nå¯åŠ¨éªŒè¯æµç¨‹&#xA;docker-compose up -d â†’ docker-compose ps â†’ è®¿é—® Web ç•Œé¢\nå…³é”®å‘½ä»¤&#xA;sed -i &#x27;s/image: /image: docker.1ms.run\\\\//g&#x27; docker-compose.yamlchmod -R 777 ./volumesdocker-compose up -d\n\nPS:ä»£ç ä»…ä¾›å‚è€ƒï¼Œå†…å®¹ä¸ä¸€å®šæ­£ç¡®ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µå¤„ç†å–µ\n","categories":["Dify"],"tags":["Dify","é•œåƒæº"]},{"title":"Portainerå®¹å™¨ç®¡ç†å®æˆ˜ï¼šä»é•œåƒåŠ é€Ÿåˆ°å®‰å…¨éƒ¨ç½²","url":"/2025/07/15/Portainer%E5%AE%B9%E5%99%A8%E7%AE%A1%E7%90%86%E5%AE%9E%E6%88%98%EF%BC%9A%E4%BB%8E%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E5%88%B0%E5%AE%89%E5%85%A8%E9%83%A8%E7%BD%B2/","content":"ä¸€ã€èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆé€‰æ‹©ä»ç¬¬ä¸‰æ–¹é•œåƒæºæ‹‰å– Portainerï¼Ÿ\nè¿‘æœŸåœ¨å­¦ä¹ å®¹å™¨ç®¡ç†å·¥å…· Portainer æ—¶ï¼Œå‚è€ƒäº†ä¸€ç¯‡æŠ€æœ¯æ•™ç¨‹ï¼ˆçŸ¥ä¹é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com&#x2F;p&#x2F;27740131259ï¼‰ï¼Œæ•™ç¨‹ä¸­æ¨èä½¿ç”¨å®˜æ–¹é•œåƒæºéƒ¨ç½²ã€‚ä½†ç”±äºç½‘ç»œç¯å¢ƒé™åˆ¶ï¼Œå°è¯•ä»ç¬¬ä¸‰æ–¹é•œåƒæºdocker.1ms.runæ‹‰å– Portainer é•œåƒï¼Œæ„å¤–å‘ç°è¯¥é•œåƒæºæä¾›äº†æ›´ç¨³å®šçš„ä¸‹è½½é€Ÿåº¦ï¼Œå› æ­¤è®°å½•ä¸‹å®Œæ•´æ“ä½œæµç¨‹ï¼Œä¾›é‡åˆ°ç±»ä¼¼é—®é¢˜çš„å¼€å‘è€…å‚è€ƒã€‚\näºŒã€æ“ä½œæ­¥éª¤ï¼šä»é•œåƒæ‹‰å–åˆ°å®¹å™¨å¯åŠ¨çš„å…¨æµç¨‹\n1. æ‹‰å– Portainer é•œåƒ&#xA;é€šå¸¸æƒ…å†µä¸‹ï¼ŒPortainer å®˜æ–¹é•œåƒçš„æ‹‰å–å‘½ä»¤ä¸ºï¼š\ndocker pull portainer/portainer-ce:latest\n\nä½†æœ¬æ¬¡å°è¯•ä½¿ç”¨ç¬¬ä¸‰æ–¹é•œåƒæºï¼š\ndocker pull docker.1ms.run/portainer/portainer-ce:latest\n\n\næ³¨æ„äº‹é¡¹ï¼š\n\nç¬¬ä¸‰æ–¹é•œåƒæºå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨å®˜æ–¹é•œåƒï¼ˆportainer/portainer-ceï¼‰ã€‚\nè‹¥æ‹‰å–å¤±è´¥ï¼Œå¯æ£€æŸ¥é•œåƒæºæ˜¯å¦å¯ç”¨ï¼ˆå¦‚æ‰§è¡Œping docker.1ms.runï¼‰ï¼Œæˆ–åˆ‡æ¢è‡³å›½å†…åŠ é€Ÿæºï¼ˆå¦‚ Docker ä¸­å›½é•œåƒç«™ï¼‰ã€‚\n\n2. éªŒè¯é•œåƒæ˜¯å¦æˆåŠŸæ‹‰å–&#xA;é€šè¿‡docker imageså‘½ä»¤æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨ï¼š\ndocker images\n3. å¯åŠ¨ Portainer å®¹å™¨&#xA;ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨å®¹å™¨ï¼Œå¹¶é…ç½®æŒ‚è½½ä¸ç«¯å£æ˜ å°„ï¼š\ndocker run -d \\  --name portainer \\  -p 9000:9000 \\  -v /var/run/docker.sock:/var/run/docker.sock \\  -v portainer_data:/data \\  --restart=always \\  docker.1ms.run/portainer/portainer-ce:latest\nå‚æ•°è§£æï¼š\n\n-dï¼šåå°è¿è¡Œå®¹å™¨ï¼›\n\n-p 9000:9000ï¼šæ˜ å°„å®¿ä¸»æœº 9000 ç«¯å£åˆ°å®¹å™¨ 9000 ç«¯å£ï¼Œç”¨äºè®¿é—® Web ç•Œé¢ï¼›\n\n-v /var/run/docker.sock:/var/run/docker.sockï¼šæŒ‚è½½ Docker å¥—æ¥å­—ï¼Œå…è®¸ Portainer ç®¡ç†å®¿ä¸»æœº Docker ç¯å¢ƒï¼›\n\n-v portainer_data:/dataï¼šåˆ›å»ºæ•°æ®å·æŒä¹…åŒ–å­˜å‚¨ Portainer é…ç½®ï¼›\n\n--restart=alwaysï¼šç¡®ä¿å®¹å™¨éšç³»ç»Ÿé‡å¯è‡ªåŠ¨è¿è¡Œã€‚\n\n\n4. è®¿é—® Portainer Web ç•Œé¢&#xA;å®¹å™¨å¯åŠ¨åï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥http://å®¿ä¸»æœºIP:9000ï¼Œé¦–æ¬¡è®¿é—®éœ€è®¾ç½®ç®¡ç†å‘˜å¯†ç ï¼Œéšåè¿›å…¥ Portainer ç®¡ç†ç•Œé¢ã€‚\nä¸‰ã€é‡åˆ°çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ\n1. é•œåƒæ‹‰å–å¤±è´¥ï¼šmanifest unknown&#xA;é”™è¯¯ä¿¡æ¯ï¼š\nError response from daemon: manifest for docker.1ms.run/portainer-ce:latest not found: manifest unknown\n\nåŸå› ï¼š\né•œåƒæºä¸­æ— è¯¥é•œåƒï¼Œæˆ–é•œåƒåç§°æ‹¼å†™é”™è¯¯ï¼ˆå¦‚portainer-ceå†™æˆportainerï¼‰ã€‚\nè§£å†³æ–¹æ³•ï¼š\nç¡®è®¤é•œåƒåç§°æ­£ç¡®æ€§ï¼Œæˆ–æ›´æ¢ä¸ºå®˜æ–¹é•œåƒæºæ‹‰å–ï¼š\ndocker pull portainer/portainer-ce:latest\n\n2. Docker Hub è¿æ¥è¶…æ—¶&#xA;é”™è¯¯ä¿¡æ¯ï¼š\nError response from daemon: Get &quot;https://registry-1.docker.io/v2/&quot;: context deadline exceeded\n\nè§£å†³æ–¹æ³•ï¼š\né…ç½®å›½å†…é•œåƒåŠ é€Ÿæºï¼Œç¼–è¾‘/etc/docker/daemon.jsonæ·»åŠ ï¼š\n&#123;  &quot;registry-mirrors&quot;: [&quot;https://registry.docker-cn.com&quot;, &quot;https://docker.mirrors.ustc.edu.cn&quot;]&#125;\n\né‡å¯ Docker æœåŠ¡ï¼šsudo systemctl restart dockerã€‚\nå››ã€ä½¿ç”¨ç¬¬ä¸‰æ–¹é•œåƒæºçš„é£é™©ä¸å»ºè®®\n\nå®‰å…¨é£é™©ï¼šç¬¬ä¸‰æ–¹é•œåƒæºå¯èƒ½è¢«ç¯¡æ”¹ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨å®˜æ–¹é•œåƒï¼ˆportainer/portainer-ceï¼‰ã€‚\n\nç‰ˆæœ¬å…¼å®¹æ€§ï¼šç¬¬ä¸‰æ–¹é•œåƒå¯èƒ½éæœ€æ–°ç‰ˆæœ¬ï¼Œå»ºè®®å®šæœŸé€šè¿‡docker pullæ›´æ–°é•œåƒã€‚\n\nç½‘ç»œç¨³å®šæ€§ï¼šè‹¥ç¬¬ä¸‰æ–¹æºé¢‘ç¹å¤±æ•ˆï¼Œä¼˜å…ˆä½¿ç”¨å®˜æ–¹æºæˆ–å›½å†…å¤§å‚åŠ é€Ÿæºï¼ˆå¦‚é˜¿é‡Œäº‘ã€è…¾è®¯äº‘é•œåƒç«™ï¼‰ã€‚\n\n\näº”ã€æ€»ç»“ï¼šPortainer çš„ä»·å€¼ä¸å®¹å™¨ç®¡ç†å®è·µ\né€šè¿‡ Docker éƒ¨ç½² Portainer åï¼Œå¯ç›´è§‚ç®¡ç†å®¹å™¨ã€é•œåƒã€ç½‘ç»œåŠæ•°æ®å·ï¼Œå°¤å…¶é€‚åˆæ–°æ‰‹å¿«é€Ÿä¸Šæ‰‹å®¹å™¨åŒ–éƒ¨ç½²ã€‚æœ¬æ¬¡ä»ç¬¬ä¸‰æ–¹é•œåƒæºæ‹‰å–çš„ç»å†è¡¨æ˜ï¼šæŠ€æœ¯å®è·µä¸­éœ€åœ¨æ•ˆç‡ä¸å®‰å…¨æ€§é—´æƒè¡¡ï¼Œå»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒå°è¯•éå®˜æ–¹æºï¼Œç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä½¿ç”¨å®˜æ–¹å¯ä¿¡é•œåƒã€‚\nåç»­å¯è¿›ä¸€æ­¥æ¢ç´¢ Portainer çš„ Kubernetes ç®¡ç†ã€RBAC æƒé™æ§åˆ¶ç­‰é«˜çº§åŠŸèƒ½ï¼Œæå‡å®¹å™¨åŒ–åº”ç”¨çš„éƒ¨ç½²ä¸è¿ç»´æ•ˆç‡ã€‚\nPS:ä»£ç ä»…ä¾›å‚è€ƒï¼Œå†…å®¹ä¸ä¸€å®šæ­£ç¡®ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µå¤„ç†å–µ\n","categories":["Dockerå®è·µ"],"tags":["Docker","Portainer","é•œåƒåŠ é€Ÿ","å®¹å™¨ç®¡ç†"]},{"title":"Python é­”æ³•ï¼šä¸€é”®è®© Excel æ­£ç¡®é€‰é¡¹ã€Œè„¸çº¢ã€","url":"/2025/07/15/Python-%E9%AD%94%E6%B3%95%EF%BC%9A%E4%B8%80%E9%94%AE%E8%AE%A9-Excel-%E6%AD%A3%E7%A1%AE%E9%80%89%E9%A1%B9%E3%80%8C%E8%84%B8%E7%BA%A2%E3%80%8D/","content":"åœ¨æ•°æ®å¤„ç†å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç† Excel æ–‡ä»¶ä¸­çš„è¯•é¢˜æ•°æ®ï¼Œç‰¹åˆ«æ˜¯éœ€è¦å¯¹æ­£ç¡®ç­”æ¡ˆè¿›è¡Œç‰¹æ®Šæ ‡è®°ã€‚æœ¬æ–‡å°†åˆ†äº«æˆ‘ä»æœ€åˆå®ç°åˆ°æœ€ç»ˆä¼˜åŒ–çš„å®Œæ•´æ”¹è¿›è¿‡ç¨‹ã€‚\nåˆå§‹éœ€æ±‚\næˆ‘ä»¬éœ€è¦å¤„ç†ä¸€ä¸ªåŒ…å«è¯•é¢˜çš„ Excel æ–‡ä»¶ï¼Œå…·ä½“è¦æ±‚ï¼š\n\næ–‡ä»¶åŒ…å« â€œè¯•é¢˜é€‰é¡¹â€ å’Œ â€œè¯•é¢˜ç­”æ¡ˆâ€ ä¸¤åˆ—\n\nè¯•é¢˜é€‰é¡¹ç”¨ â€œ$;$â€ åˆ†éš”å¤šä¸ªé€‰é¡¹\n\néœ€è¦æ ¹æ® â€œè¯•é¢˜ç­”æ¡ˆâ€ å°†æ­£ç¡®ç­”æ¡ˆæ ‡è®°ä¸ºçº¢è‰²\n\nå¤„ç†åçš„ç»“æœç›´æ¥ä¿®æ”¹åŸæ–‡ä»¶\n\n\nç¬¬ä¸€ç‰ˆå®ç°\næ ¸å¿ƒæ€è·¯ï¼š&#xA;\nä½¿ç”¨ pandas è¯»å– Excel æ–‡ä»¶\n\nç”¨ openpyxl ä¿®æ”¹åŸæ–‡ä»¶æ ·å¼\n\nåœ¨æ­£ç¡®ç­”æ¡ˆå‰åæ·»åŠ  â€œ**â€ æ ‡è®°\n\næç¤ºç”¨æˆ·æ‰‹åŠ¨æ›¿æ¢ â€œ**â€ ä¸ºçº¢è‰²æ ¼å¼\n\n\n# ä¸»è¦å¤„ç†é€»è¾‘marked_options = []for i, option in enumerate(options):    if i in correct_indices:        marked_options.append(f&quot;**&#123;option&#125;**&quot;)  # ç”¨**æ ‡è®°æ­£ç¡®ç­”æ¡ˆ    else:        marked_options.append(option)cell.value = &#x27;$;$&#x27;.join(marked_options)\n\né—®é¢˜ï¼š\nä¸èƒ½è‡ªåŠ¨è®¾ç½®çº¢è‰²ï¼Œéœ€è¦ç”¨æˆ·æ‰‹åŠ¨æ›¿æ¢ï¼Œ** çš„æ ‡è®°æ–¹å¼ä¸å¤Ÿç›´è§‚\nç¬¬äºŒç‰ˆæ”¹è¿›\næ”¹è¿›ç‚¹ï¼š&#xA;\næ”¹ç”¨ xlsxwriter å¼•æ“\n\nç›´æ¥å¤„ç† ** æ ‡è®°çš„å†…å®¹å¹¶è®¾ç½®ä¸ºçº¢è‰²\n\nä¿ç•™ ** æ ‡è®°\n\n\n# ä½¿ç”¨æ­£åˆ™åŒ¹é…**å†…å®¹å¹¶è®¾ç½®æ ¼å¼for match in re.finditer(r&#x27;\\*\\*(.*?)\\*\\*&#x27;, cell_value):    parts.append(&#123;        &#x27;text&#x27;: f&quot;**&#123;match.group(1)&#125;**&quot;,        &#x27;format&#x27;: red_format    &#125;)\né—®é¢˜ï¼š\nä½¿ç”¨ ** å°†æ­£ç¡®ç­”æ¡ˆæ‹¬èµ·æ¥çš„è¯ï¼Œxlsxwriter æ— æ³•éå¸¸å‡†ç¡®åœ°è§£æå‡ºæ¥ï¼Œå› ä¸ºç­”æ¡ˆå¯èƒ½æ˜¯ A$;$B$;$C$;$D è¿™æ ·å­çš„ï¼Œç›¸åŒçš„ç¬¦å·ä¼šå¹²æ‰°å®ƒçš„åˆ¤æ–­ï¼Œä»è€Œå¯¼è‡´æ•ˆæœä¸å¥½\næœ€ç»ˆç‰ˆæ”¹è¿›\næ”¹è¿›æ€è·¯ï¼š&#xA;\næ”¹å›ä½¿ç”¨ openpyxl\n\næ­£ç¡®ç­”æ¡ˆç”¨ [] æ ‡è®°\n\néæ­£ç¡®ç­”æ¡ˆä¸åšæ ‡è®°\n\n\nmarked_options = []for i, option in enumerate(options):    if i in correct_indices:        marked_options.append(f&quot;[&#123;option&#125;]&quot;)  # æ­£ç¡®ç­”æ¡ˆæ ‡è®°    else:        marked_options.append(option)\n\nç„¶åå†è¿›è¡Œæ ‡çº¢å¤„ç†ï¼š\n\nä½¿ç”¨å¯Œæ–‡æœ¬ (CellRichText) ç›´æ¥è®¾ç½®çº¢è‰²\n\nè‡ªåŠ¨ç§»é™¤ [] æ ‡è®°\n\næ·»åŠ å¼‚å¸¸å¤„ç†ï¼Œå¤±è´¥æ—¶å›é€€åˆ°æ™®é€šæ–‡æœ¬\n\næ›´å‹å¥½çš„æç¤ºä¿¡æ¯\n\n\nrich_text = CellRichText()for i, option in enumerate(options):    if i &gt; 0:        rich_text.append(&#x27;$;$&#x27;)    clean_option = option.replace(&#x27;[&#x27;, &#x27;&#x27;).replace(&#x27;]&#x27;, &#x27;&#x27;)    if i in correct_indices:        rich_text.append(TextBlock(inline_red_font, clean_option))    else:        rich_text.append(clean_option)cell.value = rich_text\n\nå…³é”®æ”¹è¿›ç‚¹ï¼š&#xA;\nå¯Œæ–‡æœ¬æ”¯æŒï¼šä½¿ç”¨ CellRichText å’Œ TextBlock å®ç°å¯¹å•ä¸ªå­—ç¬¦çš„æ ·å¼è®¾ç½®\n\nè‡ªåŠ¨æ¸…ç†ï¼šç§»é™¤é€‰é¡¹ä¸­çš„ [] æ ‡è®°\n\n\næ‹“å±•åŠŸèƒ½ï¼šæ ‡è®°æ£€æŸ¥ä¸ç»Ÿä¸€åˆ†éš”ç¬¦\nåœ¨æœ€ç»ˆç‰ˆçš„åŸºç¡€ä¸Šï¼Œæˆ‘è¿›ä¸€æ­¥å®Œå–„äº†ä»£ç ï¼Œå¢åŠ äº†ä¸¤é¡¹é‡è¦çš„åŠŸèƒ½ï¼šç»Ÿä¸€å¤„ç†éæ ‡å‡†åˆ†éš”ç¬¦å’Œå…¨é¢çš„æ ‡è®°æ£€æŸ¥æŠ¥å‘Šã€‚è¿™ä½¿å¾—æ•´ä¸ªæµç¨‹æ›´åŠ å¥å£®å’Œæ™ºèƒ½åŒ–ã€‚\n1. ç»Ÿä¸€åˆ†éš”ç¬¦&#xA;å¾ˆå¤šæ—¶å€™ï¼ŒExcel ä¸­çš„é€‰é¡¹åˆ†éš”ç¬¦å¯èƒ½ä¸ç»Ÿä¸€ï¼Œé™¤äº†æ ‡å‡†çš„$;$ï¼Œè¿˜å¯èƒ½å‡ºç°$;ã€$$ç­‰ï¼Œç”šè‡³å•ç©ºæ ¼åŠ  $ ç­‰å¤šç§å½¢å¼ã€‚ä¸ºäº†ç¡®ä¿é€‰é¡¹èƒ½å¤Ÿè¢«æ­£ç¡®è§£æï¼Œæˆ‘åŠ å…¥äº†å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼æ¥è¯†åˆ«å¹¶ç»Ÿä¸€è¿™äº›éæ ‡å‡†åˆ†éš”ç¬¦ä¸º $;$ã€‚\nå®ç°æ–¹å¼ï¼šä½¿ç”¨ re.compile å®šä¹‰äº†ä¸€ä¸ªè¯¦ç»†çš„æ­£åˆ™è¡¨è¾¾å¼ separator_patternï¼Œæ¶µç›–äº†å¤šç§å¸¸è§çš„éæ ‡å‡†åˆ†éš”ç¬¦ã€‚\næ•ˆæœï¼šåœ¨å¤„ç†æ¯ä¸ªé€‰é¡¹å­—ç¬¦ä¸²æ—¶ï¼Œé¦–å…ˆä½¿ç”¨ separator_pattern.sub (â€˜$;$â€™, options_str) å°†æ‰€æœ‰è¯†åˆ«åˆ°çš„éæ ‡å‡†åˆ†éš”ç¬¦ç»Ÿä¸€æ›¿æ¢ä¸º $;$ ã€‚è¿™å¤§å¤§æé«˜äº†æ•°æ®å¤„ç†çš„é²æ£’æ€§ï¼Œå‡å°‘äº†å› æ ¼å¼ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜ã€‚\n# æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰separator_pattern = re.compile(r&#x27;&#x27;&#x27;    \\$;\\$|       # æ ‡å‡† $;$    \\$[:ï¼š]\\$|   # $:$ æˆ– $ï¼š$    ;\\$|         # ;$    \\$ï¼›|        # $ï¼›    [ï¼›:ï¼š]\\$|   # ï¼›$ æˆ– ï¼š$    \\$[;ï¼›:ï¼š]|  # $; æˆ– $ï¼›æˆ– $: æˆ– $ï¼š    \\$\\$|        # $$    \\s&#123;2,&#125;|      # ä¸¤ä¸ªæˆ–æ›´å¤šç©ºæ ¼    \\$\\s|\\s\\$|   # $ åæˆ–å‰æœ‰å•ä¸ªç©ºæ ¼    ;           # å•ç‹¬çš„åˆ†å·&#x27;&#x27;&#x27;, re.VERBOSE)# æ›¿æ¢å¤„ç†modified_str = separator_pattern.sub(&#x27;$;$&#x27;, options_str)\n\n2. æ ‡è®°æ£€æŸ¥æŠ¥å‘Š&#xA;ä»…ä»…å¯¹æ­£ç¡®ç­”æ¡ˆè¿›è¡Œæ ‡è®°æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦éªŒè¯æ ‡è®°æ˜¯å¦æ­£ç¡®ã€æ˜¯å¦æœ‰é—æ¼ã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”Ÿæˆè¯¦ç»†çš„æŠ¥å‘Šï¼ŒæŒ‡å‡º â€œæ­£ç¡®ç­”æ¡ˆæœªè¢«æ ‡è®°â€ å’Œ â€œé”™è¯¯ç­”æ¡ˆè¢«æ ‡è®°â€ çš„æƒ…å†µã€‚\næ ¸å¿ƒé€»è¾‘ä¼˜åŒ–ï¼š&#xA;\næœªæ ‡è®°æ£€æŸ¥ï¼šä¼ ç»Ÿçš„æ£€æŸ¥æ–¹æ³•æ˜¯çœ‹ â€œæ ‡è®°ç´¢å¼•â€ ä¸­æ˜¯å¦åŒ…å«æ­£ç¡®ç­”æ¡ˆçš„ç´¢å¼•ã€‚ä½†å¦‚æœæ­£ç¡®ç­”æ¡ˆå®Œå…¨æ²¡æœ‰è¢«æ ‡è®°ï¼ˆå³é€‰é¡¹ä¸­æ ¹æœ¬æ²¡æœ‰ []ï¼‰ï¼Œè¿™ç§æ–¹æ³•å°±æ— æ³•è¯†åˆ«ã€‚æ–°çš„é€»è¾‘ç›´æ¥æ£€æŸ¥æ­£ç¡®ç­”æ¡ˆçš„é€‰é¡¹å†…å®¹æ˜¯å¦è¢« [] åŒ…è£¹ ã€‚åªè¦æ­£ç¡®ç­”æ¡ˆæœªè¢« [] åŒ…è£¹ï¼Œæ— è®ºæ˜¯å¦æœ‰å…¶ä»–æ ‡è®°åŠ¨ä½œï¼Œéƒ½ä¼šè¢«è¯†åˆ«ä¸º â€œæœªæ ‡è®°â€ ã€‚\n\né”™è¯¯æ ‡è®°æ£€æŸ¥ï¼šæ£€æŸ¥æ‰€æœ‰è¢« [] åŒ…è£¹çš„é€‰é¡¹ï¼Œå¦‚æœå…¶ç´¢å¼•ä¸åœ¨æ­£ç¡®ç­”æ¡ˆçš„ç´¢å¼•åˆ—è¡¨ä¸­ï¼Œåˆ™è§†ä¸ºé”™è¯¯æ ‡è®° ã€‚\n\n\nè¾“å‡ºæŠ¥å‘Šï¼š&#xA;ç”Ÿæˆæ¸…æ™°çš„æŠ¥å‘Šï¼ŒåŒ…å«ï¼š\n\næ£€æŸ¥çš„æ€»è¡Œæ•° ã€‚\n\nâ€œæœªæ ‡è®°æ­£ç¡®ç­”æ¡ˆçš„è¡Œâ€ æ•°é‡åŠå…·ä½“è¯¦æƒ…ï¼ˆExcel è¡Œå·ã€åº”æ ‡è®°çš„å­—æ¯ã€æœªè¢«åŒ…è£¹çš„å®é™…å†…å®¹ï¼‰ ã€‚\n\nâ€œé”™è¯¯æ ‡è®°çš„è¡Œâ€ æ•°é‡åŠå…·ä½“è¯¦æƒ…ï¼ˆExcel è¡Œå·ã€é”™è¯¯æ ‡è®°çš„å†…å®¹ã€æ­£ç¡®çš„ç­”æ¡ˆï¼‰ ã€‚\n\n\n#æœªæ ‡è®°æ£€æŸ¥ä»£ç ï¼šhas_unmarked = Falsefor i in correct_indices:    opt = options[i]    if not (opt.strip().startswith(&#x27;[&#x27;) and opt.strip().endswith(&#x27;]&#x27;)):        has_unmarked = True        breakif has_unmarked:    unmarked_rows.append(&#123;        &#x27;row&#x27;: row_num,        &#x27;expected&#x27;: [chr(65 + i) for i in correct_indices],        &#x27;actual&#x27;: [options[i].strip() for i in correct_indices]    &#125;)#é”™è¯¯æ ‡è®°æ£€æŸ¥ä»£ç ï¼šmarked_indices = []for i, opt in enumerate(options):    if opt.strip().startswith(&#x27;[&#x27;) and opt.strip().endswith(&#x27;]&#x27;):        marked_indices.append(i)for i in marked_indices:    if i not in correct_indices:        wrong_marking.append(&#123;            &#x27;row&#x27;: row_num,            &#x27;wrong_marked&#x27;: options[i].strip(),            &#x27;correct&#x27;: [chr(65 + i) for i in correct_indices]        &#125;)        break\n\néªŒè¯ç¤ºä¾‹ï¼š&#xA;å¦‚æœä¸€ä¸ª Excel è¡Œçš„æ­£ç¡®ç­”æ¡ˆæ˜¯ Dï¼Œä½†é€‰é¡¹ D æ²¡æœ‰è¢« [] åŒ…è£¹ï¼Œè¿è¡Œä»£ç åä¼šè¾“å‡ºï¼š\n=== æ ‡è®°æ£€æŸ¥æŠ¥å‘Š ===å…±æ£€æŸ¥ 1000 è¡Œæ•°æ®1. æœªæ ‡è®°æ­£ç¡®ç­”æ¡ˆçš„è¡Œ: 1 è¡Œ    è¡ŒX: åº”æ ‡è®°[&#x27;D&#x27;]ï¼ˆå†…å®¹ï¼šDã€xxxxxxxxï¼‰æœªè¢«[]åŒ…è£¹2. é”™è¯¯æ ‡è®°çš„è¡Œ: 0 è¡Œ\n\nè¿™ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿç²¾å‡†è¯†åˆ« â€œåº”è¯¥æ ‡è®°ä½†å®Œå…¨æ²¡æ ‡è®°â€ çš„æƒ…å†µ ã€‚\nPS:ä»£ç ä»…ä¾›å‚è€ƒï¼Œå†…å®¹ä¸ä¸€å®šæ­£ç¡®ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µå¤„ç†å–µ\n","categories":["Excel","Python","æ•°æ®å¤„ç†"],"tags":["Excel","Pandas","Python","Openpyxl","Xlsxwriter","æ­£åˆ™è¡¨è¾¾å¼"]},{"title":"Python é­”æ³•ï¼šä¸€é”®è®© Excel æ­£ç¡®é€‰é¡¹ã€Œè„¸çº¢ã€","url":"/2025/07/15/Python%E9%AD%94%E6%B3%95%EF%BC%9A%E5%A6%82%E4%BD%95%E7%94%A8%E7%89%B9%E5%BE%81%E8%AF%86%E5%88%AB%E8%AE%A9PDF%E6%B0%B4%E5%8D%B0%E9%9A%90%E5%BD%A2%EF%BC%9F/","content":"åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å¸¦æœ‰ç‰¹å®šç‰¹å¾çš„ PDF æ°´å°ï¼Œæ¯”å¦‚å›ºå®šçš„å­—ä½“å¤§å°ã€å€¾æ–œè§’åº¦ã€é€æ˜åº¦å’Œé¢œè‰²ã€‚è¿™äº›ç‰¹æ€§ä¸ºæˆ‘ä»¬æä¾›äº†æ›´ç²¾å‡†åœ°è¯†åˆ«æ°´å°çš„ä¾æ®ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥æ·±å…¥æ¢è®¨å¦‚ä½•åˆ©ç”¨ PyMuPDF (Fitz) åº“ï¼ŒåŸºäºè¿™äº›ç‰¹å¾å®ç° PDF æ°´å°çš„ç²¾ç¡®è¯†åˆ«å’Œå»é™¤ï¼Œå¹¶æ•´åˆå¤šç§å®ç”¨æ–¹æ³•ï¼Œå¸®ä½ åº”å¯¹ä¸åŒåœºæ™¯ã€‚\nç‰¹å®šç‰¹å¾æ°´å°çš„è¯†åˆ«åŸç†\nPDF æ–‡ä»¶ä¸­çš„æ–‡æœ¬å’Œå›¾å½¢å¯¹è±¡éƒ½åŒ…å«äº†ä¸°å¯Œçš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œä¾‹å¦‚å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦ã€é€æ˜åº¦å’Œé¢œè‰²ã€‚å½“æ°´å°å…·æœ‰å›ºå®šç‰¹å¾æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ç²¾å‡†è¯†åˆ«ï¼š\n\nè§£æ PDF é¡µé¢å†…å®¹ï¼š è·å–é¡µé¢ä¸Šæ‰€æœ‰çš„æ–‡æœ¬å’Œå›¾å½¢å¯¹è±¡ã€‚\n\næå–å¯¹è±¡ç‰¹å¾ï¼š è·å–æ¯ä¸ªå¯¹è±¡çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦ã€é€æ˜åº¦å’Œé¢œè‰²ç­‰ä¿¡æ¯ã€‚\n\nç‰¹å¾åŒ¹é…ï¼š å°†æå–åˆ°çš„ç‰¹å¾ä¸æˆ‘ä»¬å·²çŸ¥çš„æ°´å°ç‰¹å¾è¿›è¡Œæ¯”å¯¹ã€‚\n\nå¤„ç†åŒ¹é…å¯¹è±¡ï¼š å¯¹ç¬¦åˆæ°´å°ç‰¹å¾çš„å¯¹è±¡è¿›è¡Œåˆ é™¤æˆ–è¦†ç›–å¤„ç†ã€‚\n\n\nå…¸å‹çš„ PDF æ°´å°é€šå¸¸å…·å¤‡ä»¥ä¸‹ç‰¹å¾ï¼š\n\nğŸ“ å›ºå®šå€¾æ–œè§’åº¦ (å¸¸è§ 15-45 åº¦)\n\nğŸ¨ å›ºå®šé¢œè‰² (å¸¸è§æµ…ç°è‰² #C0C0C0)\n\nğŸŒ« å›ºå®šé€æ˜åº¦ (çº¦ 30-50%)\n\nğŸ”  å›ºå®šå­—ä½“å¤§å° (é€šå¸¸è¾ƒå¤§)\n\nğŸ”„ é‡å¤å‡ºç°åœ¨æ¯ä¸€é¡µç›¸åŒä½ç½®\n\n\nä½¿ç”¨ PyMuPDF å®ç°åŸºäºç‰¹å¾çš„æ°´å°å¤„ç†\næ–¹æ³•ä¸€ï¼šåŸºäºå­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦çš„æ°´å°è¯†åˆ«&#xA;è¿™ä¸ªæ–¹æ³•éå¸¸é€‚åˆé‚£äº›å­—ä½“å¤§å°å’Œå€¾æ–œè§’åº¦éƒ½æ¯”è¾ƒå›ºå®šçš„æ°´å°ã€‚\nimport fitzimport mathdef remove_watermark_by_font_size_and_rotation(input_pdf, output_pdf, font_size, rotation_angle):    doc = fitz.open(input_pdf)    for page in doc:        text_infos = page.get_text(&quot;dict&quot;)        for block in text_infos[&quot;blocks&quot;]:            if &quot;lines&quot; in block:                for line in block[&quot;lines&quot;]:                    for span in line[&quot;spans&quot;]:                        current_size = span[&quot;size&quot;]                        matrix = fitz.Matrix(span[&quot;matrix&quot;])                        current_rotation = math.degrees(math.atan2(matrix.b, matrix.a))                        if (abs(current_size - font_size) &lt; 1.5 and                             abs(current_rotation - rotation_angle) &lt; 5.0):                            page.add_redact_annot(fitz.Rect(span[&quot;bbox&quot;]), text=&quot;&quot;)        page.apply_redactions()    doc.save(output_pdf)    doc.close()\n\nä»£ç è§£æï¼š\n\næˆ‘ä»¬ä½¿ç”¨ page.get_text(&quot;dict&quot;) è·å–é¡µé¢ä¸Šæ‰€æœ‰çš„æ–‡æœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„å„ç§å±æ€§ã€‚\n\nä»æ–‡æœ¬è·¨åº¦ (span) ä¸­æå– å­—ä½“å¤§å° å’Œ å˜æ¢çŸ©é˜µã€‚\n\né€šè¿‡åˆ†è§£å˜æ¢çŸ©é˜µæ¥è®¡ç®—æ–‡æœ¬çš„ æ—‹è½¬è§’åº¦ã€‚è¿™é‡Œä½¿ç”¨äº† math.atan2(matrix.b, matrix.a) æ¥æ›´å‡†ç¡®åœ°è·å–æ—‹è½¬è§’åº¦ã€‚\n\nå°†æå–åˆ°çš„ç‰¹å¾ä¸ä½ å·²çŸ¥çš„æ°´å°ç‰¹å¾è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœåŒ¹é…ï¼ˆå¹¶å…è®¸ä¸€å®šçš„è¯¯å·®èŒƒå›´ï¼‰ï¼Œå°±ç”¨ä¸€ä¸ªç©ºç™½çŸ©å½¢è¦†ç›–æ°´å°åŒºåŸŸã€‚\n\n\néš¾æ˜“åº¦ï¼šâ˜…â˜…â˜…â˜†â˜†\nä¼˜ç‚¹ï¼š å¯¹å…·æœ‰å›ºå®šå­—ä½“å¤§å°å’Œå€¾æ–œè§’åº¦çš„æ°´å°æ•ˆæœç‰¹åˆ«å¥½ï¼Œè¯¯åˆ¤ç‡ä½ã€‚\nç¼ºç‚¹ï¼š éœ€è¦ä½ é¢„å…ˆçŸ¥é“æ°´å°çš„å­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦å‚æ•°ã€‚\næ–¹æ³•äºŒï¼šåŸºäºé€æ˜åº¦å’Œé¢œè‰²çš„æ°´å°è¯†åˆ«&#xA;è¿™ç§æ–¹æ³•é€‚ç”¨äºé‚£äº›æœ‰å›ºå®šé€æ˜åº¦å’Œé¢œè‰²çš„æ°´å°ï¼Œç‰¹åˆ«æ˜¯åŠé€æ˜çš„æµ…è‰²æ°´å°ã€‚\nimport fitzdef remove_watermark_by_opacity_and_color(input_pdf, output_pdf, opacity_threshold, color_rgb_target, color_tolerance=10):    doc = fitz.open(input_pdf)    for page in doc:        text_infos = page.get_text(&quot;dict&quot;)        for block in text_infos[&quot;blocks&quot;]:            if &quot;lines&quot; in block:                for line in block[&quot;lines&quot;]:                    for span in line[&quot;spans&quot;]:                        color_int = span[&quot;color&quot;]                        r = (color_int &gt;&gt; 16) &amp; 0xFF                        g = (color_int &gt;&gt; 8) &amp; 0xFF                        b = color_int &amp; 0xFF                        current_color_rgb = (r, g, b)                        color_match = (                            abs(current_color_rgb[0] - color_rgb_target[0]) &lt;= color_tolerance and                            abs(current_color_rgb[1] - color_rgb_target[1]) &lt;= color_tolerance and                            abs(current_color_rgb[2] - color_rgb_target[2]) &lt;= color_tolerance                        )                        if color_match:                            page.add_redact_annot(fitz.Rect(span[&quot;bbox&quot;]), text=&quot;&quot;)        page.apply_redactions()    doc.save(output_pdf)    doc.close()\n\nä»£ç è§£æï¼š\n\næˆ‘ä»¬ä»æ–‡æœ¬è·¨åº¦ä¸­æå– RGB é¢œè‰²å€¼ã€‚\n\næ³¨æ„ï¼š ç›´æ¥ä» span ä¸­æå–é€æ˜åº¦ä¿¡æ¯åœ¨ PyMuPDF ä¸­æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºå®ƒé€šå¸¸æ˜¯ PDF å†…å®¹æµä¸­çš„å›¾å½¢çŠ¶æ€å‚æ•°ã€‚ä¸ºäº†å®ç°çœŸæ­£çš„é€æ˜åº¦è¯†åˆ«ï¼Œä½ å¯èƒ½éœ€è¦æ¸²æŸ“é¡µé¢ä¸ºå›¾åƒååˆ†æåƒç´ çš„ alpha é€šé“ï¼Œæˆ–è€…è¿›è¡Œæ›´å¤æ‚çš„ PDF å†…å®¹æµè§£æã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘æš‚æ—¶ç§»é™¤äº†é€æ˜åº¦çš„åˆ¤æ–­ï¼Œä¸»è¦ä¾èµ–é¢œè‰²åŒ¹é…ã€‚\n\næ¯”è¾ƒæå–çš„é¢œè‰²ä¸å·²çŸ¥æ°´å°ç‰¹å¾ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªå®¹å·®èŒƒå›´ã€‚\n\n\néš¾æ˜“åº¦ï¼šâ˜…â˜…â˜…â˜…â˜†\nä¼˜ç‚¹ï¼š å¯¹å…·æœ‰å›ºå®šé¢œè‰²ï¼ˆç‰¹åˆ«æ˜¯æµ…è‰²ï¼‰çš„æ°´å°æ•ˆæœå¥½ã€‚\nç¼ºç‚¹ï¼š é€æ˜åº¦æå–æ˜¯éš¾ç‚¹ï¼Œå¯èƒ½éœ€è¦æ·±å…¥è§£æ PDF å†…éƒ¨ç»“æ„æˆ–å€ŸåŠ©å›¾åƒå¤„ç†åº“ã€‚\næ–¹æ³•ä¸‰ï¼šç»¼åˆå¤šç‰¹å¾çš„æ°´å°è¯†åˆ«&#xA;å½“æ°´å°ç‰¹å¾æ˜ç¡®ä¸”å›ºå®šæ—¶ï¼Œè¿™ä¸ªæ–¹æ³•èƒ½æä¾›æœ€é«˜çš„è¯†åˆ«å‡†ç¡®æ€§ï¼Œå› ä¸ºå®ƒç»“åˆäº†å¤šç§ç‰¹å¾è¿›è¡Œåˆ¤æ–­ã€‚\nimport fitzimport mathdef remove_watermark_by_multiple_features(input_pdf, output_pdf,                                        font_size, rotation_angle,                                        color_rgb,                                        size_tolerance=1.5, rotation_tolerance=5.0, color_tolerance=10):    doc = fitz.open(input_pdf)    for page in doc:        text_infos = page.get_text(&quot;dict&quot;)        for block in text_infos[&quot;blocks&quot;]:            if &quot;lines&quot; in block:                for line in block[&quot;lines&quot;]:                    for span in line[&quot;spans&quot;]:                        current_size = span[&quot;size&quot;]                        matrix = fitz.Matrix(span[&quot;matrix&quot;])                        current_rotation = math.degrees(math.atan2(matrix.b, matrix.a))                        color_int = span[&quot;color&quot;]                        r = (color_int &gt;&gt; 16) &amp; 0xFF                        g = (color_int &gt;&gt; 8) &amp; 0xFF                        b = color_int &amp; 0xFF                        current_color_rgb = (r, g, b)                        size_match = abs(current_size - font_size) &lt; size_tolerance                        rotation_match = abs(current_rotation - rotation_angle) &lt; rotation_tolerance                        color_match = (                            abs(current_color_rgb[0] - color_rgb[0]) &lt;= color_tolerance and                            abs(current_color_rgb[1] - color_rgb[1]) &lt;= color_tolerance and                            abs(current_color_rgb[2] - color_rgb[2]) &lt;= color_tolerance                        )                        if size_match and rotation_match and color_match:                            page.add_redact_annot(fitz.Rect(span[&quot;bbox&quot;]), text=&quot;&quot;)        page.apply_redactions()    doc.save(output_pdf)    doc.close()\n\nä»£ç è§£æï¼š\n\nç»¼åˆæå–å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦å’Œé¢œè‰²ä¸‰ä¸ªç‰¹å¾ï¼ˆä¸ºäº†ç®€åŒ–å’Œå®ç”¨æ€§ï¼Œç§»é™¤äº†ç›´æ¥åœ¨ span ä¸­è·å–çš„é€æ˜åº¦åˆ¤æ–­ï¼‰ã€‚\n\nè®¾ç½®äº†åˆç†çš„åŒ¹é…å®¹å·®èŒƒå›´ï¼Œä½ å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´è¿™äº›å®¹å·®å€¼ã€‚\n\nåªæœ‰å½“æ‰€æœ‰é€‰å®šçš„ç‰¹å¾éƒ½åŒ¹é…æ—¶æ‰åˆ¤å®šä¸ºæ°´å°ï¼Œè¿™å¤§å¤§æé«˜äº†è¯†åˆ«çš„å‡†ç¡®æ€§ã€‚\n\n\néš¾æ˜“åº¦ï¼šâ˜…â˜…â˜…â˜…â˜…\nä¼˜ç‚¹ï¼š è¯†åˆ«å‡†ç¡®æ€§é«˜ï¼Œè¯¯åˆ¤ç‡æä½ã€‚\nç¼ºç‚¹ï¼š å®ç°ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ç²¾ç¡®çš„æ°´å°ç‰¹å¾å‚æ•°ã€‚\næ–¹æ³•å››ï¼šåŸºäºæ–‡æœ¬ç‰¹å¾çš„ç›´æ¥åˆ é™¤æ³•&#xA;å¦‚æœä½ çŸ¥é“æ°´å°çš„å…·ä½“æ–‡æœ¬å†…å®¹ï¼Œæˆ–è€…å¯ä»¥é€šè¿‡ä¸€äº›ç®€å•çš„æ–‡æœ¬å±æ€§æ¥è¯†åˆ«ï¼Œè¿™ä¸ªæ–¹æ³•æœ€ç›´æ¥ã€æœ€å¿«é€Ÿã€‚\nimport fitzdef is_watermark_span(span, target_text=None, min_size=None, max_size=None, target_color_rgb=None, color_tolerance=10):    size_match = True    if min_size is not None and span[&quot;size&quot;] &lt; min_size:        size_match = False    if max_size is not None and span[&quot;size&quot;] &gt; max_size:        size_match = False    text_match = True    if target_text is not None and target_text.lower() not in span[&quot;text&quot;].lower():        text_match = False    color_match = True    if target_color_rgb is not None:        color_int = span[&quot;color&quot;]        r = (color_int &gt;&gt; 16) &amp; 0xFF        g = (color_int &gt;&gt; 8) &amp; 0xFF        b = color_int &amp; 0xFF        current_color_rgb = (r, g, b)        if not (abs(current_color_rgb[0] - target_color_rgb[0]) &lt;= color_tolerance and                abs(current_color_rgb[1] - target_color_rgb[1]) &lt;= color_tolerance and                abs(current_color_rgb[2] - target_color_rgb[2]) &lt;= color_tolerance):            color_match = False    return size_match and text_match and color_matchdef remove_watermark_by_text_features(doc_path, output_path, **kwargs):    doc = fitz.open(doc_path)    for page in doc:        for block in page.get_text(&quot;dict&quot;)[&quot;blocks&quot;]:            if block[&quot;type&quot;] == 0:                for line in block[&quot;lines&quot;]:                    for span in line[&quot;spans&quot;]:                        if is_watermark_span(span, **kwargs):                            page.add_redact_annot(span[&quot;bbox&quot;])        page.apply_redactions()    doc.save(output_path)    doc.close()\n\nä»£ç è§£æï¼š\n\né€šè¿‡ä¸€ä¸ªå¯è‡ªå®šä¹‰çš„ is_watermark_span å‡½æ•°ç›´æ¥æœç´¢ç¬¦åˆç‰¹å®šæ–‡æœ¬ç‰¹å¾çš„æ°´å°å†…å®¹ã€‚\n\nä½ å¯ä»¥ä¼ å…¥ target_textã€min_sizeã€max_size å’Œ target_color_rgb ç­‰å‚æ•°æ¥ç²¾ç¡®å®šä¹‰æ°´å°çš„ç‰¹å¾ã€‚\n\nå¯¹åˆ¤å®šä¸ºæ°´å°çš„æ–‡æœ¬è¿›è¡Œè¦†ç›–å¤„ç†ã€‚\n\n\néš¾æ˜“åº¦ï¼šâ˜…â˜…â˜†â˜†â˜†\nä¼˜ç‚¹ï¼š å®ç°ç®€å•ï¼Œå¤„ç†é€Ÿåº¦å¿«ï¼Œéå¸¸é€‚åˆå¤„ç†ç®€å•çš„æ–‡æœ¬æ°´å°ã€‚\nç¼ºç‚¹ï¼š ä»…é€‚ç”¨äºæ–‡æœ¬æ°´å°ï¼Œæ— æ³•å¤„ç†å›¾åƒæ°´å°ã€‚\næ–¹æ³•äº”ï¼šåŸºäºæ··åˆç‰¹å¾çš„é«˜çº§è¯†åˆ«æ³•&#xA;å¯¹äºæ›´å¤æ‚çš„ PDF æ°´å°ï¼ˆä¾‹å¦‚åŒ…å«æ–‡æœ¬å’Œå›¾åƒï¼‰ï¼Œè¿™ç§æ–¹æ³•ç»“åˆäº†æ–‡æœ¬å’Œå›¾åƒç‰¹å¾è¯†åˆ«ï¼Œèƒ½å¤Ÿæä¾›æ›´é«˜çš„è¯†åˆ«ç²¾åº¦ã€‚è¯·æ³¨æ„ï¼Œå›¾åƒå¤„ç†éƒ¨åˆ†éœ€è¦ numpy å’Œ opencv-python åº“ã€‚\nimport fitzimport numpy as npimport cv2def advanced_watermark_removal(doc_path, output_path, watermark_template_path=None):    doc = fitz.open(doc_path)    if watermark_template_path:        watermark_template = cv2.imread(watermark_template_path, cv2.IMREAD_GRAYSCALE)        sift = cv2.SIFT_create()        kp1, des1 = sift.detectAndCompute(watermark_template, None)        for page in doc:        text_spans_to_redact = []        image_regions_to_redact = []        text_infos = page.get_text(&quot;dict&quot;)        for block in text_infos[&quot;blocks&quot;]:            if &quot;lines&quot; in block:                for line in block[&quot;lines&quot;]:                    for span in line[&quot;spans&quot;]:                        if (100 &lt;= span[&quot;color_rgb&quot;][0] &lt;= 220 and                             100 &lt;= span[&quot;color_rgb&quot;][1] &lt;= 220 and                             100 &lt;= span[&quot;color_rgb&quot;][2] &lt;= 220) and span[&quot;size&quot;] &gt; 15:                            text_spans_to_redact.append(span[&quot;bbox&quot;])                if watermark_template_path and des1 is not None:            pix = page.get_pixmap(matrix=fitz.Matrix(2,2))            img = cv2.cvtColor(np.frombuffer(pix.samples, np.uint8).reshape(                pix.h, pix.w, pix.n), cv2.COLOR_RGB2GRAY)            kp2, des2 = sift.detectAndCompute(img, None)            if des2 is not None and len(des1) &gt; 0 and len(des2) &gt; 0:                matcher = cv2.BFMatcher()                matches = matcher.knnMatch(des1, des2, k=2)                good_matches = [m for m, n in matches if m.distance &lt; 0.75 * n.distance]                if len(good_matches) &gt; 10:                    src_pts = np.float32([kp1[m.queryIdx].pt for m in good_matches]).reshape(-1, 1, 2)                    dst_pts = np.float32([kp2[m.trainIdx].pt for m in good_matches]).reshape(-1, 1, 2)                    M, mask = cv2.findHomography(src_pts, dst_pts, cv2.RANSAC, 5.0)                    if M is not None:                        h, w = watermark_template.shape                        pts = np.float32([[0, 0], [0, h-1], [w-1, h-1], [w-1, 0]]).reshape(-1, 1, 2)                        dst = cv2.perspectiveTransform(pts, M)                        min_x = int(np.min(dst[:, 0, 0]) / pix.matrix.a)                        min_y = int(np.min(dst[:, 0, 1]) / pix.matrix.d)                        max_x = int(np.max(dst[:, 0, 0]) / pix.matrix.a)                        max_y = int(np.max(dst[:, 0, 1]) / pix.matrix.d)                        image_regions_to_redact.append((min_x, min_y, max_x, max_y))                for span_bbox in text_spans_to_redact:            page.add_redact_annot(fitz.Rect(span_bbox))        for region_bbox in image_regions_to_redact:            page.add_redact_annot(fitz.Rect(region_bbox))        page.apply_redactions()    doc.save(output_path)    doc.close()\n\nä»£ç è§£æï¼š\n\næ–‡æœ¬ç‰¹å¾è¯†åˆ«ï¼š æ²¿ç”¨äº†ä¹‹å‰ is_watermark_text çš„æ¦‚å¿µï¼Œä½†ä½ éœ€è¦æ ¹æ®å®é™…æ°´å°ç‰¹æ€§æ¥å®Œå–„è¿™ä¸ªé€»è¾‘ã€‚\n\nå›¾åƒç‰¹å¾è¯†åˆ«ï¼š\n\nå°† PDF é¡µé¢æ¸²æŸ“ä¸ºå›¾åƒï¼Œå¹¶è½¬æ¢ä¸ºç°åº¦å›¾ï¼Œä»¥ä¾¿è¿›è¡Œç‰¹å¾æ£€æµ‹ã€‚\n\nä½¿ç”¨ SIFT ç®—æ³•ï¼ˆæˆ–å…¶ä»–ç‰¹å¾åŒ¹é…ç®—æ³•å¦‚ ORB, SURFï¼‰æ¥æ£€æµ‹å¹¶åŒ¹é…å›¾åƒæ°´å°æ¨¡æ¿ã€‚\n\né€šè¿‡ findHomography è®¡ç®—æ°´å°åœ¨é¡µé¢ä¸Šçš„å˜æ¢ï¼Œä»è€Œç¡®å®šæ°´å°çš„ç²¾ç¡®ä½ç½®å’Œè¾¹ç•Œæ¡†ã€‚\n\næ³¨æ„ï¼š å›¾åƒå¤„ç†åº“ (å¦‚ OpenCV) é€šå¸¸åœ¨åƒç´ åæ ‡ç³»ä¸‹æ“ä½œï¼Œä½ éœ€è¦å°†æ£€æµ‹åˆ°çš„åƒç´ åæ ‡è½¬æ¢å› PyMuPDF ä½¿ç”¨çš„ PDF åæ ‡ã€‚\n\nç»¼åˆå¤„ç†ï¼š å°†æ–‡æœ¬å’Œå›¾åƒè¯†åˆ«çš„ç»“æœç»“åˆèµ·æ¥ï¼Œå¯¹æ‰€æœ‰è¯†åˆ«å‡ºçš„æ°´å°åŒºåŸŸè¿›è¡Œå¤„ç†ã€‚\n\n\néš¾æ˜“åº¦ï¼šâ˜…â˜…â˜…â˜…â˜†\nä¼˜ç‚¹ï¼š è¯†åˆ«ç²¾åº¦é«˜ï¼Œé€‚ç”¨äºå¤æ‚æ°´å°ç¯å¢ƒï¼ˆæ–‡æœ¬ä¸å›¾åƒæ··åˆï¼‰ï¼Œé²æ£’æ€§å¼ºã€‚\nç¼ºç‚¹ï¼š å®ç°å¤æ‚ï¼Œéœ€è¦æ°´å°æ¨¡æ¿ï¼Œå¤„ç†é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œéœ€è¦é¢å¤–çš„å›¾åƒå¤„ç†åº“ã€‚\næ–¹æ³•å…­ï¼šåŸºäº PDF åº•å±‚ç»“æ„çš„ç»ˆææ–¹æ¡ˆ&#xA;è¿™ç§æ–¹æ³•æœ€ä¸ºå½»åº•ï¼Œå› ä¸ºå®ƒç›´æ¥æ“ä½œ PDF æ–‡ä»¶çš„åº•å±‚ç»“æ„ã€‚ä½†å®ƒä¹Ÿè¦æ±‚ä½ å¯¹ PDF è§„èŒƒæœ‰æ·±å…¥çš„äº†è§£ï¼Œæ“ä½œä¸å½“å¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶æŸåã€‚\nimport fitzdef deep_watermark_removal(doc_path, output_path):    print(&quot;è­¦å‘Šï¼šæ­¤æ–¹æ³•åœ¨PyMuPDFä¸­éš¾ä»¥ç›´æ¥å®ç°ï¼Œæ¨èä½¿ç”¨æ›´å®‰å…¨çš„redactionæ–¹æ³•&quot;)    doc = fitz.open(doc_path)    doc.save(output_path)    doc.close()\n\nä»£ç è§£æï¼š\n\nè¿™ä¸ªæ–¹æ³•æ—¨åœ¨ç›´æ¥æ“ä½œ PDF çš„ XObject (å¤–éƒ¨å¯¹è±¡ï¼Œå¯ä»¥æ˜¯å›¾åƒæˆ– Form XObject) å’Œå†…å®¹æµã€‚\n\né‡è¦æç¤ºï¼š PyMuPDF (Fitz) å¹¶æ²¡æœ‰ç›´æ¥æš´éœ²ä¿®æ”¹æˆ–åˆ é™¤åº•å±‚ PDF å¯¹è±¡çš„ APIã€‚ add_redact_annot æ˜¯ PyMuPDF ä¸­æœ€å®‰å…¨å’Œæ¨èçš„æ–¹å¼æ¥ â€œåˆ é™¤â€ é¡µé¢å†…å®¹çš„ã€‚ç›´æ¥ä¿®æ”¹ PDF çš„åº•å±‚å†…å®¹æµéå¸¸å±é™©ï¼Œæ“ä½œä¸å½“å¾ˆå¯èƒ½å¯¼è‡´ PDF æ–‡ä»¶æŸåä¸”æ— æ³•æ‰“å¼€ã€‚\n\nå› æ­¤ï¼Œæˆ‘è°ƒæ•´äº†æ­¤æ–¹æ³•çš„æè¿°å’Œä»£ç ç¤ºä¾‹ï¼Œå¼ºè°ƒå…¶å¤æ‚æ€§å’Œé£é™©ï¼Œå¹¶æŒ‡å‡ºåœ¨ PyMuPDF ä¸­ï¼Œæ›´æ¨èä½¿ç”¨ add_redact_annot æ¥å®ç° â€œåˆ é™¤â€ æ•ˆæœã€‚å¦‚æœä½ çœŸçš„éœ€è¦æ·±å…¥åˆ° PDF åº•å±‚ä¿®æ”¹ï¼Œå¯èƒ½éœ€è¦æ›´ä¸“ä¸šçš„ PDF å¤„ç†åº“æˆ–å¯¹ PDF è§„èŒƒæœ‰æå…¶æ·±å…¥çš„äº†è§£ã€‚\n\n\néš¾æ˜“åº¦ï¼šâ˜…â˜…â˜…â˜…â˜… (ç†è®ºä¸Š)\nä¼˜ç‚¹ï¼š ç†è®ºä¸Šå¯ä»¥å½»åº•æ¸…é™¤ä¸ç•™ç—•è¿¹ï¼Œé€‚ç”¨äºå„ç§ç±»å‹æ°´å°ã€‚\nç¼ºç‚¹ï¼š å®ç°éå¸¸å¤æ‚ï¼Œéœ€è¦æ·±å…¥çš„ PDF ç»“æ„çŸ¥è¯†ï¼Œä¸”åœ¨ PyMuPDF ä¸­ç›´æ¥å®ç°æ­¤ç±»æ“ä½œéš¾åº¦æé«˜ä¸”é£é™©å¤§ã€‚\næ–¹æ³•å¯¹æ¯”ä¸é€‰æ‹©å»ºè®®\n\n\n\næ–¹æ³•&#xA;\néš¾æ˜“åº¦&#xA;\né€‚ç”¨åœºæ™¯&#xA;\nå…³é”®ä¼˜åŠ¿&#xA;\nå±€é™æ€§&#xA;\n\n\n\nå­—ä½“å¤§å° + æ—‹è½¬è§’åº¦&#xA;\nâ˜…â˜…â˜…â˜†â˜†&#xA;\næ°´å°æœ‰å›ºå®šå¤§å°å’Œå€¾æ–œè§’åº¦&#xA;\nå®ç°ç›¸å¯¹ç®€å•ï¼Œè¯†åˆ«å‡†ç¡®ç‡è¾ƒé«˜&#xA;\néœ€è¦ç²¾ç¡®çš„å¤§å°å’Œè§’åº¦å‚æ•°&#xA;\n\n\né€æ˜åº¦ + é¢œè‰²&#xA;\nâ˜…â˜…â˜…â˜…â˜†&#xA;\næ°´å°æœ‰å›ºå®šé¢œè‰²ï¼ˆç‰¹åˆ«æ˜¯æµ…è‰²ï¼‰&#xA;\nå¯¹æµ…è‰²æ°´å°æ•ˆæœå¥½&#xA;\né€æ˜åº¦æå–æ˜¯éš¾ç‚¹ï¼Œå¯èƒ½éœ€è¦æ·±å…¥è§£æ PDF å†…éƒ¨ç»“æ„æˆ–å€ŸåŠ©å›¾åƒå¤„ç†åº“&#xA;\n\n\nå¤šç‰¹å¾ç»¼åˆ&#xA;\nâ˜…â˜…â˜…â˜…â˜…&#xA;\næ°´å°ç‰¹å¾æ˜ç¡®ä¸”å›ºå®š&#xA;\nè¯†åˆ«å‡†ç¡®æ€§é«˜ï¼Œè¯¯åˆ¤ç‡æä½&#xA;\nå®ç°ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ç²¾ç¡®çš„æ°´å°ç‰¹å¾å‚æ•°&#xA;\n\n\nåŸºäºæ–‡æœ¬ç‰¹å¾&#xA;\nâ˜…â˜…â˜†â˜†â˜†&#xA;\nç®€å•æ–‡æœ¬æ°´å°&#xA;\nå®ç°ç®€å•ï¼Œå¤„ç†é€Ÿåº¦å¿«&#xA;\nä»…é€‚ç”¨äºæ–‡æœ¬æ°´å°ï¼Œæ— æ³•å¤„ç†å›¾åƒæ°´å°&#xA;\n\n\næ··åˆç‰¹å¾è¯†åˆ«&#xA;\nâ˜…â˜…â˜…â˜…â˜†&#xA;\nå¤æ‚æ°´å°ç¯å¢ƒï¼ˆæ–‡æœ¬ä¸å›¾åƒæ··åˆï¼‰&#xA;\nè¯†åˆ«ç²¾åº¦é«˜&#xA;\nå®ç°å¤æ‚ï¼Œéœ€è¦æ°´å°æ¨¡æ¿ï¼Œå¤„ç†é€Ÿåº¦æ…¢&#xA;\n\n\nåº•å±‚ç»“æ„å¤„ç†&#xA;\nâ˜…â˜…â˜…â˜…â˜…&#xA;\nå„ç§ç±»å‹æ°´å°&#xA;\nç†è®ºä¸Šæœ€å½»åº•&#xA;\né«˜é£é™©ï¼ŒPyMuPDF ä¸­éš¾ä»¥ç›´æ¥å®ç°ï¼Œéœ€è¦æ·±åšçŸ¥è¯†&#xA;\n\n\nç‰¹å¾å‚æ•°æå–æ–¹æ³•\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è·å–æ°´å°çš„ç‰¹å¾å‚æ•°ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆæ­¥æå–ï¼š\nimport fitzimport mathfrom collections import Counterdef extract_watermark_features(pdf_path, page_num=0):    doc = fitz.open(pdf_path)    page = doc[page_num]    possible_font_sizes = []    possible_rotations = []    possible_colors = []        text_infos = page.get_text(&quot;dict&quot;)    for block in text_infos[&quot;blocks&quot;]:        if &quot;lines&quot; in block:            for line in block[&quot;lines&quot;]:                for span in line[&quot;spans&quot;]:                    possible_font_sizes.append(round(span[&quot;size&quot;], 1))                    matrix = fitz.Matrix(span[&quot;matrix&quot;])                    rotation = round(math.degrees(math.atan2(matrix.b, matrix.a)), 1)                    possible_rotations.append(rotation)                    color_int = span[&quot;color&quot;]                    r = (color_int &gt;&gt; 16) &amp; 0xFF                    g = (color_int &gt;&gt; 8) &amp; 0xFF                    b = color_int &amp; 0xFF                    possible_colors.append((r, g, b))        font_size = Counter(possible_font_sizes).most_common(1)[0][0] if possible_font_sizes else None    rotation_angle = Counter(possible_rotations).most_common(1)[0][0] if possible_rotations else None    if rotation_angle and rotation_angle &lt; 0:        rotation_angle += 360    color_rgb = Counter(possible_colors).most_common(1)[0][0] if possible_colors else None        doc.close()    return &#123;        &quot;font_size&quot;: font_size,        &quot;rotation_angle&quot;: rotation_angle,        &quot;color_rgb&quot;: color_rgb,        &quot;opacity&quot;: 0.5    &#125;\n\nä»£ç è§£æï¼š\n\næ­¤å‡½æ•°ä¼šéå†æŒ‡å®šé¡µé¢çš„æ‰€æœ‰æ–‡æœ¬è·¨åº¦ï¼Œæ”¶é›†å®ƒä»¬çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦å’Œé¢œè‰²ã€‚\n\nä¸ºäº†æ–¹ä¾¿ç»Ÿè®¡ï¼Œå¯¹æµ®ç‚¹æ•°ï¼ˆå¤§å°å’Œè§’åº¦ï¼‰è¿›è¡Œäº†å››èˆäº”å…¥ã€‚\n\nä½¿ç”¨ collections.Counter æ‰¾å‡ºæœ€å¸¸è§çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦å’Œé¢œè‰²ï¼Œä½œä¸ºå¯èƒ½çš„æ°´å°ç‰¹å¾ã€‚\n\næ³¨æ„ï¼š æå–é€æ˜åº¦ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œopacity å‚æ•°åœ¨æ­¤å¤„ä»ä½œä¸ºå ä½ç¬¦ï¼Œéœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚æ‰‹åŠ¨è§‚å¯Ÿæˆ–æ›´å¤æ‚çš„ PDF å†…å®¹æµè§£æï¼‰æ¥ç¡®å®šã€‚\n\n\næ€»ç»“ä¸æœ€ä½³å®è·µ\nåŸºäºç‰¹å¾çš„ PDF æ°´å°å¤„ç†æ–¹æ³•èƒ½å¤Ÿå®ç°æ›´ç²¾ç¡®çš„æ°´å°è¯†åˆ«å’Œå»é™¤ï¼Œä½†è¿™è¦æ±‚ä½ å¯¹æ°´å°çš„ç‰¹å¾æœ‰å……åˆ†äº†è§£ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘å»ºè®®ä½ éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š\n\né¢„å¤„ç†åˆ†æï¼š é¦–å…ˆä½¿ç”¨ extract_watermark_features å‡½æ•°åˆ†ææ°´å°ç‰¹å¾ï¼Œåˆæ­¥äº†è§£æ°´å°çš„å­—ä½“å¤§å°ã€æ—‹è½¬è§’åº¦ã€é¢œè‰²ç­‰å…³é”®ä¿¡æ¯ã€‚å¿…è¦æ—¶ï¼Œæ‰‹å·¥è§‚å¯Ÿæ°´å°ï¼Œç¡®è®¤å…¶é€æ˜åº¦ã€å…·ä½“æ–‡æœ¬å†…å®¹æˆ–å›¾åƒæ ·å¼ã€‚\n\nä»ç®€åˆ°ç¹å°è¯•ï¼š ä»æœ€ç®€å•çš„æ–¹æ³•å¼€å§‹ã€‚å¦‚æœæ°´å°æ˜¯çº¯æ–‡æœ¬ä¸”ç‰¹å¾æ˜æ˜¾ï¼Œå¯ä»¥å…ˆå°è¯• åŸºäºæ–‡æœ¬ç‰¹å¾çš„ç›´æ¥åˆ é™¤æ³•ã€‚å¦‚æœæ°´å°æœ‰å›ºå®šçš„å­—ä½“å¤§å°å’Œå€¾æ–œè§’åº¦ï¼Œå°±ç”¨ åŸºäºå­—ä½“å¤§å°å’Œæ—‹è½¬è§’åº¦çš„æ–¹æ³•ã€‚åªæœ‰å½“ç®€å•æ–¹æ³•æ•ˆæœä¸ä½³æ—¶ï¼Œå†é€æ­¥å¢åŠ ç‰¹å¾ç»´åº¦ï¼Œå°è¯• å¤šç‰¹å¾ç»¼åˆè¯†åˆ«ã€‚\n\nåˆç†è°ƒæ•´å‚æ•°ï¼š æ ¹æ®å®é™…æ°´å°æƒ…å†µç»†è‡´è°ƒæ•´åŒ¹é…å®¹å·®å€¼ï¼Œåœ¨è¯†åˆ«å‡†ç¡®ç‡å’Œè¯¯åˆ¤ç‡ä¹‹é—´å–å¾—æœ€ä½³å¹³è¡¡ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå­—ä½“å¤§å°ï¼Œå¯ä»¥å…è®¸ 1.0 åˆ° 2.0 çš„è¯¯å·®èŒƒå›´ï¼›å¯¹äºæ—‹è½¬è§’åº¦ï¼Œå¯å…è®¸ 3 åˆ° 5 åº¦å·¦å³çš„è¯¯å·®ã€‚\n\nå¤æ‚åœºæ™¯ç»„åˆï¼š å¯¹äºåŒ…å«å¤šç§ç±»å‹æ°´å°çš„å¤æ‚ PDFï¼Œè€ƒè™‘ç»“åˆå¤šç§æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ—¢æœ‰æ–‡æœ¬åˆæœ‰å›¾åƒçš„æ··åˆæ°´å°ï¼Œå¯ä»¥ç»“åˆ æ··åˆç‰¹å¾è¯†åˆ«æ³•ã€‚\n\næ‰¹é‡å¤„ç†æŠ€å·§ï¼š å¦‚æœä½ éœ€è¦å¤„ç†å¤§é‡ PDF æ–‡ä»¶ï¼Œåˆ©ç”¨å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹å¯ä»¥æ˜¾è‘—æé«˜å¤„ç†æ•ˆç‡ã€‚\n\n\nfrom concurrent.futures import ThreadPoolExecutorimport osdef batch_process_pdfs(file_list, output_dir, **watermark_params):    os.makedirs(output_dir, exist_ok=True)    with ThreadPoolExecutor(max_workers=os.cpu_count()) as executor:        futures = []        for file_path in file_list:            file_name = os.path.basename(file_path)            output_path = os.path.join(output_dir, file_name)            futures.append(executor.submit(                remove_watermark_by_multiple_features,                file_path, output_path, **watermark_params            ))        for future in futures:            try:                future.result()                print(f&quot;æ–‡ä»¶å¤„ç†å®Œæˆï¼š&#123;file_path&#125;&quot;)            except Exception as exc:                print(f&quot;æ–‡ä»¶ &#123;file_path&#125; å¤„ç†æ—¶å‘ç”Ÿé”™è¯¯ï¼š&#123;exc&#125;&quot;)\n\n\n\n\næ“ä½œå®‰å…¨ä¿éšœï¼š åœ¨å¤„ç†ä»»ä½•é‡è¦æ–‡ä»¶ä¹‹å‰ï¼ŒåŠ¡å¿…å…ˆå¤‡ä»½åŸå§‹æ–‡ä»¶ï¼è¿™èƒ½ç¡®ä¿å³ä½¿å¤„ç†ä¸å½“ï¼Œä½ ä¹Ÿä¸ä¼šä¸¢å¤±åŸå§‹æ•°æ®ã€‚åŒæ—¶ï¼Œè¯·å§‹ç»ˆéµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œä»…å¤„ç†ä½ æœ‰æƒä¿®æ”¹çš„æ–‡æ¡£ï¼Œå°Šé‡çŸ¥è¯†äº§æƒå’Œç‰ˆæƒä¿æŠ¤ã€‚\n\né€šè¿‡åˆç†é€‰æ‹©å’Œç»„åˆè¿™äº›æ–¹æ³•ï¼Œä½ å°±èƒ½é«˜æ•ˆä¸”ç²¾å‡†åœ°å¤„ç†å„ç§å…·æœ‰ç‰¹å®šç‰¹å¾çš„ PDF æ°´å°ã€‚\nPS:ä»£ç ä»…ä¾›å‚è€ƒï¼Œå†…å®¹ä¸ä¸€å®šæ­£ç¡®ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µå¤„ç†å–µ\n","categories":["PDF å¤„ç†","Python","æ•°æ®å¤„ç†"],"tags":["Python","PyMuPDF","PDF","æ°´å°å»é™¤","ç‰¹å¾è¯†åˆ«","æ–‡æœ¬å¤„ç†"]},{"title":"dockerç¦»çº¿éƒ¨ç½²ï¼šç©¿è¶Šç½‘ç»œå±éšœçš„å®¹å™¨ç¼–æ’åˆ©å™¨","url":"/2025/07/16/docker%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2%EF%BC%9A%E7%A9%BF%E8%B6%8A%E7%BD%91%E7%BB%9C%E5%B1%8F%E9%9A%9C%E7%9A%84%E5%AE%B9%E5%99%A8%E7%BC%96%E6%8E%92%E5%88%A9%E5%99%A8/","content":"ä¸€ã€Docker Compose ç¦»çº¿å®‰è£…æ­¥éª¤\nåœ¨ GitHub ä¸Šæ‰¾åˆ°å¯¹åº”çš„ docker-compose ç½‘ç«™ï¼Œä¸‹è½½é€‚åˆå½“å‰ç³»ç»Ÿçš„ç¦»çº¿å®‰è£…åŒ…ï¼ˆå¦‚ docker-compose-linux-x86_64ï¼‰ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨ &#x2F;tmp ç›®å½•ä¸‹ã€‚\nèµ‹äºˆæ‰§è¡Œæƒé™å¹¶ç§»åŠ¨è‡³ç³»ç»Ÿè·¯å¾„&#xA;# èµ‹äºˆå¯æ‰§è¡Œæƒé™chmod +x /tmp/docker-compose-linux-x86_64# ç§»åŠ¨åˆ°ç³»ç»Ÿå¯æ‰§è¡Œç›®å½•sudo mv /tmp/docker-compose-linux-x86_64 /usr/local/bin/docker-compose\n\néªŒè¯å®‰è£…ç»“æœ&#xA;docker-compose --version# è¾“å‡ºç¤ºä¾‹ï¼šdocker-compose version 2.20.3, build a8266d3\n\näºŒã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ³•\næƒé™ä¸è¶³é—®é¢˜&#xA;é—®é¢˜&#xA;æ‰§è¡Œ mv æ—¶æç¤ºæƒé™é”™è¯¯ã€‚\nè§£å†³&#xA;ä½¿ç”¨ sudo å‘½ä»¤è·å–ç®¡ç†å‘˜æƒé™ï¼š\nsudo mv /tmp/docker-compose-linux-x86_64 /usr/local/bin/docker-compose\n\nå‘½ä»¤ä¸å­˜åœ¨é—®é¢˜&#xA;é—®é¢˜&#xA;è¾“å…¥ docker-compose æç¤ºå‘½ä»¤æœªæ‰¾åˆ°ã€‚\nè§£å†³&#xA;æ£€æŸ¥ç³»ç»Ÿè·¯å¾„æ˜¯å¦åŒ…å« &#x2F;usr&#x2F;local&#x2F;binï¼š\necho $PATH  # è‹¥ä¸å« /usr/local/binï¼Œæ·»åŠ è‡³ç¯å¢ƒå˜é‡export PATH=$PATH:/usr/local/bin\n\næ–‡ä»¶åç©ºæ ¼é—®é¢˜&#xA;é—®é¢˜&#xA;è„šæœ¬æ–‡ä»¶åå«å‰å¯¼ç©ºæ ¼å¯¼è‡´å‘½ä»¤å¤±è´¥ã€‚\nè§£å†³&#xA;é‡å‘½åæ–‡ä»¶å»é™¤ç©ºæ ¼ï¼š\nmv &#x27; replace_image_registry.sh&#x27; replace_image_registry.sh\n\nä¸‰ã€æ ¸å¿ƒå‘½ä»¤æ€»ç»“\nå®‰è£…æ ¸å¿ƒæ­¥éª¤&#xA;ä¸‹è½½ â†’ èµ‹æƒ â†’ ç§»åŠ¨ â†’ éªŒè¯\nå…³é”®å‘½ä»¤&#xA;chmod +x /tmp/docker-compose-linux-x86_64sudo mv /tmp/docker-compose-linux-x86_64 /usr/local/bin/docker-composedocker-compose --version\n\nPS:ä»£ç ä»…ä¾›å‚è€ƒï¼Œå†…å®¹ä¸ä¸€å®šæ­£ç¡®ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µå¤„ç†å–µ\n","categories":["å®¹å™¨æŠ€æœ¯","éƒ¨ç½²å®è·µ"],"tags":["Docker Compose","ç¦»çº¿å®‰è£…","Linux"]},{"title":"æ­ç§˜xlsxwriterï¼šå¯Œæ–‡æœ¬æ ¼å¼å¦‚ä½•ç²¾å‡†â€œæŸ“è‰²â€ï¼Ÿ","url":"/2025/07/16/xlsxwriter%EF%BC%9A%E5%AF%8C%E6%96%87%E6%9C%AC%E6%A0%BC%E5%BC%8F%E5%A6%82%E4%BD%95%E7%B2%BE%E5%87%86%E2%80%9C%E6%9F%93%E8%89%B2%E2%80%9D%EF%BC%9F/","content":"æ ¸å¿ƒæ¦‚å¿µ\nxlsxwriter é€šè¿‡å•å…ƒæ ¼æ ¼å¼å’Œæ–‡æœ¬ä½ç½®ç´¢å¼•æ¥ç²¾ç¡®æ§åˆ¶æ–‡æœ¬åŒºé—´æ ·å¼ï¼Œå…¶åˆ¤å®šé€»è¾‘åŸºäºä»¥ä¸‹å…³é”®å†…å®¹ï¼š\n1. æ–‡æœ¬åŒºé—´å®šä¹‰æ–¹å¼&#xA;# åŸºæœ¬è¯­æ³•ï¼ˆéçœŸå®ä»£ç ï¼Œä»…ç¤ºæ„é€»è¾‘ï¼‰worksheet.write_rich_string(    row, col,    [format1, &quot;çº¢è‰²æ–‡æœ¬&quot;, format2, &quot;æ™®é€šæ–‡æœ¬&quot;])\n\nä½ç½®åˆ¤å®šï¼šæ ¹æ®å­—ç¬¦ä¸²åœ¨å‚æ•°åˆ—è¡¨ä¸­çš„é¡ºåºç¡®å®šä½ç½®\n\næ ¼å¼ç»§æ‰¿ï¼šæ ¼å¼å¯¹è±¡ä½œç”¨äºç´§éšå…¶åçš„æ–‡æœ¬æ®µ\n\n\n2. å…³é”®åˆ¤å®šè§„åˆ™&#xA;\n\n\nåˆ¤å®šç»´åº¦&#xA;\nè¯´æ˜&#xA;\n\n\n\næ ¼å¼å¯¹è±¡ä½ç½®&#xA;\næ ¼å¼æ€»æ˜¯åº”ç”¨äºä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²å…ƒç´ &#xA;\n\n\næ–‡æœ¬åˆ†æ®µ&#xA;\næ¯ä¸ªå­—ç¬¦ä¸²å…ƒç´ è¢«è§†ä¸ºç‹¬ç«‹æ–‡æœ¬æ®µ&#xA;\n\n\nç©ºæ ¼å¼å¤„ç†&#xA;\nNone æˆ–çœç•¥æ ¼å¼æ—¶ç»§æ‰¿å•å…ƒæ ¼é»˜è®¤æ ¼å¼&#xA;\n\n\nç‰¹æ®Šå­—ç¬¦&#xA;\næ¢è¡Œç¬¦ (\\n) ä¼šåˆ›å»ºæ–°æ–‡æœ¬æ®µä½†ä¸ä¸­æ–­æ ¼å¼åº”ç”¨&#xA;\n\n\n3. å®é™…åº”ç”¨ç¤ºä¾‹&#xA;æ¡ˆä¾‹ 1ï¼šåŸºç¡€çº¢é»‘æ–‡æœ¬&#xA;red = workbook.add_format(&#123;&#x27;color&#x27;: &#x27;red&#x27;&#125;)black = workbook.add_format(&#123;&#x27;color&#x27;: &#x27;black&#x27;&#125;)# &quot;ç­”æ¡ˆ&quot;çº¢è‰²ï¼Œ&quot;:&quot;é»‘è‰²ï¼Œ&quot;42&quot;çº¢è‰²worksheet.write_rich_string(&#x27;A1&#x27;,    red, &#x27;ç­”æ¡ˆ&#x27;,    black, &#x27;:&#x27;,    red, &#x27;42&#x27;)\n\nå†…å­˜ä¸­çš„åŒºé—´æ˜ å°„ï¼š\n[0-2): çº¢è‰²æ ¼å¼ (å¯¹åº”&quot;ç­”æ¡ˆ&quot;)[2-3): é»‘è‰²æ ¼å¼ (å¯¹åº”&quot;:&quot;) [3-5): çº¢è‰²æ ¼å¼ (å¯¹åº”&quot;42&quot;)\n\næ¡ˆä¾‹ 2ï¼šå¸¦æ ¼å¼ç»§æ‰¿çš„æ–‡æœ¬&#xA;bold = workbook.add_format(&#123;&#x27;bold&#x27;: True&#125;)default = workbook.add_format()# &quot;æ³¨æ„&quot;åŠ ç²—ï¼Œåç»­æ–‡æœ¬é»˜è®¤æ ¼å¼worksheet.write_rich_string(&#x27;A2&#x27;,    bold, &#x27;æ³¨æ„&#x27;,    None, &#x27;ï¼šè¯·æ£€æŸ¥æ•°æ®&#x27;  # Noneç»§æ‰¿å•å…ƒæ ¼é»˜è®¤æ ¼å¼)\n\n4. ç‰¹æ®Šåœºæ™¯å¤„ç†&#xA;æ··åˆæ ¼å¼æ–‡æœ¬&#xA;# åŒä¸€å•è¯ä¸­éƒ¨åˆ†å­—æ¯æ ‡çº¢worksheet.write_rich_string(&#x27;A3&#x27;,    black, &#x27;Pri&#x27;,    red, &#x27;mar&#x27;,    black, &#x27;y&#x27;)\næ•ˆæœï¼šæ˜¾ç¤ºä¸º â€œPrimaryâ€ å…¶ä¸­ â€œmarâ€ ä¸ºçº¢è‰²\nåŠ¨æ€æ–‡æœ¬æ„å»º&#xA;parts = [black, &quot;éšæœºå€¼ï¼š&quot;]if highlight:    parts.extend([red, str(value)])else:    parts.extend([black, str(value)])    worksheet.write_rich_string(&#x27;A4&#x27;, *parts)\n\n5. åº•å±‚å®ç°åŸç†&#xA;\nOpenXML æ˜ å°„ï¼šæœ€ç»ˆç”Ÿæˆç±»ä¼¼ä»¥ä¸‹ XML ç»“æ„\n\n&lt;r&gt;  &lt;rPr&gt;&lt;color rgb=&quot;FFFF0000&quot;/&gt;&lt;/rPr&gt;  &lt;t&gt;ç­”æ¡ˆ&lt;/t&gt;&lt;/r&gt;&lt;r&gt;  &lt;rPr&gt;&lt;color rgb=&quot;FF000000&quot;/&gt;&lt;/rPr&gt;  &lt;t&gt;:&lt;/t&gt;&lt;/r&gt;\n\nç´¢å¼•è®¡ç®—ï¼šåº“å†…éƒ¨ç»´æŠ¤æ ¼å¼æ ˆï¼Œæ ¹æ®å‚æ•°é¡ºåºè®¡ç®—æ¯ä¸ªæ–‡æœ¬æ®µçš„èµ·æ­¢ä½ç½®\n\n6. ä½¿ç”¨é™åˆ¶ä¸æ³¨æ„äº‹é¡¹&#xA;\nä¸å¯å˜ç‰¹æ€§ï¼šä¸€æ—¦å†™å…¥æ— æ³•ä¿®æ”¹å•ä¸ªæ–‡æœ¬æ®µæ ¼å¼\n\næ€§èƒ½å½±å“ï¼šæ¯ä¸ªæ ¼å¼å˜åŒ–éƒ½ä¼šåˆ›å»ºæ–°çš„&lt;r&gt;å…ƒç´ ï¼Œè¿‡å¤šåˆ†æ®µå½±å“æ–‡ä»¶å¤§å°\n\nè¾¹ç•Œæƒ…å†µï¼š\n\nç©ºå­—ç¬¦ä¸²ä»ä¼šå ç”¨æ ¼å¼åŒºé—´\nè¿ç»­çš„ç›¸åŒæ ¼å¼ä¸ä¼šè‡ªåŠ¨åˆå¹¶\n\n\n\n7. è°ƒè¯•æŠ€å·§&#xA;# æŸ¥çœ‹å®é™…ç”Ÿæˆçš„XMLï¼ˆéœ€è¦ä¿å­˜æ–‡ä»¶åè§£å‹æŸ¥çœ‹ï¼‰workbook.filename = &#x27;output.xlsx&#x27;workbook.close()# è§£å‹åæŸ¥çœ‹xl/worksheets/sheet1.xml\n\næœ€ä½³å®è·µå»ºè®®&#xA;\næ‰¹é‡åˆå¹¶ç›¸åŒæ ¼å¼çš„æ–‡æœ¬æ®µ\n\nå¯¹é™æ€å†…å®¹é¢„å…ˆç”Ÿæˆæ ¼å¼åˆ—è¡¨\n\né¿å…å•ä¸ªå•å…ƒæ ¼å†…è¶…è¿‡ 20 ä¸ªæ ¼å¼åˆ†æ®µ\n\nå¯¹åŠ¨æ€å†…å®¹ä½¿ç”¨è¾…åŠ©å‡½æ•°æ„å»ºå‚æ•°åˆ—è¡¨\n\n\ndef build_rich_text(text_parts):    result = []    for text, fmt in text_parts:        result.extend([fmt, text])    return result\n\næ³¨ï¼šä¸ openpyxl çš„ CellRichText ä¸åŒï¼Œxlsxwriter é‡‡ç”¨æ›´åº•å±‚çš„æ ¼å¼ç»‘å®šæœºåˆ¶ï¼Œå¯¹æ–‡æœ¬åŒºé—´çš„åˆ¤å®šå®Œå…¨åŸºäºå‚æ•°åºåˆ—é¡ºåºï¼Œä¸ä¾èµ–ä»»ä½•æ–‡æœ¬æ ‡è®°ç¬¦å·ã€‚\nå…³é”®è¦ç‚¹æ€»ç»“&#xA;\nxlsxwriter çš„æ–‡æœ¬åŒºé—´åˆ¤å®šæ˜¯é¡ºåºæ•æ„Ÿçš„\n\næ ¼å¼å¯¹è±¡æ€»æ˜¯å‘å‰ç»‘å®šåˆ°ä¸‹ä¸€ä¸ªæ–‡æœ¬å…ƒç´ \n\nå®é™…æ¸²æŸ“æ—¶ä¼šå°†æ–‡æœ¬åŒºé—´æ˜ å°„ä¸º OpenXML çš„&lt;r&gt;å…ƒç´ \n\nå¤„ç†å¯Œæ–‡æœ¬æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„å‚æ•°åˆ—è¡¨çš„æ„å»ºé¡ºåº\n\n\nPS:ä»£ç ä»…ä¾›å‚è€ƒï¼Œå†…å®¹ä¸ä¸€å®šæ­£ç¡®ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µå¤„ç†å–µ\n","categories":["Pythonåº“åº”ç”¨"],"tags":["Excel","Python","xlsxwriter","æ ¼å¼åŒ–"]},{"title":"ä»é›¶å¼€å§‹çš„çˆ¬è™«ç”Ÿæ´»ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºä¸åŸºç¡€åº“åº”ç”¨","url":"/2025/07/15/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%88%AC%E8%99%AB%E7%94%9F%E6%B4%BB%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%9F%BA%E7%A1%80%E5%BA%93%E5%BA%94%E7%94%A8/","content":"ä¸€ã€ç¯å¢ƒæ­å»º\nåœ¨å¼€å§‹å­¦ä¹ çˆ¬è™«ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ­å»ºå¥½å¼€å‘ç¯å¢ƒã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„å·¥å…·å’Œåº“ï¼š\n1. Python ç¯å¢ƒ&#xA;ç¡®ä¿å·²ç»å®‰è£…äº† Python 3.x ç‰ˆæœ¬ã€‚å¯ä»¥å‰å¾€ Python å®˜ç½‘ ä¸‹è½½å®‰è£…ã€‚\n2. å¸¸ç”¨åº“å®‰è£…&#xA;ä½¿ç”¨ pip å‘½ä»¤å®‰è£…ä»¥ä¸‹åº“ï¼š\npip install seleniumpip install beautifulsoup4pip install pyquerypip install pymysqlpip install pymongopip install redis\n\n3. æµè§ˆå™¨é©±åŠ¨&#xA;\nChromeDriverï¼šæ ¹æ®ä½ ä½¿ç”¨çš„ Chrome æµè§ˆå™¨ç‰ˆæœ¬ï¼Œä¸‹è½½å¯¹åº”çš„ ChromeDriverã€‚\n\nPhantomJSï¼ˆå·²å¼ƒç”¨ï¼‰ï¼šåœ¨ Selenium 4.x ä¸­å·²ç§»é™¤ï¼Œå»ºè®®ä½¿ç”¨æ— å¤´æ¨¡å¼çš„ Chromeã€‚\n\n\né…ç½® Chrome æ— å¤´æ¨¡å¼ç¤ºä¾‹ï¼š\nfrom selenium import webdriverfrom selenium.webdriver.chrome.options import Options# é…ç½® Chrome ä¸ºæ— å¤´æ¨¡å¼chrome_options = Options()chrome_options.add_argument(&quot;--headless&quot;)  # æ— å¤´æ¨¡å¼ï¼Œä¸æ˜¾ç¤ºæµè§ˆå™¨çª—å£# åˆ›å»º Chrome æµè§ˆå™¨å®ä¾‹driver = webdriver.Chrome(options=chrome_options)driver.get(&quot;https://www.example.com&quot;)print(driver.title)driver.quit()\n\näºŒã€åŸºç¡€åº“åº”ç”¨\n1. BeautifulSoup åº“&#xA;BeautifulSoup æ˜¯ä¸€ä¸ªç”¨äºè§£æ HTML å’Œ XML æ–‡æ¡£çš„åº“ã€‚ç¤ºä¾‹ï¼š\nfrom bs4 import BeautifulSouphtml_doc = &quot;&quot;&quot;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;ç¤ºä¾‹é¡µé¢&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h1&gt;æ ‡é¢˜&lt;/h1&gt;        &lt;p&gt;æ®µè½å†…å®¹&lt;/p&gt;    &lt;/body&gt;&lt;/html&gt;&quot;&quot;&quot;soup = BeautifulSoup(html_doc, &#x27;html.parser&#x27;)print(soup.title.string)  # è¾“å‡ºæ ‡é¢˜å†…å®¹&quot;&quot;&quot;soup = BeautifulSoup(html_doc, &#x27;html.parser&#x27;)print(soup.title.string)  # è¾“å‡ºæ ‡é¢˜å†…å®¹\n\n2. PyQuery åº“&#xA;PyQuery æ˜¯ä¸€ä¸ªç±» jQuery çš„ Python åº“ï¼Œç”¨äºæ“ä½œ HTML æ–‡æ¡£ã€‚ç¤ºä¾‹ï¼š\nfrom pyquery import PyQuery as pqhtml_doc = &quot;&quot;&quot;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;ç¤ºä¾‹é¡µé¢&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h1&gt;æ ‡é¢˜&lt;/h1&gt;        &lt;p&gt;æ®µè½å†…å®¹&lt;/p&gt;    &lt;/body&gt;&lt;/html&gt;&quot;&quot;&quot;doc = pq(html_doc)print(doc(&#x27;title&#x27;).text())  # è¾“å‡ºæ ‡é¢˜å†…å®¹\n\n3. Requests åº“&#xA;Requests æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP åº“ï¼Œç”¨äºå‘é€ç½‘ç»œè¯·æ±‚ã€‚ç¤ºä¾‹ï¼š\nimport requestsurl = &quot;https://www.example.com&quot;response = requests.get(url)print(response.text)  # è¾“å‡ºç½‘é¡µå†…å®¹\n\nä¸‰ã€æ•°æ®å­˜å‚¨\n1. MySQL æ•°æ®åº“&#xA;ä½¿ç”¨ PyMySQL è¿æ¥å’Œæ“ä½œ MySQL æ•°æ®åº“ï¼š\nimport pymysqlconn = pymysql.connect(    host=&#x27;localhost&#x27;,    user=&#x27;root&#x27;,    password=&#x27;123456&#x27;,    port=3306,    db=&#x27;mysql&#x27;)cursor = conn.cursor()cursor.execute(&#x27;SELECT * FROM db&#x27;)print(cursor.fetchone())conn.close()\n\n2. MongoDB æ•°æ®åº“&#xA;ä½¿ç”¨ PyMongo è¿æ¥å’Œæ“ä½œ MongoDB æ•°æ®åº“ï¼š\nimport pymongoclient = pymongo.MongoClient(&#x27;localhost&#x27;)db = client[&#x27;newtestdb&#x27;]db[&#x27;table&#x27;].insert_one(&#123;&#x27;name&#x27;: &#x27;Bob&#x27;&#125;)result = db[&#x27;table&#x27;].find_one(&#123;&#x27;name&#x27;: &#x27;Bob&#x27;&#125;)print(result)\n\n3. Redis æ•°æ®åº“&#xA;ä½¿ç”¨ RedisPy è¿æ¥å’Œæ“ä½œ Redis æ•°æ®åº“ï¼š\nimport redisr = redis.Redis(&#x27;localhost&#x27;, 6379)r.set(&#x27;name&#x27;, &#x27;Bob&#x27;)result = r.get(&#x27;name&#x27;)print(result)\n\nå››ã€çˆ¬è™«åŸºæœ¬æµç¨‹\nçˆ¬è™«çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š\n\nå‘é€è¯·æ±‚ï¼šä½¿ç”¨ Requests åº“å‘é€ HTTP è¯·æ±‚è·å–ç½‘é¡µå†…å®¹ã€‚\n\nè§£æå“åº”ï¼šä½¿ç”¨ BeautifulSoup æˆ– PyQuery åº“è§£æç½‘é¡µå†…å®¹ï¼Œæå–æ‰€éœ€æ•°æ®ã€‚\n\nä¿å­˜æ•°æ®ï¼šå°†æå–çš„æ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“æˆ–æ–‡ä»¶ä¸­ã€‚\n\n\nç¤ºä¾‹ï¼šçˆ¬å–çŒ«çœ¼ç”µå½± TOP100\nimport requestsimport reimport jsonfrom multiprocessing import Pooldef get_one_page(url):    headers = &#123;        &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36 Edg/137.0.0.0&#x27;    &#125;    response = requests.get(url, headers=headers)    if response.status_code == 200:        return response.text    return Nonedef parse_one_page(html):    pattern = re.compile(&#x27;&lt;dd&gt;.*?board-index.*?&gt;(d+)&lt;/i&gt;.*?data-src=&quot;(.*?)&quot;.*?name&quot;&gt;&lt;a&#x27;                         + &#x27;.*?&gt;(.*?)&lt;/a&gt;.*?star&quot;&gt;(.*?)&lt;/p&gt;.*?releasetime&quot;&gt;(.*?)&lt;/p&gt;&#x27;                         + &#x27;.*?integer&quot;&gt;(.*?)&lt;/i&gt;.*?fraction&quot;&gt;(.*?)&lt;/i&gt;.*?&lt;/dd&gt;&#x27;, re.S)    items = re.findall(pattern, html)    for item in items:        yield &#123;            &#x27;index&#x27;: item[0],            &#x27;image&#x27;: item[1],            &#x27;title&#x27;: item[2],            &#x27;actor&#x27;: item[3].strip()[3:],            &#x27;time&#x27;: item[4].strip()[5:],            &#x27;score&#x27;: item[5] + item[6]        &#125;def write_to_file(content):    with open(&#x27;result.txt&#x27;, &#x27;a&#x27;, encoding=&#x27;utf-8&#x27;) as f:        f.write(json.dumps(content, ensure_ascii=False) + &#x27;n&#x27;)def main(offset):    url = &#x27;http://maoyan.com/board/4?offset=&#x27; + str(offset)    html = get_one_page(url)    for item in parse_one_page(html):        print(item)        write_to_file(item)if __name__ == &#x27;__main__&#x27;:    pool = Pool()    pool.map(main, [i * 10 for i in range(10)])\n\näº”ã€åŠ¨æ€ç½‘é¡µå¤„ç†\nå¯¹äºåŠ¨æ€åŠ è½½çš„ç½‘é¡µï¼Œå¯ä»¥ä½¿ç”¨ Selenium æ¨¡æ‹Ÿæµè§ˆå™¨æ“ä½œã€‚ç¤ºä¾‹ï¼š\nfrom selenium import webdriverfrom selenium.webdriver.common.by import Bydriver = webdriver.Chrome()driver.get(&#x27;https://www.taobao.com&#x27;)input = driver.find_element(By.ID, &#x27;q&#x27;)input.send_keys(&#x27;ç¾é£Ÿ&#x27;)button = driver.find_element(By.CLASS_NAME, &#x27;btn-search&#x27;)button.click()driver.quit()\n\nå…­ã€çˆ¬è™«æ¡†æ¶\n1. Scrapy æ¡†æ¶&#xA;Scrapy æ˜¯ä¸€ä¸ªå¼ºå¤§çš„çˆ¬è™«æ¡†æ¶ï¼Œå¯ä»¥ç®€åŒ–çˆ¬è™«å¼€å‘è¿‡ç¨‹ã€‚å®‰è£…å‘½ä»¤ï¼š\npip install scrapy\n\næœªå®Œå¾…ç»­â€¦â€¦\nPS:ä»£ç ä»…ä¾›å‚è€ƒï¼Œå†…å®¹ä¸ä¸€å®šæ­£ç¡®ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µå¤„ç†å–µ\n","categories":["çˆ¬è™«æ•™ç¨‹"],"tags":["Pythonçˆ¬è™«","æ•°æ®æŠ“å–","Selenium","BeautifulSoup","æ•°æ®å­˜å‚¨"]},{"title":"ã€Šæ°´å°å¤„ç†çš„æˆé•¿æ—¥è®°ï¼šä»0å¼€å§‹çš„PDFå¤„ç†ä¹‹è·¯ã€‹","url":"/2025/07/16/%E3%80%8A%E6%B0%B4%E5%8D%B0%E5%A4%84%E7%90%86%E7%9A%84%E6%88%90%E9%95%BF%E6%97%A5%E8%AE%B0%EF%BC%9A%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84PDF%E5%A4%84%E7%90%86%E4%B9%8B%E8%B7%AF%E3%80%8B/","content":"åœ¨æ—¥å¸¸åŠå…¬å’Œå­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å¸¦æœ‰æ°´å°çš„ PDF æ–‡æ¡£ï¼Œè¿™äº›æ°´å°ä¸ä»…å½±å“é˜…è¯»ä½“éªŒï¼Œè¿˜å¯èƒ½å¹²æ‰°æ–‡æ¡£çš„äºŒæ¬¡ç¼–è¾‘å’Œä½¿ç”¨ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œä¸€æ­¥æ­¥æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ PDF æ°´å°å»é™¤å·¥å…·ï¼Œå®ç°ä»å•æ–‡ä»¶å¤„ç†åˆ°æ‰¹é‡è½¬æ¢çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚\néœ€æ±‚åˆ†æï¼šä¸ºä»€ä¹ˆéœ€è¦ PDF æ°´å°å»é™¤å·¥å…·\nPDF æ°´å°é€šå¸¸åˆ†ä¸ºå¯è§æ°´å°å’Œä¸å¯è§æ°´å°ä¸¤ç±»ã€‚å¯è§æ°´å°å¤šä»¥æ–‡å­—ã€Logo ç­‰å½¢å¼å­˜åœ¨ï¼Œè™½ç„¶ä¸å½±å“å†…å®¹çš„å¯è¯»æ€§ï¼Œä½†åœ¨æ–‡æ¡£åˆ†å‘ã€æ‰“å°ç­‰åœºæ™¯ä¸‹ä¼šæ˜¾å¾—ä¸å¤Ÿä¸“ä¸šã€‚ç‰¹åˆ«æ˜¯ä¸€äº›å¸¦æœ‰ â€œå†…éƒ¨èµ„æ–™â€ã€â€è‰ç¨¿â€ ç­‰å­—æ ·çš„æ°´å°ï¼Œåœ¨æ­£å¼åœºåˆä½¿ç”¨æ—¶éœ€è¦å»é™¤ã€‚\nç†æƒ³çš„ PDF æ°´å°å»é™¤å·¥å…·åº”å…·å¤‡ä»¥ä¸‹åŠŸèƒ½ï¼š\n\nç²¾å‡†è¯†åˆ«å¹¶å»é™¤å„ç±»å¯è§æ°´å°\n\nä¿ç•™åŸæ–‡æ¡£çš„æ–‡æœ¬æ ¼å¼å’Œå›¾ç‰‡å†…å®¹\n\næ”¯æŒæ‰¹é‡å¤„ç†å¤šä¸ª PDF æ–‡ä»¶\n\næä¾›ç›´è§‚æ˜“ç”¨çš„å›¾å½¢ç•Œé¢\n\nè¾“å‡ºæ ¼å¼æ”¯æŒ Wordï¼Œæ–¹ä¾¿åç»­ç¼–è¾‘\n\n\nåŸºç¡€ç‰ˆæœ¬ï¼šå®ç°å•æ–‡ä»¶æ°´å°å»é™¤åŠŸèƒ½\næˆ‘ä»¬å…ˆä»åŸºç¡€ç‰ˆæœ¬å¼€å§‹ï¼Œæ­å»ºä¸€ä¸ªèƒ½å¤Ÿå¤„ç†å•ä¸ª PDF æ–‡ä»¶çš„æ°´å°å»é™¤å·¥å…·ã€‚è¿™ä¸ªç‰ˆæœ¬å°†å®ç°æ°´å°è¯†åˆ«ã€å†…å®¹æå–å’Œæ ¼å¼è½¬æ¢çš„æ ¸å¿ƒåŠŸèƒ½ã€‚\næ ¸å¿ƒæŠ€æœ¯é€‰å‹&#xA;å®ç° PDF æ°´å°å»é™¤éœ€è¦ç”¨åˆ°ä»¥ä¸‹å…³é”®åº“ï¼š\n\nfitzï¼ˆPyMuPDFï¼‰ï¼šç”¨äº PDF æ–‡ä»¶çš„è§£æå’Œå†…å®¹æå–\n\npython-docxï¼šç”¨äºç”Ÿæˆ Word æ ¼å¼çš„è¾“å‡ºæ–‡ä»¶\n\nPILï¼ˆPillowï¼‰ï¼šç”¨äºå¤„ç† PDF ä¸­çš„å›¾ç‰‡å†…å®¹\n\nPyQt5ï¼šç”¨äºæ„å»ºå›¾å½¢ç”¨æˆ·ç•Œé¢\n\n\næ ¸å¿ƒåŠŸèƒ½å®ç°&#xA;åŸºç¡€ç‰ˆæœ¬çš„æ ¸å¿ƒåŠŸèƒ½ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ¨¡å—ï¼šPDF ä¿¡æ¯æå–ã€æ°´å°è¯†åˆ«ä¸å»é™¤ã€Word æ–‡æ¡£ç”Ÿæˆã€‚\nPDF ä¿¡æ¯æå–æ¨¡å—&#xA;extract_full_pdf_infoå‡½æ•°è´Ÿè´£ä» PDF ä¸­æå–æ–‡æœ¬å†…å®¹ã€å›¾ç‰‡å’Œæ ¼å¼ä¿¡æ¯ï¼š\ndef extract_full_pdf_info(pdf_path: str) -&gt; List[Dict[str, Any]]:    if not os.path.exists(pdf_path):        raise FileNotFoundError(f&quot;PDFæ–‡ä»¶æœªæ‰¾åˆ°: &#123;pdf_path&#125;&quot;)    doc = fitz.open(pdf_path)    full_info = []    temp_image_dir = os.path.abspath(&quot;temp_pdf_images&quot;)    os.makedirs(temp_image_dir, exist_ok=True)    for page_num in range(len(doc)):        page = doc[page_num]        page_data = &#123;            &quot;page_number&quot;: page_num + 1,            &quot;page_size&quot;: &#123;&quot;width&quot;: page.rect.width, &quot;height&quot;: page.rect.height&#125;,            &quot;rotation&quot;: page.rotation,            &quot;text_content&quot;: [],            &quot;images&quot;: []        &#125;        # æå–æ–‡æœ¬å†…å®¹        text_blocks = page.get_text(&quot;dict&quot;)[&quot;blocks&quot;]        for block in text_blocks:            if block[&quot;type&quot;] == 0:  # æ–‡æœ¬å—                # å¤„ç†æ–‡æœ¬å—ã€è¡Œå’Œæ–‡å­—ç‰‡æ®µ...        # æå–å›¾ç‰‡        images = page.get_images(full=True)        # å¤„ç†å›¾ç‰‡æå–ã€è½¯æ©ç åˆå¹¶å’Œæ ¼å¼è½¬æ¢...        full_info.append(page_data)    doc.close()    return full_info\næ°´å°è¯†åˆ«ä¸å»é™¤æ¨¡å—&#xA;remove_watermark_by_alphaå‡½æ•°é€šè¿‡åˆ†ææ–‡æœ¬çš„é€æ˜åº¦ã€å­—ä½“å¤§å°å’Œé¢œè‰²æ¥è¯†åˆ«å¹¶å»é™¤æ°´å°ï¼š\ndef remove_watermark_by_alpha(full_info: List[Dict[str, Any]]) -&gt; List[Dict[str, Any]]:    clean_full_info = []    watermark_removed_count = 0    ALPHA_THRESHOLD = 150  # é€æ˜åº¦é˜ˆå€¼    TARGET_FONT_SIZE = 18  # æ°´å°å­—ä½“å¤§å°    FONT_SIZE_TOLERANCE = 1  # å­—ä½“å¤§å°å®¹å·®    TARGET_COLOR_INT_VALUE = 13882323  # æ°´å°é¢œè‰²å€¼    for page in full_info:        clean_text_blocks = []        for text_block in page[&quot;text_content&quot;]:            # å¤„ç†æ–‡æœ¬å—ï¼Œè¿‡æ»¤æ°´å°å†…å®¹...            watermark_removed_count += 1  # ç»Ÿè®¡å»é™¤çš„æ°´å°æ•°é‡        clean_page = &#123;**page, &quot;text_content&quot;: clean_text_blocks, &quot;images&quot;: page[&quot;images&quot;]&#125;        clean_full_info.append(clean_page)    print(f&quot;æ°´å°ç§»é™¤å®Œæˆã€‚å…±ç§»é™¤ &#123;watermark_removed_count&#125; å¤„æ°´å°æ–‡æœ¬ã€‚&quot;)    return clean_full_info\nWord æ–‡æ¡£ç”Ÿæˆæ¨¡å—&#xA;generate_word_from_dataå‡½æ•°å°†æ¸…ç†åçš„å†…å®¹è½¬æ¢ä¸º Word æ–‡æ¡£ï¼š\ndef generate_word_from_data(clean_info: List[Dict[str, Any]], output_word_path: str) -&gt; None:    doc = Document()    font_mapping = get_system_font_mapping()  # å­—ä½“æ˜ å°„è¡¨    # æ”¶é›†å¹¶æ’åºæ–‡æœ¬å’Œå›¾ç‰‡å…ƒç´ ...    # ç”ŸæˆWordå†…å®¹ï¼Œä¿ç•™åŸæ ¼å¼...    try:        doc.save(output_word_path)        print(f&quot;Wordæ–‡æ¡£å·²ä¿å­˜è‡³ï¼š&#123;output_word_path&#125;&quot;)    except Exception as e:       print(f&quot;ä¿å­˜Wordæ–‡æ¡£å¤±è´¥ï¼š&#123;e&#125;&quot;)\nåŸºç¡€ç‰ˆæœ¬ç•Œé¢è®¾è®¡&#xA;åŸºç¡€ç‰ˆæœ¬é‡‡ç”¨ç®€æ´çš„å›¾å½¢ç•Œé¢ï¼Œä¸»è¦åŒ…å«æ–‡ä»¶é€‰æ‹©ã€å¤„ç†å’ŒçŠ¶æ€æ˜¾ç¤ºåŠŸèƒ½ï¼š\nclass PdfWatermarkRemoverApp(QWidget):    def __init__(self):        super().__init__()        self.setWindowTitle(&quot;PDFæ°´å°ç§»é™¤å·¥å…·&quot;)        self.setFixedSize(750, 400)        self.init_ui()        # åˆå§‹åŒ–å…¶ä»–å±æ€§...    def init_ui(self):        main_layout = QVBoxLayout()        # è®¾ç½®å¸ƒå±€ã€æ·»åŠ æ–‡ä»¶é€‰æ‹©æ¡†ã€å¤„ç†æŒ‰é’®å’ŒçŠ¶æ€æ ‡ç­¾...    def browse_pdf_file(self):        # æ‰“å¼€æ–‡ä»¶å¯¹è¯æ¡†ï¼Œé€‰æ‹©PDFæ–‡ä»¶...    def start_processing(self):        # å¼€å§‹å¤„ç†PDFæ–‡ä»¶...\nä¼˜åŒ–ç‰ˆæœ¬ï¼šåŠŸèƒ½å¢å¼ºä¸ä½“éªŒæå‡\nåœ¨åŸºç¡€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥ä¼˜åŒ–åŠŸèƒ½ï¼Œå¢åŠ æ‰¹é‡å¤„ç†èƒ½åŠ›ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼Œæ‰“é€ ä¸€ä¸ªæ›´å®ç”¨çš„å·¥å…·ã€‚\næ ¸å¿ƒåŠŸèƒ½æ”¹è¿›&#xA;ä¼˜åŒ–ç‰ˆæœ¬ä¸»è¦åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œäº†æ”¹è¿›ï¼š\n1. å¢åŠ æ–‡ä»¶å¤¹æ‰¹é‡å¤„ç†åŠŸèƒ½&#xA;ç”¨æˆ·å¯ä»¥é€‰æ‹©æ•´ä¸ªæ–‡ä»¶å¤¹è¿›è¡Œæ‰¹é‡å¤„ç†ï¼Œå·¥å…·ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶å¤„ç†æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰ PDF æ–‡ä»¶ï¼š\ndef browse_folder(self):    folder_path = QFileDialog.getExistingDirectory(self, &quot;é€‰æ‹©åŒ…å« PDF æ–‡ä»¶çš„æ–‡ä»¶å¤¹&quot;)    if folder_path:        self.processing_queue = []        # éå†æ–‡ä»¶å¤¹ï¼Œæ”¶é›†æ‰€æœ‰PDFæ–‡ä»¶...        self.total_files_to_process = len(self.processing_queue)        self.processing_mode = &quot;folder&quot;       # æ›´æ–°ç•Œé¢æ˜¾ç¤º...\n\n2. æ”¹è¿›çš„æ–‡ä»¶å¤„ç†æµç¨‹&#xA;å¼•å…¥å¤„ç†é˜Ÿåˆ—å’Œå·¥ä½œçº¿ç¨‹ï¼Œæ”¯æŒè¿ç»­å¤„ç†å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶æ˜¾ç¤ºå®æ—¶è¿›åº¦ï¼š\ndef process_next_file(self):    if not self.processing_queue:        self.on_all_processing_finished()  # æ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆ        return    current_pdf_path = self.processing_queue.pop(0)    # ç¡®å®šè¾“å‡ºè·¯å¾„...    # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨ï¼Œå¤„ç†è¦†ç›–é€»è¾‘...    self.processed_count += 1   self.status_label.setText(f&quot;æ­£åœ¨å¤„ç†ç¬¬ &#123;self.processed_count&#125; / &#123;self.total_files_to_process&#125; ä¸ªæ–‡ä»¶...&quot;)    # å¯åŠ¨å·¥ä½œçº¿ç¨‹å¤„ç†å½“å‰æ–‡ä»¶...\n3. å¢å¼ºçš„å›¾ç‰‡å¤„ç†èƒ½åŠ›&#xA;ä¼˜åŒ–å›¾ç‰‡æå–å’Œè½¬æ¢é€»è¾‘ï¼Œæ›´å¥½åœ°ä¿ç•™å›¾ç‰‡è´¨é‡å’Œé€æ˜åº¦ï¼š\ndef convert_image_format(temp_path, target_format=&#x27;png&#x27;):    try:        with Image.open(temp_path) as img:            original_mode = img.mode            new_path = os.path.splitext(temp_path)[0] + f&#x27;.&#123;target_format&#125;&#x27;            if &#x27;A&#x27; in original_mode:  # å¤„ç†é€æ˜å›¾ç‰‡                if original_mode != &#x27;RGBA&#x27;:                    img = img.convert(&#x27;RGBA&#x27;)               img.save(new_path, format=target_format.upper())               # è¾“å‡ºè½¬æ¢ä¿¡æ¯...           else:               # å¤„ç†éé€æ˜å›¾ç‰‡...           return new_path   except Exception as e:       # å¤„ç†è½¬æ¢é”™è¯¯...\n\n4. æ›´æ™ºèƒ½çš„æ–‡æœ¬æ ¼å¼å¤„ç†&#xA;ä¼˜åŒ–æ–‡æœ¬æ’ç‰ˆé€»è¾‘ï¼Œè‡ªåŠ¨è¯†åˆ«æ ‡é¢˜ã€æ®µè½ï¼Œä¿æŒåŸæ–‡æ¡£çš„æ ¼å¼é£æ ¼ï¼š\n# åˆ†ææœ€å¸¸è§çš„å­—ä½“å¤§å°ä½œä¸ºæ­£æ–‡å­—ä½“if all_font_sizes:   from collections import Counter   most_common_size = Counter(all_font_sizes).most_common(1)[0][0]   print(f&quot;åˆ†æå¾—å‡ºæ­£æ–‡å­—ä½“å¤§å°: &#123;most_common_size&#125;&quot;)   title_font_threshold = most_common_size * 1.2  # æ ‡é¢˜å­—ä½“é˜ˆå€¼else:   # ä½¿ç”¨é»˜è®¤å€¼...\n\nç•Œé¢ä¸äº¤äº’ä¼˜åŒ–&#xA;ä¼˜åŒ–ç‰ˆæœ¬çš„ç•Œé¢æ›´åŠ å‹å¥½ï¼Œäº¤äº’æ›´åŠ æµç•…ï¼š\n1. ç›´è§‚çš„æ–‡ä»¶é€‰æ‹©ç•Œé¢&#xA;æä¾›æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ä¸¤ç§é€‰æ‹©æ–¹å¼ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ï¼š\n# é€‰æ‹©æ–‡ä»¶æŒ‰é’®self.browse_files_button = QPushButton(&quot;é€‰æ‹©æ–‡ä»¶...&quot;)self.browse_files_button.clicked.connect(self.browse_pdf_files)# é€‰æ‹©æ–‡ä»¶å¤¹æŒ‰é’®self.browse_folder_button = QPushButton(&quot;é€‰æ‹©æ–‡ä»¶å¤¹...&quot;)self.browse_folder_button.clicked.connect(self.browse_folder)\n\n2. å®æ—¶è¿›åº¦æ˜¾ç¤º&#xA;æ¸…æ™°å±•ç¤ºå½“å‰å¤„ç†è¿›åº¦å’ŒçŠ¶æ€ï¼Œè®©ç”¨æˆ·äº†è§£å¤„ç†æƒ…å†µï¼š\nself.status_label = QLabel(&quot;ç­‰å¾…é€‰æ‹©æ–‡ä»¶/æ–‡ä»¶å¤¹...&quot;)self.current_file_status_label = QLabel(&quot;&quot;)  # æ˜¾ç¤ºå½“å‰å¤„ç†çš„æ–‡ä»¶å\n\n3. æ–‡ä»¶è¦†ç›–ç­–ç•¥é€‰æ‹©&#xA;å½“è¾“å‡ºæ–‡ä»¶å·²å­˜åœ¨æ—¶ï¼Œæä¾›çµæ´»çš„è¦†ç›–é€‰é¡¹ï¼š\n# è¦†ç›–æ‰€æœ‰æ–‡ä»¶å¤é€‰æ¡†self.overwrite_all_checkbox = QCheckBox(&quot;å¯¹å½“å‰æ‰¹æ¬¡çš„æ‰€æœ‰å†²çªæ–‡ä»¶æ‰§è¡Œæ­¤æ“ä½œ&quot;)self.overwrite_all_checkbox.setVisible(False)  # é»˜è®¤éšè—\n\nå·¥å…·ä½¿ç”¨æŒ‡å—\nä½¿ç”¨ä¼˜åŒ–åçš„ PDF æ°´å°å»é™¤å·¥å…·éå¸¸ç®€å•ï¼Œåªéœ€å‡ ä¸ªæ­¥éª¤å³å¯å®Œæˆæ°´å°å»é™¤ï¼š\n\né€‰æ‹©æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼šç‚¹å‡» â€œé€‰æ‹©æ–‡ä»¶â€ æŒ‰é’®å¤„ç†å•ä¸ª PDFï¼Œæˆ–ç‚¹å‡» â€œé€‰æ‹©æ–‡ä»¶å¤¹â€ æŒ‰é’®æ‰¹é‡å¤„ç†å¤šä¸ª PDFã€‚\n\nå¼€å§‹å¤„ç†ï¼šç‚¹å‡» â€œå¼€å§‹å¤„ç†â€ æŒ‰é’®ï¼Œå·¥å…·å°†è‡ªåŠ¨å»é™¤æ°´å°å¹¶è½¬æ¢ä¸º Word æ ¼å¼ã€‚\n\næŸ¥çœ‹ç»“æœï¼šå¤„ç†å®Œæˆåï¼Œå·¥å…·ä¼šæ˜¾ç¤ºæˆåŠŸå’Œå¤±è´¥çš„æ–‡ä»¶ç»Ÿè®¡ï¼Œç»“æœæ–‡ä»¶å°†ä¿å­˜åœ¨æºæ–‡ä»¶æ‰€åœ¨ç›®å½•çš„ â€œ_æ— æ°´å°â€ å­æ–‡ä»¶å¤¹ä¸­ã€‚\n\n\nå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ\nåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¸¸è§é—®é¢˜ï¼Œä»¥ä¸‹æ˜¯è§£å†³æ–¹æ¡ˆï¼š\n\næ°´å°å»é™¤ä¸å½»åº•ï¼šå¯èƒ½æ˜¯æ°´å°ç‰¹å¾å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥è°ƒæ•´ remove_watermark_by_alpha å‡½æ•°ä¸­çš„é˜ˆå€¼å‚æ•°ã€‚\n\nå›¾ç‰‡æ˜¾ç¤ºå¼‚å¸¸ï¼šéƒ¨åˆ†ç‰¹æ®Šæ ¼å¼çš„å›¾ç‰‡å¯èƒ½è½¬æ¢å¤±è´¥ï¼Œå¯ä»¥å°è¯•æ›´æ–° Pillow åº“åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚\n\næ ¼å¼é”™ä¹±ï¼šå¤æ‚æ’ç‰ˆçš„ PDF è½¬æ¢åå¯èƒ½å‡ºç°æ ¼å¼é—®é¢˜ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒæ•´ Word æ–‡æ¡£çš„æ ·å¼ã€‚\n\nå¤„ç†é€Ÿåº¦æ…¢ï¼šå¤§å‹ PDF æ–‡ä»¶å¤„ç†éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…ï¼Œå·¥å…·æ­£åœ¨åå°å·¥ä½œã€‚\n\n\næ€»ç»“ä¸å±•æœ›\né€šè¿‡æœ¬æ–‡ä»‹ç»çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æˆåŠŸæ„å»ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ PDF æ°´å°å»é™¤å·¥å…·ï¼Œå®ç°äº†ä»å•æ–‡ä»¶å¤„ç†åˆ°æ‰¹é‡è½¬æ¢çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚è¯¥å·¥å…·èƒ½å¤Ÿç²¾å‡†å»é™¤æ°´å°ï¼Œä¿ç•™åŸæ–‡æ¡£çš„æ–‡æœ¬æ ¼å¼å’Œå›¾ç‰‡å†…å®¹ï¼Œå¤§å¤§æé«˜äº†æ–‡æ¡£å¤„ç†æ•ˆç‡ã€‚\næœªæ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›ä¸€æ­¥ä¼˜åŒ–è¿™ä¸ªå·¥å…·ï¼š\n\nå¢åŠ å¯¹æ›´å¤šæ°´å°ç±»å‹çš„æ”¯æŒï¼Œå¦‚å›¾ç‰‡æ°´å°ã€å€¾æ–œæ–‡å­—æ°´å°ç­‰\n\nä¼˜åŒ– OCR åŠŸèƒ½ï¼Œæé«˜æ‰«æç‰ˆ PDF çš„å¤„ç†æ•ˆæœ\n\nå¢åŠ è‡ªå®šä¹‰æ°´å°è§„åˆ™çš„åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·æ‰‹åŠ¨æ ‡è®°æ°´å°ç‰¹å¾\n\næ”¯æŒæ›´å¤šè¾“å‡ºæ ¼å¼ï¼Œå¦‚ Markdownã€HTML ç­‰\n\nå¼€å‘äº‘åŒæ­¥åŠŸèƒ½ï¼Œå®ç°è·¨è®¾å¤‡ä½¿ç”¨\n\n\nå®Œæ•´ä»£ç å®ç°\nä»¥ä¸‹æ˜¯å®Œæ•´çš„ PDF æ°´å°å»é™¤å·¥å…·ä»£ç ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½æ¨¡å—å’Œç•Œé¢å®ç°ï¼š\nimport osimport sysimport tempfilefrom typing import List, Dict, Any, Tuple, Optionalfrom collections import Counterfrom PyQt5.QtWidgets import (QApplication, QWidget, QVBoxLayout, QHBoxLayout,                          QPushButton, QLabel, QFileDialog, QProgressBar,                          QMessageBox, QCheckBox, QFrame)from PyQt5.QtCore import Qt, QThread, pyqtSignalfrom PyQt5.QtGui import QFontimport fitz  # PyMuPDFfrom docx import Documentfrom docx.shared import Pt, Inchesfrom docx.oxml.ns import qnfrom docx.enum.text import WD_ALIGN_PARAGRAPHfrom PIL import Image# å…¨å±€ä¸´æ—¶ç›®å½•ï¼Œç”¨äºå­˜å‚¨æå–çš„å›¾ç‰‡GLOBAL_TEMP_DIR = os.path.join(tempfile.gettempdir(), &quot;pdf_watermark_remover&quot;)os.makedirs(GLOBAL_TEMP_DIR, exist_ok=True)class PDFProcessor:   &quot;&quot;&quot;PDFå¤„ç†æ ¸å¿ƒç±»ï¼Œè´Ÿè´£æå–å†…å®¹ã€å»é™¤æ°´å°å’Œç”ŸæˆWordæ–‡æ¡£&quot;&quot;&quot;   @staticmethod   def extract_full_pdf_info(pdf_path: str) -&gt; List[Dict[str, Any]]:       &quot;&quot;&quot;æå–PDFä¸­çš„æ–‡æœ¬ã€å›¾ç‰‡å’Œæ ¼å¼ä¿¡æ¯&quot;&quot;&quot;       if not os.path.exists(pdf_path):           raise FileNotFoundError(f&quot;PDFæ–‡ä»¶æœªæ‰¾åˆ°: &#123;pdf_path&#125;&quot;)       doc = fitz.open(pdf_path)       full_info = []       temp_image_dir = os.path.join(GLOBAL_TEMP_DIR, os.path.basename(pdf_path).replace(&#x27;.pdf&#x27;, &#x27;&#x27;))       os.makedirs(temp_image_dir, exist_ok=True)       for page_num in range(len(doc)):           page = doc[page_num]           page_data = &#123;               &quot;page_number&quot;: page_num + 1,               &quot;page_size&quot;: &#123;&quot;width&quot;: page.rect.width, &quot;height&quot;: page.rect.height&#125;,               &quot;rotation&quot;: page.rotation,               &quot;text_content&quot;: [],               &quot;images&quot;: []           &#125;           # æå–æ–‡æœ¬å†…å®¹           text_blocks = page.get_text(&quot;dict&quot;)[&quot;blocks&quot;]           for block in text_blocks:               if block[&quot;type&quot;] == 0:  # æ–‡æœ¬å—                   text_block_data = &#123;                       &quot;bbox&quot;: block[&quot;bbox&quot;],                       &quot;lines&quot;: []                   &#125;                   for line in block[&quot;lines&quot;]:                       line_data = &#123;                           &quot;spans&quot;: [],                           &quot;bbox&quot;: line[&quot;bbox&quot;]                       &#125;                       for span in line[&quot;spans&quot;]:                           span_data = &#123;                               &quot;text&quot;: span[&quot;text&quot;],                               &quot;font&quot;: span[&quot;font&quot;],                               &quot;size&quot;: span[&quot;size&quot;],                               &quot;color&quot;: span[&quot;color&quot;],                               &quot;flags&quot;: span[&quot;flags&quot;],                               &quot;bbox&quot;: span[&quot;bbox&quot;]                           &#125;                           line_data[&quot;spans&quot;].append(span_data)                       text_block_data[&quot;lines&quot;].append(line_data)                   page_data[&quot;text_content&quot;].append(text_block_data)           # æå–å›¾ç‰‡           images = page.get_images(full=True)           for img_index, img in enumerate(images):               xref = img[0]               base_image = doc.extract_image(xref)               image_bytes = base_image[&quot;image&quot;]               image_ext = base_image[&quot;ext&quot;]               image_width = base_image[&quot;width&quot;]               image_height = base_image[&quot;height&quot;]               # æ„å»ºå›¾ç‰‡è·¯å¾„               img_filename = f&quot;page_&#123;page_num+1&#125;_img_&#123;img_index&#125;.&#123;image_ext&#125;&quot;               img_path = os.path.join(temp_image_dir, img_filename)               # ä¿å­˜å›¾ç‰‡               with open(img_path, &quot;wb&quot;) as f:                   f.write(image_bytes)               # å¤„ç†è½¯æ©ç ï¼ˆé€æ˜åº¦ï¼‰               if base_image[&quot;smask&quot;]:                   smask_image = doc.extract_image(base_image[&quot;smask&quot;])                   smask_bytes = smask_image[&quot;image&quot;]                   smask_path = os.path.join(temp_image_dir, f&quot;page_&#123;page_num+1&#125;_img_&#123;img_index&#125;_mask.&#123;image_ext&#125;&quot;)                   with open(smask_path, &quot;wb&quot;) as f:                       f.write(smask_bytes)                   # åˆå¹¶å›¾ç‰‡å’Œæ©ç                    img_path = PDFProcessor.merge_image_with_mask(img_path, smask_path)                   os.remove(smask_path)  # æ¸…ç†ä¸´æ—¶æ©ç æ–‡ä»¶               # è½¬æ¢å›¾ç‰‡æ ¼å¼ä¸ºPNGä»¥ç¡®ä¿å…¼å®¹æ€§               if image_ext.lower() != &#x27;png&#x27;:                   img_path = PDFProcessor.convert_image_format(img_path, &#x27;png&#x27;)               # è·å–å›¾ç‰‡åœ¨é¡µé¢ä¸­çš„ä½ç½®               img_rect = page.get_image_rects(xref)[0]               page_data[&quot;images&quot;].append(&#123;                   &quot;path&quot;: img_path,                   &quot;ext&quot;: image_ext,                   &quot;width&quot;: image_width,                   &quot;height&quot;: image_height,                   &quot;rect&quot;: img_rect,                   &quot;index&quot;: img_index               &#125;)           full_info.append(page_data)       doc.close()       return full_info   @staticmethod   def merge_image_with_mask(image_path: str, mask_path: str) -&gt; str:       &quot;&quot;&quot;åˆå¹¶å›¾ç‰‡å’Œæ©ç ä»¥ä¿ç•™é€æ˜åº¦&quot;&quot;&quot;       try:           with Image.open(image_path) as img, Image.open(mask_path) as mask:               # ç¡®ä¿å›¾ç‰‡å’Œæ©ç å°ºå¯¸ä¸€è‡´               if img.size != mask.size:                   mask = mask.resize(img.size)               # åˆå¹¶å›¾ç‰‡å’Œæ©ç                img.putalpha(mask)               new_path = os.path.splitext(image_path)[0] + &#x27;_merged.png&#x27;               img.save(new_path, &#x27;PNG&#x27;)               os.remove(image_path)  # ç§»é™¤åŸå§‹å›¾ç‰‡               return new_path       except Exception as e:           print(f&quot;åˆå¹¶å›¾ç‰‡å’Œæ©ç å¤±è´¥: &#123;e&#125;&quot;)           return image_path  # å¤±è´¥æ—¶è¿”å›åŸå§‹å›¾ç‰‡è·¯å¾„   @staticmethod   def convert_image_format(temp_path: str, target_format: str = &#x27;png&#x27;) -&gt; str:       &quot;&quot;&quot;è½¬æ¢å›¾ç‰‡æ ¼å¼&quot;&quot;&quot;       try:           with Image.open(temp_path) as img:               original_mode = img.mode               new_path = os.path.splitext(temp_path)[0] + f&#x27;.&#123;target_format&#125;&#x27;               # å¤„ç†é€æ˜å›¾ç‰‡               if &#x27;A&#x27; in original_mode:                   if original_mode != &#x27;RGBA&#x27;:                       img = img.convert(&#x27;RGBA&#x27;)                   img.save(new_path, format=target_format.upper())               else:                   # éé€æ˜å›¾ç‰‡ç›´æ¥è½¬æ¢                   img.save(new_path, format=target_format.upper())               os.remove(temp_path)  # ç§»é™¤åŸå§‹æ ¼å¼å›¾ç‰‡               return new_path       except Exception as e:           print(f&quot;è½¬æ¢å›¾ç‰‡æ ¼å¼å¤±è´¥: &#123;e&#125;&quot;)           return temp_path  # å¤±è´¥æ—¶è¿”å›åŸå§‹è·¯å¾„   @staticmethod   def remove_watermark_by_alpha(full_info: List[Dict[str, Any]]) -&gt; List[Dict[str, Any]]:       &quot;&quot;&quot;é€šè¿‡é€æ˜åº¦ã€å­—ä½“å¤§å°å’Œé¢œè‰²è¯†åˆ«å¹¶å»é™¤æ°´å°&quot;&quot;&quot;       clean_full_info = []       watermark_removed_count = 0       # æ°´å°ç‰¹å¾å‚æ•°       ALPHA_THRESHOLD = 150  # é€æ˜åº¦é˜ˆå€¼       TARGET_FONT_SIZE = 18  # æ°´å°å­—ä½“å¤§å°       FONT_SIZE_TOLERANCE = 1  # å­—ä½“å¤§å°å®¹å·®       TARGET_COLOR_INT_VALUE = 13882323  # æ°´å°é¢œè‰²å€¼       for page in full_info:           clean_text_blocks = []           for text_block in page[&quot;text_content&quot;]:               clean_lines = []               for line in text_block[&quot;lines&quot;]:                   clean_spans = []                   for span in line[&quot;spans&quot;]:                       # æ£€æŸ¥æ˜¯å¦ä¸ºæ°´å°æ–‡æœ¬                       is_watermark = False                       # æ£€æŸ¥å­—ä½“å¤§å°                       size_diff = abs(span[&quot;size&quot;] - TARGET_FONT_SIZE)                       if size_diff &lt;= FONT_SIZE_TOLERANCE:                           # æ£€æŸ¥é¢œè‰²                           if span[&quot;color&quot;] == TARGET_COLOR_INT_VALUE:                               # æ£€æŸ¥é€æ˜åº¦ï¼ˆé€šè¿‡flagsåˆ¤æ–­ï¼‰                               # flagsçš„ç¬¬3ä½è¡¨ç¤ºé€æ˜åº¦                               if (span[&quot;flags&quot;] &amp; 0b100) != 0:                                   is_watermark = True                       if not is_watermark:                           clean_spans.append(span)                       else:                           watermark_removed_count += 1                   if clean_spans:  # åªä¿ç•™æœ‰å†…å®¹çš„è¡Œ                       clean_line = &#123;**line, &quot;spans&quot;: clean_spans&#125;                       clean_lines.append(clean_line)               if clean_lines:  # åªä¿ç•™æœ‰å†…å®¹çš„æ–‡æœ¬å—                   clean_block = &#123;** text_block, &quot;lines&quot;: clean_lines&#125;                   clean_text_blocks.append(clean_block)           # ä¿ç•™å›¾ç‰‡ä¿¡æ¯           clean_page = &#123;**page, &quot;text_content&quot;: clean_text_blocks, &quot;images&quot;: page[&quot;images&quot;]&#125;           clean_full_info.append(clean_page)       print(f&quot;æ°´å°ç§»é™¤å®Œæˆã€‚å…±ç§»é™¤ &#123;watermark_removed_count&#125; å¤„æ°´å°æ–‡æœ¬ã€‚&quot;)       return clean_full_info   @staticmethod   def get_system_font_mapping() -&gt; Dict[str, str]:       &quot;&quot;&quot;è·å–ç³»ç»Ÿå­—ä½“æ˜ å°„è¡¨ï¼Œç”¨äºPDFåˆ°Wordçš„å­—ä½“è½¬æ¢&quot;&quot;&quot;       return &#123;           &quot;SimSun&quot;: &quot;å®‹ä½“&quot;,           &quot;SimHei&quot;: &quot;é»‘ä½“&quot;,           &quot;Microsoft YaHei&quot;: &quot;å¾®è½¯é›…é»‘&quot;,           &quot;KaiTi&quot;: &quot;æ¥·ä½“&quot;,           &quot;FangSong&quot;: &quot;ä»¿å®‹&quot;,           &quot;Arial&quot;: &quot;Arial&quot;,           &quot;Times New Roman&quot;: &quot;Times New Roman&quot;,           # å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ›´å¤šå­—ä½“æ˜ å°„       &#125;   @staticmethod   def generate_word_from_data(clean_info: List[Dict[str, Any]], output_word_path: str) -&gt; None:       &quot;&quot;&quot;ä»æ¸…ç†åçš„PDFä¿¡æ¯ç”ŸæˆWordæ–‡æ¡£&quot;&quot;&quot;       doc = Document()       font_mapping = PDFProcessor.get_system_font_mapping()       # æ”¶é›†æ‰€æœ‰å­—ä½“å¤§å°ç”¨äºåˆ†æ       all_font_sizes = []       for page in clean_info:           for block in page[&quot;text_content&quot;]:               for line in block[&quot;lines&quot;]:                   for span in line[&quot;spans&quot;]:                       all_font_sizes.append(span[&quot;size&quot;])       # åˆ†ææœ€å¸¸è§çš„å­—ä½“å¤§å°ä½œä¸ºæ­£æ–‡å­—ä½“       if all_font_sizes:           most_common_size = Counter(all_font_sizes).most_common(1)[0][0]           print(f&quot;åˆ†æå¾—å‡ºæ­£æ–‡å­—ä½“å¤§å°: &#123;most_common_size&#125;&quot;)           title_font_threshold = most_common_size * 1.2  # æ ‡é¢˜å­—ä½“é˜ˆå€¼       else:           most_common_size = 12  # é»˜è®¤æ­£æ–‡å­—ä½“å¤§å°           title_font_threshold = 14  # é»˜è®¤æ ‡é¢˜å­—ä½“é˜ˆå€¼       # å¤„ç†æ¯ä¸€é¡µå†…å®¹       for page in clean_info:           # ä¸ºæ–°é¡µé¢æ·»åŠ åˆ†é¡µç¬¦ï¼ˆç¬¬ä¸€é¡µé™¤å¤–ï¼‰           if page[&quot;page_number&quot;] &gt; 1:               doc.add_page_break()           # æ·»åŠ é¡µç            page_paragraph = doc.add_paragraph()           page_run = page_paragraph.add_run(f&quot;ç¬¬ &#123;page[&#x27;page_number&#x27;]&#125; é¡µ&quot;)           page_run.font.size = Pt(9)           page_paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER           # æ”¶é›†é¡µé¢ä¸Šçš„æ‰€æœ‰å…ƒç´ ï¼ˆæ–‡æœ¬å—å’Œå›¾ç‰‡ï¼‰å¹¶æŒ‰ä½ç½®æ’åº           page_elements = []           # æ·»åŠ æ–‡æœ¬å—           for block in page[&quot;text_content&quot;]:               # ä½¿ç”¨æ–‡æœ¬å—çš„è¾¹ç•Œæ¡†é¡¶éƒ¨ä½œä¸ºæ’åºä¾æ®               block_top = block[&quot;bbox&quot;][1]               page_elements.append(&#123;                   &quot;type&quot;: &quot;text&quot;,                   &quot;top&quot;: block_top,                   &quot;data&quot;: block               &#125;)           # æ·»åŠ å›¾ç‰‡           for img in page[&quot;images&quot;]:               # ä½¿ç”¨å›¾ç‰‡çš„é¡¶éƒ¨ä½ç½®ä½œä¸ºæ’åºä¾æ®               img_top = img[&quot;rect&quot;][1]               page_elements.append(&#123;                   &quot;type&quot;: &quot;image&quot;,                   &quot;top&quot;: img_top,                   &quot;data&quot;: img               &#125;)           # æŒ‰å…ƒç´ åœ¨é¡µé¢ä¸­çš„å‚ç›´ä½ç½®æ’åº           page_elements.sort(key=lambda x: x[&quot;top&quot;])           # å¤„ç†æ’åºåçš„å…ƒç´            for element in page_elements:               if element[&quot;type&quot;] == &quot;text&quot;:                   PDFProcessor._add_text_block_to_doc(doc, element[&quot;data&quot;], font_mapping,                                                     title_font_threshold, most_common_size)               elif element[&quot;type&quot;] == &quot;image&quot;:                   PDFProcessor._add_image_to_doc(doc, element[&quot;data&quot;])       # ä¿å­˜ç”Ÿæˆçš„Wordæ–‡æ¡£       try:           # ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨           output_dir = os.path.dirname(output_word_path)           os.makedirs(output_dir, exist_ok=True)           doc.save(output_word_path)           print(f&quot;Wordæ–‡æ¡£å·²ä¿å­˜è‡³ï¼š&#123;output_word_path&#125;&quot;)       except Exception as e:           print(f&quot;ä¿å­˜Wordæ–‡æ¡£å¤±è´¥ï¼š&#123;e&#125;&quot;)           raise   @staticmethod   def _add_text_block_to_doc(doc, text_block, font_mapping, title_threshold, normal_size):       &quot;&quot;&quot;å°†æ–‡æœ¬å—æ·»åŠ åˆ°Wordæ–‡æ¡£&quot;&quot;&quot;       for line in text_block[&quot;lines&quot;]:           paragraph = doc.add_paragraph()           for span in line[&quot;spans&quot;]:               run = paragraph.add_run(span[&quot;text&quot;])               # è®¾ç½®å­—ä½“               font_name = span[&quot;font&quot;]               # æ˜ å°„åˆ°ç³»ç»Ÿå¯ç”¨å­—ä½“               mapped_font = font_mapping.get(font_name, font_name)               try:                   run.font.name = mapped_font                   # è®¾ç½®ä¸­æ–‡å­—ä½“                   run._element.rPr.rFonts.set(qn(&#x27;w:eastAsia&#x27;), mapped_font)               except Exception as e:                   print(f&quot;è®¾ç½®å­—ä½“ &#123;mapped_font&#125; å¤±è´¥: &#123;e&#125;&quot;)                   run.font.name = &quot;å®‹ä½“&quot;                   run._element.rPr.rFonts.set(qn(&#x27;w:eastAsia&#x27;), &quot;å®‹ä½“&quot;)               # è®¾ç½®å­—ä½“å¤§å°               try:                   run.font.size = Pt(span[&quot;size&quot;])               except:                   run.font.size = Pt(normal_size)               # è®¾ç½®å­—ä½“é¢œè‰²ï¼ˆç®€åŒ–å¤„ç†ï¼Œä»…ä½¿ç”¨é»‘ç™½ä¸¤è‰²ï¼‰               if span[&quot;color&quot;] in (0, 255):  # é»‘è‰²æˆ–ç™½è‰²                   run.font.color.rgb = None  # ä½¿ç”¨é»˜è®¤é¢œè‰²               else:                   # è½¬æ¢PDFé¢œè‰²å€¼ï¼ˆæ•´æ•°ï¼‰ä¸ºRGB                   rgb = PDFProcessor._int_to_rgb(span[&quot;color&quot;])                   run.font.color.rgb = rgb           # æ ¹æ®å­—ä½“å¤§å°åˆ¤æ–­æ˜¯å¦ä¸ºæ ‡é¢˜           if line[&quot;spans&quot;]:               first_span_size = line[&quot;spans&quot;][0][&quot;size&quot;]               if first_span_size &gt;= title_threshold:                   paragraph.style = doc.styles[&quot;Heading 2&quot;]               else:                   paragraph.style = doc.styles[&quot;Normal&quot;]   @staticmethod   def _add_image_to_doc(doc, img_data):       &quot;&quot;&quot;å°†å›¾ç‰‡æ·»åŠ åˆ°Wordæ–‡æ¡£&quot;&quot;&quot;       try:           if os.path.exists(img_data[&quot;path&quot;]):               # è®¡ç®—å›¾ç‰‡åœ¨Wordä¸­çš„å°ºå¯¸ï¼ˆè‹±å¯¸ï¼‰               # 72åƒç´  = 1è‹±å¯¸               width_in_inches = img_data[&quot;width&quot;] / 72               height_in_inches = img_data[&quot;height&quot;] / 72               # é™åˆ¶æœ€å¤§å®½åº¦ä¸º6è‹±å¯¸ï¼Œä¿æŒæ¯”ä¾‹               if width_in_inches &gt; 6:                   ratio = 6 / width_in_inches                   width_in_inches = 6                   height_in_inches *= ratio               # æ·»åŠ å›¾ç‰‡               paragraph = doc.add_paragraph()               run = paragraph.add_run()               run.add_picture(img_data[&quot;path&quot;], width=Inches(width_in_inches),                              height=Inches(height_in_inches))               paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å›¾ç‰‡å±…ä¸­å¯¹é½       except Exception as e:           print(f&quot;æ·»åŠ å›¾ç‰‡åˆ°æ–‡æ¡£å¤±è´¥: &#123;e&#125;&quot;)   @staticmethod   def _int_to_rgb(color_int: int) -&gt; Tuple[int, int, int]:       &quot;&quot;&quot;å°†æ•´æ•°é¢œè‰²å€¼è½¬æ¢ä¸ºRGB tuple&quot;&quot;&quot;       blue = color_int &amp; 0xff       green = (color_int &gt;&gt; 8) &amp; 0xff       red = (color_int &gt;&gt; 16) &amp; 0xff       return (red, green, blue)class ProcessingThread(QThread):   &quot;&quot;&quot;å¤„ç†PDFæ–‡ä»¶çš„å·¥ä½œçº¿ç¨‹&quot;&quot;&quot;   finished = pyqtSignal(bool, str, str)  # å¤„ç†å®Œæˆä¿¡å· (æˆåŠŸ, åŸæ–‡ä»¶è·¯å¾„, ç»“æœæ–‡ä»¶è·¯å¾„)   progress_updated = pyqtSignal(str)  # è¿›åº¦æ›´æ–°ä¿¡å·   def __init__(self, pdf_path: str, output_path: str):       super().__init__()       self.pdf_path = pdf_path       self.output_path = output_path   def run(self):       try:           self.progress_updated.emit(f&quot;æ­£åœ¨æå–PDFå†…å®¹: &#123;os.path.basename(self.pdf_path)&#125;&quot;)           # æå–PDFä¿¡æ¯           pdf_info = PDFProcessor.extract_full_pdf_info(self.pdf_path)           self.progress_updated.emit(f&quot;æ­£åœ¨å»é™¤æ°´å°: &#123;os.path.basename(self.pdf_path)&#125;&quot;)           # å»é™¤æ°´å°           clean_info = PDFProcessor.remove_watermark_by_alpha(pdf_info)           self.progress_updated.emit(f&quot;æ­£åœ¨ç”ŸæˆWordæ–‡æ¡£: &#123;os.path.basename(self.output_path)&#125;&quot;)           # ç”ŸæˆWordæ–‡æ¡£           PDFProcessor.generate_word_from_data(clean_info, self.output_path)           self.finished.emit(True, self.pdf_path, self.output_path)       except Exception as e:           error_msg = f&quot;å¤„ç†å¤±è´¥: &#123;str(e)&#125;&quot;           print(error_msg)           self.progress_updated.emit(error_msg)           self.finished.emit(False, self.pdf_path, str(e))class PdfWatermarkRemoverApp(QWidget):   &quot;&quot;&quot;PDFæ°´å°å»é™¤å·¥å…·ä¸»ç•Œé¢&quot;&quot;&quot;   def __init__(self):       super().__init__()       self.processing_queue = []  # å¾…å¤„ç†æ–‡ä»¶é˜Ÿåˆ—       self.processed_count = 0  # å·²å¤„ç†æ–‡ä»¶æ•°       self.total_files_to_process = 0  # æ€»æ–‡ä»¶æ•°       self.success_count = 0  # å¤„ç†æˆåŠŸæ•°       self.failure_count = 0  # å¤„ç†å¤±è´¥æ•°       self.failed_files = []  # å¤„ç†å¤±è´¥çš„æ–‡ä»¶åˆ—è¡¨       self.processing_mode = None  # &#x27;file&#x27; æˆ– &#x27;folder&#x27;       self.overwrite_all = None  # None:æœªè®¾ç½®, True:å…¨éƒ¨è¦†ç›–, False:å…¨éƒ¨è·³è¿‡       self.init_ui()   def init_ui(self):       &quot;&quot;&quot;åˆå§‹åŒ–ç”¨æˆ·ç•Œé¢&quot;&quot;&quot;       self.setWindowTitle(&quot;PDFæ°´å°å»é™¤å·¥å…·&quot;)       self.setFixedSize(750, 400)       # è®¾ç½®ä¸­æ–‡å­—ä½“       font = QFont()       font.setFamily(&quot;SimHei&quot;)       self.setFont(font)       main_layout = QVBoxLayout()       main_layout.setSpacing(15)       main_layout.setContentsMargins(20, 20, 20, 20)       # æ ‡é¢˜       title_label = QLabel(&quot;PDFæ°´å°å»é™¤ä¸Wordè½¬æ¢å·¥å…·&quot;)       title_font = QFont()       title_font.setFamily(&quot;SimHei&quot;)       title_font.setPointSize(14)       title_font.setBold(True)       title_label.setFont(title_font)       title_label.setAlignment(Qt.AlignCenter)       main_layout.addWidget(title_label)       # åˆ†éš”çº¿       line = QFrame()       line.setFrameShape(QFrame.HLine)       line.setFrameShadow(QFrame.Sunken)       main_layout.addWidget(line)       # æ–‡ä»¶é€‰æ‹©åŒºåŸŸ       file_selection_layout = QVBoxLayout()       # é€‰æ‹©æ–‡ä»¶æŒ‰é’®       self.browse_files_button = QPushButton(&quot;é€‰æ‹©æ–‡ä»¶...&quot;)       self.browse_files_button.setFont(font)       self.browse_files_button.clicked.connect(self.browse_pdf_files)       file_selection_layout.addWidget(self.browse_files_button)       # é€‰æ‹©æ–‡ä»¶å¤¹æŒ‰é’®       self.browse_folder_button = QPushButton(&quot;é€‰æ‹©æ–‡ä»¶å¤¹...&quot;)       self.browse_folder_button.setFont(font)       self.browse_folder_button.clicked.connect(self.browse_folder)       file_selection_layout.addWidget(self.browse_folder_button)       # é€‰ä¸­çš„æ–‡ä»¶/æ–‡ä»¶å¤¹æ˜¾ç¤º       self.selected_path_label = QLabel(&quot;æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹&quot;)       self.selected_path_label.setFont(font)       self.selected_path_label.setWordWrap(True)       file_selection_layout.addWidget(self.selected_path_label)       main_layout.addLayout(file_selection_layout)       # å¤„ç†æŒ‰é’®       self.process_button = QPushButton(&quot;å¼€å§‹å¤„ç†&quot;)       self.process_button.setFont(font)       self.process_button.setMinimumHeight(40)       self.process_button.clicked.connect(self.start_processing)       self.process_button.setEnabled(False)  # åˆå§‹ç¦ç”¨       main_layout.addWidget(self.process_button)       # è¿›åº¦æ˜¾ç¤ºåŒºåŸŸ       progress_layout = QVBoxLayout()       self.status_label = QLabel(&quot;ç­‰å¾…é€‰æ‹©æ–‡ä»¶/æ–‡ä»¶å¤¹...&quot;)       self.status_label.setFont(font)       progress_layout.addWidget(self.status_label)       self.current_file_status_label = QLabel(&quot;&quot;)       self.current_file_status_label.setFont(font)       self.current_file_status_label.setWordWrap(True)       progress_layout.addWidget(self.current_file_status_label)       self.progress_bar = QProgressBar()       self.progress_bar.setValue(0)       progress_layout.addWidget(self.progress_bar)       main_layout.addLayout(progress_layout)       # è¦†ç›–é€‰é¡¹ï¼ˆé»˜è®¤éšè—ï¼‰       self.overwrite_layout = QHBoxLayout()       self.overwrite_label = QLabel(&quot;æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–ï¼Ÿ&quot;)       self.overwrite_label.setFont(font)       self.overwrite_layout.addWidget(self.overwrite_label)       self.overwrite_button = QPushButton(&quot;è¦†ç›–&quot;)       self.overwrite_button.setFont(font)       self.overwrite_button.clicked.connect(lambda: self.handle_overwrite_choice(True))       self.overwrite_layout.addWidget(self.overwrite_button)       self.skip_button = QPushButton(&quot;è·³è¿‡&quot;)       self.skip_button.setFont(font)       self.skip_button.clicked.connect(lambda: self.handle_overwrite_choice(False))       self.overwrite_layout.addWidget(self.skip_button)       self.overwrite_all_checkbox = QCheckBox(&quot;å¯¹å½“å‰æ‰¹æ¬¡çš„æ‰€æœ‰å†²çªæ–‡ä»¶æ‰§è¡Œæ­¤æ“ä½œ&quot;)       self.overwrite_all_checkbox.setFont(font)       self.overwrite_all_checkbox.setVisible(False)       self.overwrite_layout.addWidget(self.overwrite_all_checkbox)       main_layout.addLayout(self.overwrite_layout)       self.overwrite_layout.setVisible(False)  # é»˜è®¤éšè—       # çŠ¶æ€ç»Ÿè®¡åŒºåŸŸ       self.stats_label = QLabel(&quot;å¤„ç†ç»Ÿè®¡: 0 æˆåŠŸ, 0 å¤±è´¥&quot;)       self.stats_label.setFont(font)       main_layout.addWidget(self.stats_label)       # åº•éƒ¨è¯´æ˜       note_label = QLabel(&quot;è¯´æ˜: å¤„ç†åçš„æ–‡ä»¶å°†ä¿å­˜è‡³æºæ–‡ä»¶æ‰€åœ¨ç›®å½•çš„ &#x27;_æ— æ°´å°&#x27; å­æ–‡ä»¶å¤¹ä¸­&quot;)       note_font = QFont()       note_font.setFamily(&quot;SimHei&quot;)       note_font.setPointSize(9)       note_label.setFont(note_font)       note_label.setAlignment(Qt.AlignRight)       main_layout.addWidget(note_label)       self.setLayout(main_layout)   def browse_pdf_files(self):       &quot;&quot;&quot;æµè§ˆå¹¶é€‰æ‹©PDFæ–‡ä»¶&quot;&quot;&quot;       file_paths, _ = QFileDialog.getOpenFileNames(self, &quot;é€‰æ‹©PDFæ–‡ä»¶&quot;, &quot;&quot;, &quot;PDFæ–‡ä»¶ (*.pdf)&quot;)       if file_paths:           self.processing_mode = &quot;file&quot;           self.processing_queue = list(file_paths)           self.total_files_to_process = len(self.processing_queue)           self.selected_path_label.setText(f&quot;å·²é€‰æ‹© &#123;self.total_files_to_process&#125; ä¸ªPDFæ–‡ä»¶&quot;)           self.process_button.setEnabled(True)           self.reset_processing_stats()   def browse_folder(self):       &quot;&quot;&quot;æµè§ˆå¹¶é€‰æ‹©æ–‡ä»¶å¤¹&quot;&quot;&quot;       folder_path = QFileDialog.getExistingDirectory(self, &quot;é€‰æ‹©åŒ…å« PDF æ–‡ä»¶çš„æ–‡ä»¶å¤¹&quot;)       if folder_path:           self.processing_mode = &quot;folder&quot;           # æŸ¥æ‰¾æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰PDFæ–‡ä»¶           pdf_files = []           for root, _, files in os.walk(folder_path):               for file in files:                   if file.lower().endswith(&#x27;.pdf&#x27;):                       pdf_files.append(os.path.join(root, file))           self.processing_queue = pdf_files           self.total_files_to_process = len(self.processing_queue)           self.selected_path_label.setText(               f&quot;å·²é€‰æ‹©æ–‡ä»¶å¤¹: &#123;folder_path&#125;nåŒ…å« &#123;self.total_files_to_process&#125; ä¸ªPDFæ–‡ä»¶&quot;)           self.process_button.setEnabled(self.total_files_to_process &gt; 0)           self.reset_processing_stats()   def reset_processing_stats(self):       &quot;&quot;&quot;é‡ç½®å¤„ç†ç»Ÿè®¡ä¿¡æ¯&quot;&quot;&quot;       self.processed_count = 0       self.success_count = 0       self.failure_count = 0       self.failed_files = []       self.progress_bar.setValue(0)       self.stats_label.setText(&quot;å¤„ç†ç»Ÿè®¡: 0 æˆåŠŸ, 0 å¤±è´¥&quot;)       self.status_label.setText(&quot;å°±ç»ªï¼Œç‚¹å‡»å¼€å§‹å¤„ç†&quot;)       self.current_file_status_label.setText(&quot;&quot;)       self.overwrite_all = None   def start_processing(self):       &quot;&quot;&quot;å¼€å§‹å¤„ç†æ–‡ä»¶é˜Ÿåˆ—&quot;&quot;&quot;       if not self.processing_queue or self.total_files_to_process == 0:           QMessageBox.information(self, &quot;æç¤º&quot;, &quot;æ²¡æœ‰å¯å¤„ç†çš„æ–‡ä»¶&quot;)           return       self.process_button.setEnabled(False)       self.browse_files_button.setEnabled(False)       self.browse_folder_button.setEnabled(False)       self.process_next_file()   def process_next_file(self):       &quot;&quot;&quot;å¤„ç†é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªæ–‡ä»¶&quot;&quot;&quot;       if not self.processing_queue:           self.on_all_processing_finished()           return       current_pdf_path = self.processing_queue.pop(0)       pdf_filename = os.path.basename(current_pdf_path)       pdf_dir = os.path.dirname(current_pdf_path)       # åˆ›å»ºè¾“å‡ºç›®å½•       output_dir = os.path.join(pdf_dir, pdf_filename.replace(&#x27;.pdf&#x27;, &#x27;&#x27;) + &quot;_æ— æ°´å°&quot;)       os.makedirs(output_dir, exist_ok=True)       # æ„å»ºè¾“å‡ºæ–‡ä»¶è·¯å¾„       output_filename = os.path.splitext(pdf_filename)[0] + &quot;_æ— æ°´å°.docx&quot;       output_word_path = os.path.join(output_dir, output_filename)       # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨       if os.path.exists(output_word_path):           # å¦‚æœå·²è®¾ç½®å…¨å±€è¦†ç›–ç­–ç•¥ï¼Œåˆ™ç›´æ¥åº”ç”¨           if self.overwrite_all is not None:               if not self.overwrite_all:                   # è·³è¿‡æ­¤æ–‡ä»¶                   self.current_file_status_label.setText(f&quot;å·²è·³è¿‡å·²å­˜åœ¨æ–‡ä»¶: &#123;pdf_filename&#125;&quot;)                   self.processed_count += 1                   self.update_progress()                   QApplication.processEvents()  # æ›´æ–°ç•Œé¢                   self.process_next_file()                   return           else:               # æ˜¾ç¤ºè¦†ç›–é€‰æ‹©å¯¹è¯æ¡†               self.current_file_path = current_pdf_path               self.current_output_path = output_word_path               self.status_label.setText(f&quot;æ–‡ä»¶å·²å­˜åœ¨: &#123;pdf_filename&#125;&quot;)               self.current_file_status_label.setText(&quot;è¯·é€‰æ‹©å¤„ç†æ–¹å¼&quot;)               self.overwrite_layout.setVisible(True)               self.overwrite_all_checkbox.setVisible(True)               return       # å¯åŠ¨å¤„ç†çº¿ç¨‹       self.status_label.setText(f&quot;æ­£åœ¨å¤„ç†ç¬¬ &#123;self.processed_count + 1&#125; / &#123;self.total_files_to_process&#125; ä¸ªæ–‡ä»¶...&quot;)       self.current_file_status_label.setText(f&quot;æ­£åœ¨å¤„ç†: &#123;pdf_filename&#125;&quot;)       self.processing_thread = ProcessingThread(current_pdf_path, output_word_path)       self.processing_thread.finished.connect(self.on_file_processed)       self.processing_thread.progress_updated.connect(self.current_file_status_label.setText)       self.processing_thread.start()   def handle_overwrite_choice(self, overwrite: bool):       &quot;&quot;&quot;å¤„ç†æ–‡ä»¶è¦†ç›–é€‰æ‹©&quot;&quot;&quot;       self.overwrite_layout.setVisible(False)       # æ£€æŸ¥æ˜¯å¦éœ€è¦åº”ç”¨åˆ°æ‰€æœ‰æ–‡ä»¶       if self.overwrite_all_checkbox.isChecked():           self.overwrite_all = overwrite       if overwrite:           # ç»§ç»­å¤„ç†å½“å‰æ–‡ä»¶ï¼Œè¦†ç›–å·²å­˜åœ¨æ–‡ä»¶           self.processing_thread = ProcessingThread(self.current_file_path, self.current_output_path)           self.processing_thread.finished.connect(self.on_file_processed)           self.processing_thread.progress_updated.connect(self.current_file_status_label.setText)           self.processing_thread.start()       else:           # è·³è¿‡å½“å‰æ–‡ä»¶           self.current_file_status_label.setText(f&quot;å·²è·³è¿‡å·²å­˜åœ¨æ–‡ä»¶: &#123;os.path.basename(self.current_file_path)&#125;&quot;)           self.processed_count += 1           self.update_progress()           self.process_next_file()   def on_file_processed(self, success: bool, file_path: str, result: str):       &quot;&quot;&quot;æ–‡ä»¶å¤„ç†å®Œæˆå›è°ƒ&quot;&quot;&quot;       filename = os.path.basename(file_path)       if success:           self.success_count += 1           self.current_file_status_label.setText(f&quot;å¤„ç†æˆåŠŸ: &#123;filename&#125; -&gt; &#123;os.path.basename(result)&#125;&quot;)       else:           self.failure_count += 1           self.failed_files.append(f&quot;&#123;filename&#125;: &#123;result&#125;&quot;)           self.current_file_status_label.setText(f&quot;å¤„ç†å¤±è´¥: &#123;filename&#125; - &#123;result&#125;&quot;)       self.processed_count += 1       self.update_progress()       self.process_next_file()   def update_progress(self):       &quot;&quot;&quot;æ›´æ–°è¿›åº¦æ˜¾ç¤º&quot;&quot;&quot;       progress_percentage = int((self.processed_count / self.total_files_to_process) * 100)       self.progress_bar.setValue(progress_percentage)       self.stats_label.setText(f&quot;å¤„ç†ç»Ÿè®¡: &#123;self.success_count&#125; æˆåŠŸ, &#123;self.failure_count&#125; å¤±è´¥&quot;)   def on_all_processing_finished(self):       &quot;&quot;&quot;æ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆ&quot;&quot;&quot;       self.status_label.setText(&quot;æ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆ!&quot;)       self.current_file_status_label.setText(&quot;&quot;)       # æ˜¾ç¤ºå¤„ç†ç»“æœæ‘˜è¦       result_msg = f&quot;å¤„ç†å®Œæˆï¼å…±å¤„ç† &#123;self.total_files_to_process&#125; ä¸ªæ–‡ä»¶n&quot;       result_msg += f&quot;æˆåŠŸ: &#123;self.success_count&#125; ä¸ªn&quot;       result_msg += f&quot;å¤±è´¥: &#123;self.failure_count&#125; ä¸ª&quot;       if self.failed_files:           result_msg += &quot;nnå¤„ç†å¤±è´¥çš„æ–‡ä»¶ï¼šn&quot; + &quot;n&quot;.join(self.failed_files)       QMessageBox.information(self, &quot;å¤„ç†å®Œæˆ&quot;, result_msg)       # é‡ç½®ç•Œé¢çŠ¶æ€       self.process_button.setEnabled(True)       self.browse_files_button.setEnabled(True)       self.browse_folder_button.setEnabled(False)       self.overwrite_all = None       self.overwrite_all_checkbox.setChecked(False)if __name__ == &quot;__main__&quot;:   # ç¡®ä¿ä¸­æ–‡æ­£å¸¸æ˜¾ç¤º   import matplotlib   matplotlib.rcParams[&quot;font.family&quot;] = [&quot;SimHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Heiti TC&quot;]   app = QApplication(sys.argv)   window = PdfWatermarkRemoverApp()   window.show()   sys.exit(app.exec_())\n\nä»¥ä¸Šä»£ç å®ç°äº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ PDF æ°´å°å»é™¤å·¥å…·ï¼ŒåŒ…å«äº†ä» PDF å†…å®¹æå–ã€æ°´å°è¯†åˆ«ä¸å»é™¤åˆ° Word æ–‡æ¡£ç”Ÿæˆçš„å…¨æµç¨‹ã€‚å·¥å…·æ”¯æŒå•ä¸ªæ–‡ä»¶å¤„ç†å’Œæ–‡ä»¶å¤¹æ‰¹é‡å¤„ç†ï¼Œæä¾›äº†å‹å¥½çš„å›¾å½¢ç•Œé¢å’Œè¯¦ç»†çš„å¤„ç†çŠ¶æ€åé¦ˆã€‚ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™æ®µä»£ç ï¼Œä¹Ÿå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œè¿›ä¸€æ­¥çš„å®šåˆ¶å’Œä¼˜åŒ–ã€‚\nPS:ä»£ç ä»…ä¾›å‚è€ƒï¼Œå†…å®¹ä¸ä¸€å®šæ­£ç¡®ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µå¤„ç†å–µ\n","categories":["-Python -PDF -Word"],"tags":["Python","PyMuPDF","æ°´å°å»é™¤","PDFå¤„ç†","PyQt5","Word"]}]